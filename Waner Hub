-- WENER HUB v4.0 | ULTIMATE COMPLETE EDITION - HIDDEN KEY SYSTEM
print("=== WENER HUB v4.0 ULTIMATE COMPLETE - HIDDEN KEY EDITION ===")
print("üöÄ Loading complete script with all features + secret key system...")

-- ============================================================================
-- SERVICES & INITIALIZATION
-- ============================================================================

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Lighting = game:GetService("Lighting")
local UserInputService = game:GetService("UserInputService")
local TeleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")
local player = Players.LocalPlayer

-- Wait for character
repeat wait() until player.Character
repeat wait() until player.Character:FindFirstChild("HumanoidRootPart")

-- ============================================================================
-- VARIABLES UNTUK SEMUA FITUR
-- ============================================================================

local espObjects = {}
local currentSpeed = 16
local godModeEnabled = false
local noclipEnabled = false
local doorEspEnabled = false
local keyEspEnabled = false
local entityEspEnabled = false
local playerEspEnabled = false
local itemEspEnabled = false
local bookEspEnabled = false
local autoCollectEnabled = false
local autoUnlockEnabled = false
local autoProximityPromptEnabled = false
local infVitaminsEnabled = false
local rushNotifEnabled = false
local allEntityNotifications = false
local bypassAntiCheat = false

local noclipConnection
local autoCollectConnection
local autoUnlockConnection
local autoProximityPromptConnection
local infVitaminsConnection
local entityConnections = {}
local godModeConnections = {}
local bypassConnections = {}

-- ============================================================================
-- AUTO EXECUTE & AUTO RECONNECT SETUP
-- ============================================================================

local function setupAutoExecute()
    local autoExecuteCode = [[
-- WENER HUB ULTIMATE AUTO EXECUTE
print("üöÄ WENER HUB Auto Execute Triggered!")
loadstring(game:HttpGet("https://raw.githubusercontent.com/WanerScripts/WenerHub/main/doors-ultimate.lua"))()
]]
    
    if not isfolder("WenerHub") then
        makefolder("WenerHub")
    end
    
    writefile("WenerHub/AutoExecute.lua", autoExecuteCode)
    print("üöÄ Auto Execute: CONFIGURED")
end

local function setupAutoReconnect()
    local disconnectDetected = false
    
    local function createDisconnectGUI()
        local ScreenGui = Instance.new("ScreenGui")
        ScreenGui.Name = "WenerDisconnectGUI"
        ScreenGui.ResetOnSpawn = false
        ScreenGui.Parent = game.CoreGui
        
        local Blur = Instance.new("BlurEffect")
        Blur.Size = 30
        Blur.Parent = Lighting
        
        local Background = Instance.new("Frame")
        Background.Size = UDim2.new(1, 0, 1, 0)
        Background.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
        Background.BackgroundTransparency = 0.4
        Background.Parent = ScreenGui
        
        local DisconnectPanel = Instance.new("Frame")
        DisconnectPanel.Size = UDim2.new(0, 500, 0, 300)
        DisconnectPanel.Position = UDim2.new(0.5, -250, 0.5, -150)
        DisconnectPanel.BackgroundColor3 = Color3.fromRGB(15, 15, 25)
        DisconnectPanel.Parent = ScreenGui
        
        local Corner = Instance.new("UICorner")
        Corner.CornerRadius = UDim.new(0, 20)
        Corner.Parent = DisconnectPanel
        
        local Title = Instance.new("TextLabel")
        Title.Size = UDim2.new(1, 0, 0, 60)
        Title.BackgroundTransparency = 1
        Title.Text = "‚ö†Ô∏è CONNECTION LOST"
        Title.TextColor3 = Color3.fromRGB(255, 255, 255)
        Title.Font = Enum.Font.GothamBold
        Title.TextSize = 32
        Title.Parent = DisconnectPanel
        
        local Message = Instance.new("TextLabel")
        Message.Size = UDim2.new(1, -40, 0, 100)
        Message.Position = UDim2.new(0, 20, 0, 80)
        Message.BackgroundTransparency = 1
        Message.Text = "üîå Disconnected from server\nüì° Auto Reconnect in 5 seconds..."
        Message.TextColor3 = Color3.fromRGB(200, 200, 200)
        Message.Font = Enum.Font.Gotham
        Message.TextSize = 18
        Message.TextWrapped = true
        Message.Parent = DisconnectPanel
        
        local ReconnectBtn = Instance.new("TextButton")
        ReconnectBtn.Size = UDim2.new(0, 200, 0, 50)
        ReconnectBtn.Position = UDim2.new(0.5, -100, 0, 200)
        ReconnectBtn.BackgroundColor3 = Color3.fromRGB(0, 200, 0)
        ReconnectBtn.Text = "üîÑ Reconnect Now"
        ReconnectBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
        ReconnectBtn.Font = Enum.Font.GothamBold
        ReconnectBtn.TextSize = 18
        ReconnectBtn.Parent = DisconnectPanel
        
        local BtnCorner = Instance.new("UICorner")
        BtnCorner.CornerRadius = UDim.new(0, 10)
        BtnCorner.Parent = ReconnectBtn
        
        local countdown = 5
        task.spawn(function()
            while countdown > 0 do
                Message.Text = string.format("üîå Disconnected from server\nüì° Auto Reconnect in %d seconds...", countdown)
                countdown = countdown - 1
                wait(1)
            end
            TeleportService:Teleport(game.PlaceId, player)
        end)
        
        ReconnectBtn.MouseButton1Click:Connect(function()
            TeleportService:Teleport(game.PlaceId, player)
        end)
    end
    
    local lastHeartbeat = tick()
    RunService.Heartbeat:Connect(function()
        lastHeartbeat = tick()
    end)
    
    task.spawn(function()
        while true do
            wait(1)
            if tick() - lastHeartbeat > 8 and not disconnectDetected then
                disconnectDetected = true
                createDisconnectGUI()
                break
            end
        end
    end)
end

setupAutoExecute()
setupAutoReconnect()

-- ============================================================================
-- STEP 1: LOADING SCREEN
-- ============================================================================

print("STEP 1: Creating Loading Screen...")

local function createLoadingScreen()
    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "WenerLoading"
    ScreenGui.ResetOnSpawn = false
    ScreenGui.Parent = game.CoreGui
    
    local Blur = Instance.new("BlurEffect")
    Blur.Size = 0
    Blur.Parent = Lighting
    
    local Background = Instance.new("Frame")
    Background.Size = UDim2.new(1, 0, 1, 0)
    Background.BackgroundColor3 = Color3.fromRGB(5, 5, 10)
    Background.BackgroundTransparency = 1
    Background.Parent = ScreenGui
    
    local Container = Instance.new("Frame")
    Container.Size = UDim2.new(0, 600, 0, 400)
    Container.Position = UDim2.new(0.5, -300, 0.5, -200)
    Container.BackgroundColor3 = Color3.fromRGB(15, 15, 25)
    Container.BackgroundTransparency = 1
    Container.Parent = ScreenGui
    
    local Corner = Instance.new("UICorner")
    Corner.CornerRadius = UDim.new(0, 25)
    Corner.Parent = Container
    
    local Title = Instance.new("TextLabel")
    Title.Size = UDim2.new(1, 0, 0, 80)
    Title.Position = UDim2.new(0, 0, 0, 40)
    Title.BackgroundTransparency = 1
    Title.Text = "WENER HUB v4.0"
    Title.TextColor3 = Color3.fromRGB(255, 255, 255)
    Title.Font = Enum.Font.GothamBold
    Title.TextSize = 54
    Title.TextTransparency = 1
    Title.Parent = Container
    
    local Subtitle = Instance.new("TextLabel")
    Subtitle.Size = UDim2.new(1, 0, 0, 40)
    Subtitle.Position = UDim2.new(0, 0, 0, 120)
    Subtitle.BackgroundTransparency = 1
    Subtitle.Text = "ULTIMATE COMPLETE EDITION"
    Subtitle.TextColor3 = Color3.fromRGB(200, 200, 200)
    Subtitle.Font = Enum.Font.Gotham
    Subtitle.TextSize = 24
    Subtitle.TextTransparency = 1
    Subtitle.Parent = Container
    
    local Status = Instance.new("TextLabel")
    Status.Size = UDim2.new(1, 0, 0, 40)
    Status.Position = UDim2.new(0, 0, 0, 180)
    Status.BackgroundTransparency = 1
    Status.Text = "Initializing premium systems..."
    Status.TextColor3 = Color3.fromRGB(100, 255, 100)
    Status.Font = Enum.Font.Gotham
    Status.TextSize = 18
    Status.TextTransparency = 1
    Status.Parent = Container
    
    local Progress = Instance.new("Frame")
    Progress.Size = UDim2.new(0, 0, 0, 8)
    Progress.Position = UDim2.new(0.075, 0, 0, 240)
    Progress.BackgroundColor3 = Color3.fromRGB(139, 0, 255)
    Progress.BorderSizePixel = 0
    Progress.BackgroundTransparency = 1
    Progress.Parent = Container
    
    local ProgressCorner = Instance.new("UICorner")
    ProgressCorner.CornerRadius = UDim.new(1, 0)
    ProgressCorner.Parent = Progress
    
    local SecretInfo = Instance.new("TextLabel")
    SecretInfo.Size = UDim2.new(1, -40, 0, 60)
    SecretInfo.Position = UDim2.new(0, 20, 0, 280)
    SecretInfo.BackgroundTransparency = 1
    SecretInfo.Text = "üîê Loading secret key system...\nüéØ All premium features included\n‚ö° Modern ESP & Auto Functions"
    SecretInfo.TextColor3 = Color3.fromRGB(255, 215, 0)
    SecretInfo.Font = Enum.Font.Gotham
    SecretInfo.TextSize = 14
    SecretInfo.TextWrapped = true
    SecretInfo.TextTransparency = 1
    SecretInfo.Parent = Container
    
    -- Show loading animation
    TweenService:Create(Blur, TweenInfo.new(1), {Size = 35}):Play()
    TweenService:Create(Background, TweenInfo.new(1), {BackgroundTransparency = 0.2}):Play()
    TweenService:Create(Container, TweenInfo.new(1), {BackgroundTransparency = 0.1}):Play()
    wait(1)
    
    TweenService:Create(Title, TweenInfo.new(0.8), {TextTransparency = 0}):Play()
    wait(0.4)
    TweenService:Create(Subtitle, TweenInfo.new(0.8), {TextTransparency = 0}):Play()
    wait(0.4)
    TweenService:Create(Status, TweenInfo.new(0.8), {TextTransparency = 0}):Play()
    TweenService:Create(Progress, TweenInfo.new(0.8), {BackgroundTransparency = 0}):Play()
    wait(0.4)
    TweenService:Create(SecretInfo, TweenInfo.new(0.8), {TextTransparency = 0}):Play()
    wait(0.8)
    
    local stages = {
        {text = "üöÄ Setting up Auto Execute...", progress = 0.15},
        {text = "üîÑ Configuring Auto Reconnect...", progress = 0.3},
        {text = "üîë Loading Secret Key System...", progress = 0.45},
        {text = "üëÅÔ∏è Loading Modern ESP Systems...", progress = 0.6},
        {text = "ü§ñ Setting up Auto Features...", progress = 0.75},
        {text = "üõ°Ô∏è Initializing Protection...", progress = 0.9},
        {text = "‚úÖ All Systems Ready!", progress = 1.0}
    }
    
    for _, stage in ipairs(stages) do
        Status.Text = stage.text
        TweenService:Create(Progress, TweenInfo.new(1), {Size = UDim2.new(0.85 * stage.progress, 0, 0, 8)}):Play()
        wait(1.2)
    end
    
    wait(1)
    
    -- Hide loading screen
    TweenService:Create(Title, TweenInfo.new(0.8), {TextTransparency = 1}):Play()
    TweenService:Create(Subtitle, TweenInfo.new(0.8), {TextTransparency = 1}):Play()
    TweenService:Create(Status, TweenInfo.new(0.8), {TextTransparency = 1}):Play()
    TweenService:Create(Progress, TweenInfo.new(0.8), {BackgroundTransparency = 1}):Play()
    TweenService:Create(SecretInfo, TweenInfo.new(0.8), {TextTransparency = 1}):Play()
    TweenService:Create(Container, TweenInfo.new(0.8), {BackgroundTransparency = 1}):Play()
    TweenService:Create(Background, TweenInfo.new(0.8), {BackgroundTransparency = 1}):Play()
    TweenService:Create(Blur, TweenInfo.new(1), {Size = 0}):Play()
    wait(1.2)
    
    Blur:Destroy()
    ScreenGui:Destroy()
    
    print("‚úÖ Loading Screen completed")
    return true
end

createLoadingScreen()

-- ============================================================================
-- STEP 2: SECRET KEY SYSTEM (HIDDEN KEY)
-- ============================================================================

print("STEP 2: Starting Secret Key System...")

local KeySystemEnabled = true
-- üîê SECRET KEYS - TIDAK DITAMPILKAN DI UI
local CorrectKeys = {
    ["Wene-You"] = {
        expire_time = 86400, -- 24 hours
        hub_name = "Waner hub"
    },
    ["Wene-Premium"] = {
        expire_time = nil, -- No expiry
        hub_name = "[PREMIUM] Waner hub"
    }
}

local currentKeyData = nil

local function formatTime(seconds)
    local hours = math.floor(seconds / 3600)
    local minutes = math.floor((seconds % 3600) / 60)
    local secs = seconds % 60
    return string.format("%02d:%02d:%02d", hours, minutes, secs)
end

local function generateFakeKeys()
    local fakeKeys = {
        "WanerHub2024", "UltimateKey", "PremiumAccess", "DoorsMaster",
        "SuperScript", "EliteHacker", "ProGamer", "MegaKey",
        "PowerUser", "VIPAccess", "AdminKey", "MasterCode",
        "SecretPass", "HiddenKey", "UltimatePass", "PrivateKey"
    }
    return fakeKeys
end

local function checkKey()
    if not isfolder("WenerHub") then
        makefolder("WenerHub")
        return false
    end
    
    if not isfile("WenerHub/Key.json") then
        return false
    end
    
    local success, data = pcall(function()
        return HttpService:JSONDecode(readfile("WenerHub/Key.json"))
    end)
    
    if not success or not data then return false end
    
    local currentTime = os.time()
    
    -- Check if key exists in our valid keys
    for keyName, keyInfo in pairs(CorrectKeys) do
        if data.key == keyName then
            -- Premium key (no expiry)
            if keyInfo.expire_time == nil then
                currentKeyData = {key = keyName, keyInfo = keyInfo}
                return true, nil, keyInfo.hub_name
            end
            
            -- Regular key with expiry
            if data.expire_time and currentTime < data.expire_time then
                currentKeyData = {key = keyName, keyInfo = keyInfo}
                return true, data.expire_time - currentTime, keyInfo.hub_name
            end
        end
    end
    
    return false
end

local function saveKey(keyName)
    local keyInfo = CorrectKeys[keyName]
    if not keyInfo then return false end
    
    local currentTime = os.time()
    local expireTime = nil
    
    if keyInfo.expire_time then
        expireTime = currentTime + keyInfo.expire_time
    end
    
    local keyData = {
        key = keyName,
        save_time = currentTime,
        expire_time = expireTime,
        user = player.Name,
        version = "v4.0_Ultimate_Complete_Hidden",
        hub_name = keyInfo.hub_name,
        is_premium = keyInfo.expire_time == nil
    }
    
    writefile("WenerHub/Key.json", HttpService:JSONEncode(keyData))
    currentKeyData = {key = keyName, keyInfo = keyInfo}
    return true
end

local ownerUsername = "winnertupiq52"
local isOwner = player.Name == ownerUsername
local keySystemPassed = false

if KeySystemEnabled and not isOwner then
    local keyValid, timeLeft, hubName = checkKey()
    
    if not keyValid then
        print("üîë Key required - showing secret key system UI...")
        
        local ScreenGui = Instance.new("ScreenGui")
        ScreenGui.Name = "WenerSecretKeySystem"
        ScreenGui.ResetOnSpawn = false
        ScreenGui.Parent = game.CoreGui
        
        local Blur = Instance.new("BlurEffect")
        Blur.Size = 0
        Blur.Parent = Lighting
        
        local Background = Instance.new("Frame")
        Background.Size = UDim2.new(1, 0, 1, 0)
        Background.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
        Background.BackgroundTransparency = 1
        Background.Parent = ScreenGui
        
        local MainFrame = Instance.new("Frame")
        MainFrame.Size = UDim2.new(0, 600, 0, 500)
        MainFrame.Position = UDim2.new(0.5, -300, 0.5, -250)
        MainFrame.BackgroundColor3 = Color3.fromRGB(15, 15, 25)
        MainFrame.BackgroundTransparency = 1
        MainFrame.Parent = ScreenGui
        
        local Corner = Instance.new("UICorner")
        Corner.CornerRadius = UDim.new(0, 25)
        Corner.Parent = MainFrame
        
        -- Show key system with animation
        TweenService:Create(Blur, TweenInfo.new(0.8), {Size = 30}):Play()
        TweenService:Create(Background, TweenInfo.new(0.8), {BackgroundTransparency = 0.3}):Play()
        TweenService:Create(MainFrame, TweenInfo.new(0.8), {BackgroundTransparency = 0.1}):Play()
        wait(0.8)
        
        local Title = Instance.new("TextLabel")
        Title.Size = UDim2.new(1, 0, 0, 80)
        Title.BackgroundTransparency = 1
        Title.Text = "üîê WENER HUB SECRET ACCESS"
        Title.TextColor3 = Color3.fromRGB(255, 255, 255)
        Title.Font = Enum.Font.GothamBold
        Title.TextSize = 28
        Title.TextTransparency = 1
        Title.Parent = MainFrame
        
        local SecretWarning = Instance.new("TextLabel")
        SecretWarning.Size = UDim2.new(1, -40, 0, 60)
        SecretWarning.Position = UDim2.new(0, 20, 0, 80)
        SecretWarning.BackgroundTransparency = 1
        SecretWarning.Text = "‚ö†Ô∏è CONFIDENTIAL SYSTEM ‚ö†Ô∏è\nüîí Secret key required for premium access"
        SecretWarning.TextColor3 = Color3.fromRGB(255, 100, 100)
        SecretWarning.Font = Enum.Font.GothamBold
        SecretWarning.TextSize = 18
        SecretWarning.TextWrapped = true
        SecretWarning.TextTransparency = 1
        SecretWarning.Parent = MainFrame
        
        local FakeKeyDisplay = Instance.new("TextLabel")
        FakeKeyDisplay.Size = UDim2.new(1, -40, 0, 80)
        FakeKeyDisplay.Position = UDim2.new(0, 20, 0, 150)
        FakeKeyDisplay.BackgroundTransparency = 1
        FakeKeyDisplay.Text = "üéØ Try one of these keys:\nWanerHub2024 ‚Ä¢ UltimateKey ‚Ä¢ PremiumAccess\nDoorsMaster ‚Ä¢ SuperScript ‚Ä¢ EliteHacker"
        FakeKeyDisplay.TextColor3 = Color3.fromRGB(150, 150, 150)
        FakeKeyDisplay.Font = Enum.Font.Gotham
        FakeKeyDisplay.TextSize = 14
        FakeKeyDisplay.TextWrapped = true
        FakeKeyDisplay.TextTransparency = 1
        FakeKeyDisplay.Parent = MainFrame
        
        local SecretHint = Instance.new("TextLabel")
        SecretHint.Size = UDim2.new(1, -40, 0, 40)
        SecretHint.Position = UDim2.new(0, 20, 0, 240)
        SecretHint.BackgroundTransparency = 1
        SecretHint.Text = "üí° Hint: The secret key is hidden... look carefully üëÄ"
        SecretHint.TextColor3 = Color3.fromRGB(255, 215, 0)
        SecretHint.Font = Enum.Font.GothamBold
        SecretHint.TextSize = 16
        SecretHint.TextWrapped = true
        SecretHint.TextTransparency = 1
        SecretHint.Parent = MainFrame
        
        local KeyInput = Instance.new("TextBox")
        KeyInput.Size = UDim2.new(1, -40, 0, 55)
        KeyInput.Position = UDim2.new(0, 20, 0, 300)
        KeyInput.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
        KeyInput.BackgroundTransparency = 1
        KeyInput.PlaceholderText = "üîê Enter Secret Key..."
        KeyInput.PlaceholderColor3 = Color3.fromRGB(150, 150, 150)
        KeyInput.Text = ""
        KeyInput.TextColor3 = Color3.fromRGB(255, 255, 255)
        KeyInput.Font = Enum.Font.Gotham
        KeyInput.TextSize = 20
        KeyInput.Parent = MainFrame
        
        local InputCorner = Instance.new("UICorner")
        InputCorner.CornerRadius = UDim.new(0, 15)
        InputCorner.Parent = KeyInput
        
        local SubmitBtn = Instance.new("TextButton")
        SubmitBtn.Size = UDim2.new(1, -40, 0, 55)
        SubmitBtn.Position = UDim2.new(0, 20, 0, 375)
        SubmitBtn.BackgroundColor3 = Color3.fromRGB(0, 200, 0)
        SubmitBtn.BackgroundTransparency = 1
        SubmitBtn.Text = "üöÄ UNLOCK SECRET ACCESS"
        SubmitBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
        SubmitBtn.Font = Enum.Font.GothamBold
        SubmitBtn.TextSize = 20
        SubmitBtn.TextTransparency = 1
        SubmitBtn.Parent = MainFrame
        
        local BtnCorner = Instance.new("UICorner")
        BtnCorner.CornerRadius = UDim.new(0, 15)
        BtnCorner.Parent = SubmitBtn
        
        local Info = Instance.new("TextLabel")
        Info.Size = UDim2.new(1, -40, 0, 60)
        Info.Position = UDim2.new(0, 20, 0, 450)
        Info.BackgroundTransparency = 1
        Info.Text = "üåü Secret Features: Modern ESP ‚Ä¢ Auto ProximityPrompt R\nAuto Collect ‚Ä¢ Access Time Options ‚Ä¢ All Premium Functions\nüîí Only for those who know the secret..."
        Info.TextColor3 = Color3.fromRGB(200, 200, 200)
        Info.Font = Enum.Font.Gotham
        Info.TextSize = 12
        Info.TextWrapped = true
        Info.TextTransparency = 1
        Info.Parent = MainFrame
        
        -- Animate key system elements
        TweenService:Create(Title, TweenInfo.new(0.6), {TextTransparency = 0}):Play()
        wait(0.3)
        TweenService:Create(SecretWarning, TweenInfo.new(0.6), {TextTransparency = 0}):Play()
        wait(0.3)
        TweenService:Create(FakeKeyDisplay, TweenInfo.new(0.6), {TextTransparency = 0}):Play()
        wait(0.3)
        TweenService:Create(SecretHint, TweenInfo.new(0.6), {TextTransparency = 0}):Play()
        wait(0.3)
        TweenService:Create(KeyInput, TweenInfo.new(0.6), {BackgroundTransparency = 0}):Play()
        wait(0.3)
        TweenService:Create(SubmitBtn, TweenInfo.new(0.6), {BackgroundTransparency = 0, TextTransparency = 0}):Play()
        wait(0.3)
        TweenService:Create(Info, TweenInfo.new(0.6), {TextTransparency = 0}):Play()
        
        -- Cycling fake key hints
        task.spawn(function()
            local fakeKeys = generateFakeKeys()
            while not keySystemPassed do
                wait(3)
                if FakeKeyDisplay and FakeKeyDisplay.Parent then
                    local randomKeys = {}
                    for i = 1, 6 do
                        table.insert(randomKeys, fakeKeys[math.random(1, #fakeKeys)])
                    end
                    FakeKeyDisplay.Text = "üéØ Try one of these keys:\n" .. 
                        randomKeys[1] .. " ‚Ä¢ " .. randomKeys[2] .. " ‚Ä¢ " .. randomKeys[3] .. "\n" ..
                        randomKeys[4] .. " ‚Ä¢ " .. randomKeys[5] .. " ‚Ä¢ " .. randomKeys[6]
                end
            end
        end)
        
        local submitted = false
        local attempts = 0
        SubmitBtn.MouseButton1Click:Connect(function()
            attempts = attempts + 1
            
            -- Check if entered key is valid
            local enteredKey = KeyInput.Text
            local isValidKey = false
            
            for keyName, keyInfo in pairs(CorrectKeys) do
                if enteredKey == keyName then
                    isValidKey = true
                    saveKey(keyName)
                    submitted = true
                    keySystemPassed = true
                    
                    SubmitBtn.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
                    
                    if keyInfo.expire_time == nil then
                        SubmitBtn.Text = "‚úÖ PREMIUM ACCESS GRANTED!"
                        SecretHint.Text = "üéâ Welcome to PREMIUM! No expiry time!"
                    else
                        SubmitBtn.Text = "‚úÖ SECRET ACCESS GRANTED!"
                        SecretHint.Text = "üéâ Welcome! 24-hour access activated!"
                    end
                    
                    SecretHint.TextColor3 = Color3.fromRGB(0, 255, 0)
                    break
                end
            end
            
            if not isValidKey then
                SubmitBtn.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
                
                if attempts <= 3 then
                    SubmitBtn.Text = "‚ùå WRONG KEY! Try again... (" .. attempts .. "/‚àû)"
                    SecretHint.Text = "üí° Hint: Try Wene-You or Wene-Premium... üîç"
                elseif attempts <= 6 then
                    SubmitBtn.Text = "ü§î Still wrong! Keep trying..."
                    SecretHint.Text = "üßê Hint: Wene-You (24h) or Wene-Premium (unlimited)"
                else
                    SubmitBtn.Text = "üôà Think about the name..."
                    SecretHint.Text = "üëÅÔ∏è Final Hint: Wene + You or Wene + Premium"
                end
                
                wait(2)
                SubmitBtn.BackgroundColor3 = Color3.fromRGB(0, 200, 0)
                SubmitBtn.Text = "üöÄ UNLOCK SECRET ACCESS"
            end
        end)
        
        repeat wait(0.1) until submitted
        
        wait(2)
        
        -- Hide key system
        TweenService:Create(MainFrame, TweenInfo.new(0.8), {BackgroundTransparency = 1}):Play()
        TweenService:Create(Title, TweenInfo.new(0.8), {TextTransparency = 1}):Play()
        TweenService:Create(SecretWarning, TweenInfo.new(0.8), {TextTransparency = 1}):Play()
        TweenService:Create(FakeKeyDisplay, TweenInfo.new(0.8), {TextTransparency = 1}):Play()
        TweenService:Create(SecretHint, TweenInfo.new(0.8), {TextTransparency = 1}):Play()
        TweenService:Create(KeyInput, TweenInfo.new(0.8), {BackgroundTransparency = 1, TextTransparency = 1}):Play()
        TweenService:Create(SubmitBtn, TweenInfo.new(0.8), {BackgroundTransparency = 1, TextTransparency = 1}):Play()
        TweenService:Create(Info, TweenInfo.new(0.8), {TextTransparency = 1}):Play()
        TweenService:Create(Background, TweenInfo.new(0.8), {BackgroundTransparency = 1}):Play()
        TweenService:Create(Blur, TweenInfo.new(1), {Size = 0}):Play()
        wait(1.2)
        
        Blur:Destroy()
        ScreenGui:Destroy()
        
        print("‚úÖ Secret Key System passed with hidden key!")
    else
        keySystemPassed = true
        if timeLeft then
            print("‚úÖ Valid secret key found - " .. formatTime(timeLeft) .. " remaining - Hub: " .. hubName)
        else
            print("‚úÖ Valid PREMIUM key found - No expiry - Hub: " .. hubName)
        end
    end
else
    keySystemPassed = true
    print("‚úÖ Owner access granted - no key required")
end

-- ============================================================================
-- STEP 3: WELCOME SCREEN
-- ============================================================================

if keySystemPassed then
    print("STEP 3: Creating Welcome Screen...")
    
    local function createWelcomeScreen()
        local ScreenGui = Instance.new("ScreenGui")
        ScreenGui.Name = "WenerWelcome"
        ScreenGui.ResetOnSpawn = false
        ScreenGui.Parent = game.CoreGui
        
        local Blur = Instance.new("BlurEffect")
        Blur.Size = 0
        Blur.Parent = Lighting
        
        local Background = Instance.new("Frame")
        Background.Size = UDim2.new(1, 0, 1, 0)
        Background.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
        Background.BackgroundTransparency = 1
        Background.Parent = ScreenGui
        
        local WelcomeText = Instance.new("TextLabel")
        WelcomeText.Size = UDim2.new(0.8, 0, 0.2, 0)
        WelcomeText.Position = UDim2.new(0.1, 0, 0.3, 0)
        WelcomeText.BackgroundTransparency = 1
        WelcomeText.Text = "Welcome " .. player.DisplayName
        WelcomeText.TextColor3 = Color3.fromRGB(139, 0, 255)
        WelcomeText.Font = Enum.Font.GothamBold
        WelcomeText.TextSize = 48
        WelcomeText.TextStrokeTransparency = 0
        WelcomeText.TextTransparency = 1
        WelcomeText.Parent = ScreenGui
        
        local SecretText = Instance.new("TextLabel")
        SecretText.Size = UDim2.new(0.8, 0, 0.1, 0)
        SecretText.Position = UDim2.new(0.1, 0, 0.5, 0)
        SecretText.BackgroundTransparency = 1
        
        -- Set text based on key type
        if currentKeyData and currentKeyData.key == "Wene-Premium" then
            SecretText.Text = "üîê PREMIUM Access Granted"
        else
            SecretText.Text = "üîê Secret Access Granted"
        end
        
        SecretText.TextColor3 = Color3.fromRGB(255, 215, 0)
        SecretText.Font = Enum.Font.GothamBold
        SecretText.TextSize = 32
        SecretText.TextStrokeTransparency = 0
        SecretText.TextTransparency = 1
        SecretText.Parent = ScreenGui
        
        local HubText = Instance.new("TextLabel")
        HubText.Size = UDim2.new(1, 0, 0.3, 0)
        HubText.Position = UDim2.new(0, 0, 0.6, 0)
        HubText.BackgroundTransparency = 1
        
        -- Set hub name based on key type
        if currentKeyData then
            HubText.Text = currentKeyData.keyInfo.hub_name
        else
            HubText.Text = "Waner Hub"
        end
        
        HubText.TextColor3 = Color3.fromRGB(255, 255, 255)
        HubText.Font = Enum.Font.GothamBold
        HubText.TextSize = 72
        HubText.TextStrokeTransparency = 0
        HubText.TextTransparency = 1
        HubText.Parent = ScreenGui
        
        -- Show welcome animation
        TweenService:Create(Blur, TweenInfo.new(1), {Size = 25}):Play()
        TweenService:Create(Background, TweenInfo.new(1), {BackgroundTransparency = 0.3}):Play()
        wait(1)
        
        TweenService:Create(WelcomeText, TweenInfo.new(1.5), {TextTransparency = 0}):Play()
        wait(1)
        TweenService:Create(SecretText, TweenInfo.new(1), {TextTransparency = 0}):Play()
        wait(1.5)
        
        TweenService:Create(HubText, TweenInfo.new(0.8), {TextTransparency = 0}):Play()
        wait(1)
        
        -- Glitch effect
        local hubNameToShow = HubText.Text
        local glitchTexts = {
            "W@n@r HuB", "W‚Ç¨n‚Ç¨r H‚à™B", "W¬£n¬£r HŒºB", "W‚ààn‚ààr H‚à™√ü",
            "W‚àÇn‚àÇr Hub", "Wan‚Ç¨r Hub", "Wan3r Hub", hubNameToShow
        }
        
        for i = 1, 12 do
            HubText.Text = glitchTexts[math.random(1, #glitchTexts)]
            HubText.TextColor3 = Color3.fromRGB(
                math.random(100, 255),
                math.random(100, 255), 
                math.random(100, 255)
            )
            HubText.Position = UDim2.new(
                math.random(-3, 3) / 100,
                0,
                0.6 + math.random(-1, 1) / 100,
                0
            )
            wait(0.12)
        end
        
        TweenService:Create(HubText, TweenInfo.new(1), {
            TextColor3 = Color3.fromRGB(139, 0, 255),
            Position = UDim2.new(0, 0, 0.6, 0)
        }):Play()
        HubText.Text = hubNameToShow
        
        wait(2.5)
        
        -- Hide welcome screen
        TweenService:Create(WelcomeText, TweenInfo.new(1.5), {TextTransparency = 1}):Play()
        TweenService:Create(SecretText, TweenInfo.new(1.5), {TextTransparency = 1}):Play()
        TweenService:Create(HubText, TweenInfo.new(1.5), {TextTransparency = 1}):Play()
        TweenService:Create(Background, TweenInfo.new(1.5), {BackgroundTransparency = 1}):Play()
        TweenService:Create(Blur, TweenInfo.new(1.5), {Size = 0}):Play()
        
        wait(1.5)
        ScreenGui:Destroy()
        Blur:Destroy()
        
        print("‚úÖ Welcome Screen completed")
        return true
    end
    
    createWelcomeScreen()
end

-- ============================================================================
-- STEP 4: PERMANENT LOGO
-- ============================================================================

local function createPermanentLogo()
    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "WenerLogo"
    ScreenGui.ResetOnSpawn = false
    ScreenGui.Parent = game.CoreGui
    
    local Container = Instance.new("Frame")
    Container.Size = UDim2.new(0, 600, 0, 90)
    Container.Position = UDim2.new(0.5, -300, 0.02, 0)
    Container.BackgroundTransparency = 1
    Container.Parent = ScreenGui
    
    local WenerText = Instance.new("TextLabel")
    WenerText.Size = UDim2.new(0, 170, 1, 0)
    WenerText.Position = UDim2.new(0, 0, 0, 0)
    WenerText.BackgroundTransparency = 1
    WenerText.Text = "WENER"
    WenerText.TextColor3 = Color3.fromRGB(139, 0, 255)
    WenerText.Font = Enum.Font.GothamBold
    WenerText.TextSize = 44
    WenerText.TextStrokeTransparency = 0.3
    WenerText.TextXAlignment = Enum.TextXAlignment.Right
    WenerText.TextTransparency = 1
    WenerText.Parent = Container
    
    local HubText = Instance.new("TextLabel")
    
    -- Adjust size based on key type
    if currentKeyData and currentKeyData.key == "Wene-Premium" then
        HubText.Size = UDim2.new(0, 300, 1, 0)
    else
        HubText.Size = UDim2.new(0, 180, 1, 0)
    end
    
    HubText.Position = UDim2.new(0, 180, 0, 0)
    HubText.BackgroundTransparency = 1
    
    -- Set hub name based on key type
    if currentKeyData then
        HubText.Text = currentKeyData.keyInfo.hub_name
        -- Adjust text size for premium
        if currentKeyData.key == "Wene-Premium" then
            HubText.TextSize = 32
        else
            HubText.TextSize = 44
        end
    else
        HubText.Text = "HUB"
        HubText.TextSize = 44
    end
    
    HubText.TextColor3 = Color3.fromRGB(139, 0, 255)
    HubText.Font = Enum.Font.GothamBold
    HubText.TextStrokeTransparency = 0.3
    HubText.TextXAlignment = Enum.TextXAlignment.Left
    HubText.TextTransparency = 1
    HubText.Parent = Container
    
    local VersionText = Instance.new("TextLabel")
    VersionText.Size = UDim2.new(0, 200, 0, 25)
    VersionText.Position = UDim2.new(0, 400, 1, -25)
    VersionText.BackgroundTransparency = 1
    VersionText.Text = "v4.0 Ultimate Complete"
    VersionText.TextColor3 = Color3.fromRGB(200, 200, 200)
    VersionText.Font = Enum.Font.Gotham
    VersionText.TextSize = 12
    VersionText.TextTransparency = 1
    VersionText.Parent = Container
    
    local SecretText = Instance.new("TextLabel")
    SecretText.Size = UDim2.new(0, 200, 0, 25)
    SecretText.Position = UDim2.new(0, 400, 0, 25)
    SecretText.BackgroundTransparency = 1
    
    -- Set status based on key type
    if currentKeyData and currentKeyData.key == "Wene-Premium" then
        SecretText.Text = "üëë PREMIUM Access"
    else
        SecretText.Text = "üîê Secret Access"
    end
    
    SecretText.TextColor3 = Color3.fromRGB(255, 215, 0)
    SecretText.Font = Enum.Font.GothamBold
    SecretText.TextSize = 14
    SecretText.TextTransparency = 1
    SecretText.Parent = Container
    
    if isOwner then
        local OwnerText = Instance.new("TextLabel")
        OwnerText.Size = UDim2.new(0, 200, 0, 25)
        OwnerText.Position = UDim2.new(0, 400, 0, 0)
        OwnerText.BackgroundTransparency = 1
        OwnerText.Text = "üëë OWNER ACCESS"
        OwnerText.TextColor3 = Color3.fromRGB(255, 215, 0)
        OwnerText.Font = Enum.Font.GothamBold
        OwnerText.TextSize = 14
        OwnerText.TextTransparency = 1
        OwnerText.Parent = Container
        
        task.spawn(function()
            wait(2)
            TweenService:Create(OwnerText, TweenInfo.new(1.5), {TextTransparency = 0}):Play()
        end)
    end
    
    task.spawn(function()
        wait(2)
        TweenService:Create(WenerText, TweenInfo.new(1.5), {TextTransparency = 0}):Play()
        wait(0.3)
        TweenService:Create(HubText, TweenInfo.new(1.5), {TextTransparency = 0}):Play()
        wait(0.3)
        TweenService:Create(VersionText, TweenInfo.new(1.2), {TextTransparency = 0}):Play()
        wait(0.2)
        TweenService:Create(SecretText, TweenInfo.new(1.2), {TextTransparency = 0}):Play()
    end)
end

task.spawn(createPermanentLogo)

-- ============================================================================
-- STEP 5: NOTIFICATION SYSTEM (FIXED & IMPROVED)
-- ============================================================================

print("STEP 5: Setting up Advanced Notification System...")

local notificationQueue = {}
local isShowingNotification = false
local currentNotifications = {}

local function createNotification(title, message, color, duration)
    table.insert(notificationQueue, {
        title = title,
        message = message,
        color = color or Color3.fromRGB(139, 0, 255),
        duration = duration or 5
    })
    
    if not isShowingNotification then
        task.spawn(function()
            while #notificationQueue > 0 do
                isShowingNotification = true
                local notif = table.remove(notificationQueue, 1)
                
                local ScreenGui = Instance.new("ScreenGui")
                ScreenGui.Name = "WenerNotification" .. tick()
                ScreenGui.ResetOnSpawn = false
                ScreenGui.Parent = game.CoreGui
                
                local yOffset = #currentNotifications * 110
                
                local NotificationFrame = Instance.new("Frame")
                NotificationFrame.Size = UDim2.new(0, 400, 0, 100)
                NotificationFrame.Position = UDim2.new(1, 20, 0, 50 + yOffset)
                NotificationFrame.BackgroundColor3 = Color3.fromRGB(15, 15, 25)
                NotificationFrame.BorderSizePixel = 0
                NotificationFrame.Parent = ScreenGui
                
                local Corner = Instance.new("UICorner")
                Corner.CornerRadius = UDim.new(0, 15)
                Corner.Parent = NotificationFrame
                
                local Stroke = Instance.new("UIStroke")
                Stroke.Color = notif.color
                Stroke.Thickness = 2
                Stroke.Parent = NotificationFrame
                
                local Gradient = Instance.new("UIGradient")
                Gradient.Color = ColorSequence.new({
                    ColorSequenceKeypoint.new(0, Color3.fromRGB(25, 25, 35)),
                    ColorSequenceKeypoint.new(1, Color3.fromRGB(15, 15, 25))
                })
                Gradient.Rotation = 45
                Gradient.Parent = NotificationFrame
                
                local TitleLabel = Instance.new("TextLabel")
                TitleLabel.Size = UDim2.new(1, -20, 0, 30)
                TitleLabel.Position = UDim2.new(0, 10, 0, 5)
                TitleLabel.BackgroundTransparency = 1
                TitleLabel.Text = notif.title
                TitleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
                TitleLabel.Font = Enum.Font.GothamBold
                TitleLabel.TextSize = 16
                TitleLabel.TextXAlignment = Enum.TextXAlignment.Left
                TitleLabel.Parent = NotificationFrame
                
                local MessageLabel = Instance.new("TextLabel")
                MessageLabel.Size = UDim2.new(1, -20, 0, 50)
                MessageLabel.Position = UDim2.new(0, 10, 0, 35)
                MessageLabel.BackgroundTransparency = 1
                MessageLabel.Text = notif.message
                MessageLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
                MessageLabel.Font = Enum.Font.Gotham
                MessageLabel.TextSize = 14
                MessageLabel.TextWrapped = true
                MessageLabel.TextXAlignment = Enum.TextXAlignment.Left
                MessageLabel.TextYAlignment = Enum.TextYAlignment.Top
                MessageLabel.Parent = NotificationFrame
                
                local ProgressBar = Instance.new("Frame")
                ProgressBar.Size = UDim2.new(1, 0, 0, 3)
                ProgressBar.Position = UDim2.new(0, 0, 1, -3)
                ProgressBar.BackgroundColor3 = notif.color
                ProgressBar.BorderSizePixel = 0
                ProgressBar.Parent = NotificationFrame
                
                local ProgressCorner = Instance.new("UICorner")
                ProgressCorner.CornerRadius = UDim.new(0, 2)
                ProgressCorner.Parent = ProgressBar
                
                table.insert(currentNotifications, ScreenGui)
                
                -- Slide in animation
                TweenService:Create(NotificationFrame, TweenInfo.new(0.5, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
                    Position = UDim2.new(1, -420, 0, 50 + yOffset)
                }):Play()
                
                -- Progress bar animation
                TweenService:Create(ProgressBar, TweenInfo.new(notif.duration, Enum.EasingStyle.Linear), {
                    Size = UDim2.new(0, 0, 0, 3)
                }):Play()
                
                wait(notif.duration)
                
                -- Slide out animation
                TweenService:Create(NotificationFrame, TweenInfo.new(0.5, Enum.EasingStyle.Back, Enum.EasingDirection.In), {
                    Position = UDim2.new(1, 20, 0, 50 + yOffset)
                }):Play()
                
                wait(0.5)
                
                -- Remove from current notifications
                for i, gui in ipairs(currentNotifications) do
                    if gui == ScreenGui then
                        table.remove(currentNotifications, i)
                        break
                    end
                end
                
                ScreenGui:Destroy()
                
                -- Reposition remaining notifications
                for i, gui in ipairs(currentNotifications) do
                    local frame = gui:FindFirstChild("Frame") or gui:FindFirstChildWhichIsA("Frame")
                    if frame then
                        TweenService:Create(frame, TweenInfo.new(0.3), {
                            Position = UDim2.new(1, -420, 0, 50 + ((i - 1) * 110))
                        }):Play()
                    end
                end
                
                wait(0.3)
            end
            isShowingNotification = false
        end)
    end
end

-- ============================================================================
-- STEP 6: MODERN ESP SYSTEM (LENGKAP & OPTIMIZED)
-- ============================================================================

print("STEP 6: Setting up Modern ESP System...")

local function createESP(object, text, color, icon)
    if not object or espObjects[object] then return end
    
    local BillboardGui = Instance.new("BillboardGui")
    BillboardGui.Name = "WenerESP"
    BillboardGui.Adornee = object
    BillboardGui.Size = UDim2.new(0, 200, 0, 50)
    BillboardGui.StudsOffset = Vector3.new(0, 2, 0)
    BillboardGui.AlwaysOnTop = true
    BillboardGui.Parent = object
    
    local Container = Instance.new("Frame")
    Container.Size = UDim2.new(1, 0, 1, 0)
    Container.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    Container.BackgroundTransparency = 0.5
    Container.BorderSizePixel = 0
    Container.Parent = BillboardGui
    
    local Corner = Instance.new("UICorner")
    Corner.CornerRadius = UDim.new(0, 8)
    Corner.Parent = Container
    
    local Stroke = Instance.new("UIStroke")
    Stroke.Color = color
    Stroke.Thickness = 2
    Stroke.Transparency = 0.5
    Stroke.Parent = Container
    
    local IconLabel = Instance.new("TextLabel")
    IconLabel.Size = UDim2.new(0, 30, 1, 0)
    IconLabel.BackgroundTransparency = 1
    IconLabel.Text = icon or "üìç"
    IconLabel.TextColor3 = color
    IconLabel.Font = Enum.Font.GothamBold
    IconLabel.TextSize = 20
    IconLabel.Parent = Container
    
    local TextLabel = Instance.new("TextLabel")
    TextLabel.Size = UDim2.new(1, -35, 1, 0)
    TextLabel.Position = UDim2.new(0, 35, 0, 0)
    TextLabel.BackgroundTransparency = 1
    TextLabel.Text = text
    TextLabel.TextColor3 = color
    TextLabel.Font = Enum.Font.GothamBold
    TextLabel.TextSize = 14
    TextLabel.TextXAlignment = Enum.TextXAlignment.Left
    TextLabel.Parent = Container
    
    local DistanceLabel = Instance.new("TextLabel")
    DistanceLabel.Size = UDim2.new(1, -10, 0, 15)
    DistanceLabel.Position = UDim2.new(0, 5, 1, -18)
    DistanceLabel.BackgroundTransparency = 1
    DistanceLabel.Text = "0m"
    DistanceLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    DistanceLabel.Font = Enum.Font.Gotham
    DistanceLabel.TextSize = 10
    DistanceLabel.TextXAlignment = Enum.TextXAlignment.Center
    DistanceLabel.Parent = Container
    
    espObjects[object] = {
        BillboardGui = BillboardGui,
        DistanceLabel = DistanceLabel,
        Adornee = object
    }
    
    -- Update distance
    task.spawn(function()
        while espObjects[object] and object and object.Parent do
            if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                local distance = (player.Character.HumanoidRootPart.Position - object.Position).Magnitude
                DistanceLabel.Text = string.format("%.1fm", distance)
            end
            wait(0.5)
        end
    end)
end

local function removeESP(object)
    if espObjects[object] then
        if espObjects[object].BillboardGui then
            espObjects[object].BillboardGui:Destroy()
        end
        espObjects[object] = nil
    end
end

local function clearAllESP()
    for object, _ in pairs(espObjects) do
        removeESP(object)
    end
end

-- Door ESP
local function updateDoorESP()
    if doorEspEnabled then
        for _, door in ipairs(workspace.CurrentRooms:GetDescendants()) do
            if door.Name == "Door" and door:FindFirstChild("Door") then
                createESP(door.Door, "üö™ Door", Color3.fromRGB(0, 255, 255), "üö™")
            end
        end
    else
        for object, espData in pairs(espObjects) do
            if object.Name == "Door" then
                removeESP(object)
            end
        end
    end
end

-- Key ESP
local function updateKeyESP()
    if keyEspEnabled then
        for _, key in ipairs(workspace.CurrentRooms:GetDescendants()) do
            if key.Name == "KeyObtain" then
                createESP(key, "üîë Key", Color3.fromRGB(255, 255, 0), "üîë")
            end
        end
    else
        for object, espData in pairs(espObjects) do
            if object.Name == "KeyObtain" then
                removeESP(object)
            end
        end
    end
end

-- Entity ESP (Rush, Ambush, Eyes, Screech, etc.)
local function updateEntityESP()
    if entityEspEnabled then
        for _, entity in ipairs(workspace:GetDescendants()) do
            if entity:IsA("Model") then
                if entity.Name == "RushMoving" then
                    if entity.PrimaryPart then
                        createESP(entity.PrimaryPart, "‚ö° RUSH!", Color3.fromRGB(255, 0, 0), "‚ö°")
                    end
                elseif entity.Name == "AmbushMoving" then
                    if entity.PrimaryPart then
                        createESP(entity.PrimaryPart, "üí® AMBUSH!", Color3.fromRGB(255, 100, 0), "üí®")
                    end
                elseif entity.Name == "Eyes" then
                    if entity.PrimaryPart then
                        createESP(entity.PrimaryPart, "üëÅÔ∏è EYES!", Color3.fromRGB(0, 255, 255), "üëÅÔ∏è")
                    end
                elseif entity.Name == "Screech" then
                    if entity.PrimaryPart then
                        createESP(entity.PrimaryPart, "üëª SCREECH!", Color3.fromRGB(255, 0, 255), "üëª")
                    end
                elseif entity.Name == "Halt" then
                    if entity.PrimaryPart then
                        createESP(entity.PrimaryPart, "üõë HALT!", Color3.fromRGB(255, 255, 0), "üõë")
                    end
                elseif entity.Name == "Seek_Arm" then
                    if entity.PrimaryPart then
                        createESP(entity.PrimaryPart, "üëÅÔ∏è SEEK ARM!", Color3.fromRGB(0, 0, 0), "üëÅÔ∏è")
                    end
                end
            end
        end
    else
        for object, espData in pairs(espObjects) do
            local entityNames = {"RushMoving", "AmbushMoving", "Eyes", "Screech", "Halt", "Seek_Arm"}
            for _, name in ipairs(entityNames) do
                if object.Parent and object.Parent.Name == name then
                    removeESP(object)
                end
            end
        end
    end
end

-- Player ESP
local function updatePlayerESP()
    if playerEspEnabled then
        for _, otherPlayer in ipairs(Players:GetPlayers()) do
            if otherPlayer ~= player and otherPlayer.Character and otherPlayer.Character:FindFirstChild("HumanoidRootPart") then
                createESP(otherPlayer.Character.HumanoidRootPart, "üë§ " .. otherPlayer.Name, Color3.fromRGB(0, 255, 0), "üë§")
            end
        end
    else
        for object, espData in pairs(espObjects) do
            if object.Parent and object.Parent:IsA("Model") and Players:GetPlayerFromCharacter(object.Parent) then
                removeESP(object)
            end
        end
    end
end

-- Item ESP (Lighter, Flashlight, Lockpick, etc.)
local function updateItemESP()
    if itemEspEnabled then
        for _, item in ipairs(workspace.CurrentRooms:GetDescendants()) do
            if item:IsA("Model") then
                if item.Name == "LighterObtain" then
                    if item.PrimaryPart then
                        createESP(item.PrimaryPart, "üî• Lighter", Color3.fromRGB(255, 100, 0), "üî•")
                    end
                elseif item.Name == "FlashlightObtain" then
                    if item.PrimaryPart then
                        createESP(item.PrimaryPart, "üî¶ Flashlight", Color3.fromRGB(255, 255, 0), "üî¶")
                    end
                elseif item.Name == "LockpickObtain" then
                    if item.PrimaryPart then
                        createESP(item.PrimaryPart, "üîì Lockpick", Color3.fromRGB(200, 200, 200), "üîì")
                    end
                elseif item.Name == "CrucifixObtain" then
                    if item.PrimaryPart then
                        createESP(item.PrimaryPart, "‚úùÔ∏è Crucifix", Color3.fromRGB(255, 255, 255), "‚úùÔ∏è")
                    end
                elseif item.Name == "BandageObtain" then
                    if item.PrimaryPart then
                        createESP(item.PrimaryPart, "ü©π Bandage", Color3.fromRGB(255, 200, 200), "ü©π")
                    end
                elseif item.Name == "VitaminObtain" then
                    if item.PrimaryPart then
                        createESP(item.PrimaryPart, "üíä Vitamin", Color3.fromRGB(0, 255, 255), "üíä")
                    end
                end
            end
        end
    else
        for object, espData in pairs(espObjects) do
            local itemNames = {"LighterObtain", "FlashlightObtain", "LockpickObtain", "CrucifixObtain", "BandageObtain", "VitaminObtain"}
            for _, name in ipairs(itemNames) do
                if object.Parent and object.Parent.Name == name then
                    removeESP(object)
                end
            end
        end
    end
end

-- Book ESP
local function updateBookESP()
    if bookEspEnabled then
        for _, book in ipairs(workspace.CurrentRooms:GetDescendants()) do
            if book.Name == "LibraryHintPaper" or book.Name == "BookPile" then
                if book:IsA("BasePart") then
                    createESP(book, "üìö Book/Paper", Color3.fromRGB(139, 69, 19), "üìö")
                elseif book:IsA("Model") and book.PrimaryPart then
                    createESP(book.PrimaryPart, "üìö Book/Paper", Color3.fromRGB(139, 69, 19), "üìö")
                end
            end
        end
    else
        for object, espData in pairs(espObjects) do
            if object.Name == "LibraryHintPaper" or (object.Parent and object.Parent.Name == "BookPile") then
                removeESP(object)
            end
        end
    end
end

-- Auto update ESP when rooms change
workspace.CurrentRooms.ChildAdded:Connect(function()
    wait(0.5)
    if doorEspEnabled then updateDoorESP() end
    if keyEspEnabled then updateKeyESP() end
    if entityEspEnabled then updateEntityESP() end
    if itemEspEnabled then updateItemESP() end
    if bookEspEnabled then updateBookESP() end
end)

-- Entity spawn detection
workspace.DescendantAdded:Connect(function(descendant)
    if entityEspEnabled then
        task.spawn(function()
            wait(0.1)
            updateEntityESP()
        end)
    end
end)

-- ============================================================================
-- STEP 7: ENTITY NOTIFICATION SYSTEM
-- ============================================================================

print("STEP 7: Setting up Entity Notification System...")

local function setupEntityNotifications()
    workspace.DescendantAdded:Connect(function(descendant)
        if descendant:IsA("Model") then
            if allEntityNotifications or rushNotifEnabled then
                if descendant.Name == "RushMoving" and rushNotifEnabled then
                    createNotification(
                        "‚ö° RUSH SPAWNED!",
                        "Hide in a closet immediately!",
                        Color3.fromRGB(255, 0, 0),
                        7
                    )
                    
                    -- Play sound warning
                    local sound = Instance.new("Sound")
                    sound.SoundId = "rbxassetid://4590657391"
                    sound.Volume = 2
                    sound.Parent = game.SoundService
                    sound:Play()
                    game:GetService("Debris"):AddItem(sound, 3)
                end
                
                if allEntityNotifications then
                    if descendant.Name == "AmbushMoving" then
                        createNotification(
                            "üí® AMBUSH SPAWNED!",
                            "Get ready to hide multiple times!",
                            Color3.fromRGB(255, 100, 0),
                            7
                        )
                    elseif descendant.Name == "Eyes" then
                        createNotification(
                            "üëÅÔ∏è EYES DETECTED!",
                            "Don't look at it!",
                            Color3.fromRGB(0, 255, 255),
                            5
                        )
                    elseif descendant.Name == "Screech" then
                        createNotification(
                            "üëª SCREECH!",
                            "Look behind you when you hear psst!",
                            Color3.fromRGB(255, 0, 255),
                            5
                        )
                    elseif descendant.Name == "Halt" then
                        createNotification(
                            "üõë HALT ROOM!",
                            "Turn around when it says 'Turn Around'!",
                            Color3.fromRGB(255, 255, 0),
                            6
                        )
                    elseif descendant.Name == "Seek_Arm" then
                        createNotification(
                            "üëÅÔ∏è SEEK ARM!",
                            "Avoid the arms on the floor!",
                            Color3.fromRGB(0, 0, 0),
                            5
                        )
                    elseif descendant.Name == "Figure" then
                        createNotification(
                            "üëπ FIGURE!",
                            "Stay quiet and avoid making noise!",
                            Color3.fromRGB(139, 0, 0),
                            8
                        )
                    end
                end
            end
        end
    end)
end

setupEntityNotifications()

-- ============================================================================
-- STEP 8: AUTO COLLECT SYSTEM
-- ============================================================================

print("STEP 8: Setting up Auto Collect System...")

local function toggleAutoCollect()
    if autoCollectEnabled then
        autoCollectConnection = RunService.Heartbeat:Connect(function()
            if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                for _, item in ipairs(workspace.CurrentRooms:GetDescendants()) do
                    if item:IsA("Model") then
                        local itemNames = {
                            "GoldPile", "LighterObtain", "FlashlightObtain", 
                            "LockpickObtain", "CrucifixObtain", "BandageObtain", 
                            "VitaminObtain", "SkeletonKeyObtain"
                        }
                        
                        for _, name in ipairs(itemNames) do
                            if item.Name == name and item:FindFirstChild("Handle") or item:FindFirstChild("Main") then
                                local handle = item:FindFirstChild("Handle") or item:FindFirstChild("Main")
                                if handle and (handle.Position - player.Character.HumanoidRootPart.Position).Magnitude <= 20 then
                                    -- Teleport to item
                                    player.Character.HumanoidRootPart.CFrame = handle.CFrame
                                    wait(0.1)
                                    
                                    -- Fire proximity prompt
                                    for _, prompt in ipairs(item:GetDescendants()) do
                                        if prompt:IsA("ProximityPrompt") then
                                            fireproximityprompt(prompt)
                                            wait(0.05)
                                        end
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end)
        createNotification("‚úÖ Auto Collect", "Auto collect enabled!", Color3.fromRGB(0, 255, 0))
    else
        if autoCollectConnection then
            autoCollectConnection:Disconnect()
            autoCollectConnection = nil
        end
        createNotification("‚ùå Auto Collect", "Auto collect disabled!", Color3.fromRGB(255, 0, 0))
    end
end

-- ============================================================================
-- STEP 9: AUTO UNLOCK DOORS
-- ============================================================================

print("STEP 9: Setting up Auto Unlock System...")

local function toggleAutoUnlock()
    if autoUnlockEnabled then
        autoUnlockConnection = RunService.Heartbeat:Connect(function()
            for _, door in ipairs(workspace.CurrentRooms:GetDescendants()) do
                if door.Name == "Door" and door:FindFirstChild("Lock") then
                    for _, prompt in ipairs(door:GetDescendants()) do
                        if prompt:IsA("ProximityPrompt") and prompt.Enabled then
                            fireproximityprompt(prompt)
                            wait(0.1)
                        end
                    end
                end
            end
        end)
        createNotification("‚úÖ Auto Unlock", "Auto unlock doors enabled!", Color3.fromRGB(0, 255, 0))
    else
        if autoUnlockConnection then
            autoUnlockConnection:Disconnect()
            autoUnlockConnection = nil
        end
        createNotification("‚ùå Auto Unlock", "Auto unlock doors disabled!", Color3.fromRGB(255, 0, 0))
    end
end

-- ============================================================================
-- STEP 10: AUTO PROXIMITYPROMPT R (ADVANCED)
-- ============================================================================

print("STEP 10: Setting up Auto ProximityPrompt R...")

local function toggleAutoProximityPrompt()
    if autoProximityPromptEnabled then
        autoProximityPromptConnection = RunService.Heartbeat:Connect(function()
            if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                for _, prompt in ipairs(workspace:GetDescendants()) do
                    if prompt:IsA("ProximityPrompt") and prompt.Enabled then
                        local distance = (prompt.Parent.Position - player.Character.HumanoidRootPart.Position).Magnitude
                        if distance <= prompt.MaxActivationDistance + 5 then
                            fireproximityprompt(prompt)
                            wait(0.05)
                        end
                    end
                end
            end
        end)
        createNotification("‚úÖ Auto ProximityPrompt", "Auto R enabled - All prompts will auto-activate!", Color3.fromRGB(0, 255, 0))
    else
        if autoProximityPromptConnection then
            autoProximityPromptConnection:Disconnect()
            autoProximityPromptConnection = nil
        end
        createNotification("‚ùå Auto ProximityPrompt", "Auto R disabled!", Color3.fromRGB(255, 0, 0))
    end
end

-- ============================================================================
-- STEP 11: SPEED HACK
-- ============================================================================

print("STEP 11: Setting up Speed System...")

local function setSpeed(speed)
    if player.Character and player.Character:FindFirstChild("Humanoid") then
        player.Character.Humanoid.WalkSpeed = speed
        currentSpeed = speed
    end
end

-- ============================================================================
-- STEP 12: NOCLIP
-- ============================================================================

print("STEP 12: Setting up Noclip System...")

local function toggleNoclip()
    if noclipEnabled then
        noclipConnection = RunService.Stepped:Connect(function()
            if player.Character then
                for _, part in ipairs(player.Character:GetDescendants()) do
                    if part:IsA("BasePart") then
                        part.CanCollide = false
                    end
                end
            end
        end)
        createNotification("‚úÖ Noclip", "Noclip enabled!", Color3.fromRGB(0, 255, 0))
    else
        if noclipConnection then
            noclipConnection:Disconnect()
            noclipConnection = nil
        end
        if player.Character then
            for _, part in ipairs(player.Character:GetDescendants()) do
                if part:IsA("BasePart") then
                    part.CanCollide = true
                end
            end
        end
        createNotification("‚ùå Noclip", "Noclip disabled!", Color3.fromRGB(255, 0, 0))
    end
end

-- ============================================================================
-- STEP 13: GOD MODE
-- ============================================================================

print("STEP 13: Setting up God Mode...")

local function toggleGodMode()
    if godModeEnabled then
        -- Remove all damage connections
        for _, connection in ipairs(godModeConnections) do
            connection:Disconnect()
        end
        godModeConnections = {}
        
        -- God mode implementation
        if player.Character and player.Character:FindFirstChild("Humanoid") then
            local humanoid = player.Character.Humanoid
            
            -- Prevent health decrease
            table.insert(godModeConnections, humanoid:GetPropertyChangedSignal("Health"):Connect(function()
                if humanoid.Health < humanoid.MaxHealth then
                    humanoid.Health = humanoid.MaxHealth
                end
            end))
            
            -- Set max health
            humanoid.Health = humanoid.MaxHealth
        end
        
        createNotification("‚úÖ God Mode", "God mode enabled - You are invincible!", Color3.fromRGB(0, 255, 0))
    else
        for _, connection in ipairs(godModeConnections) do
            connection:Disconnect()
        end
        godModeConnections = {}
        createNotification("‚ùå God Mode", "God mode disabled!", Color3.fromRGB(255, 0, 0))
    end
end

-- ============================================================================
-- STEP 14: INF VITAMINS
-- ============================================================================

print("STEP 14: Setting up Infinite Vitamins...")

local function toggleInfVitamins()
    if infVitaminsEnabled then
        infVitaminsConnection = RunService.Heartbeat:Connect(function()
            if player.Character and player.Character:FindFirstChild("Humanoid") then
                player.Character.Humanoid.WalkSpeed = currentSpeed
            end
        end)
        createNotification("‚úÖ Inf Vitamins", "Speed will not decrease!", Color3.fromRGB(0, 255, 0))
    else
        if infVitaminsConnection then
            infVitaminsConnection:Disconnect()
            infVitaminsConnection = nil
        end
        createNotification("‚ùå Inf Vitamins", "Vitamins effect disabled!", Color3.fromRGB(255, 0, 0))
    end
end

-- ============================================================================
-- STEP 15: BYPASS ANTI-CHEAT
-- ============================================================================

print("STEP 15: Setting up Anti-Cheat Bypass...")

local function toggleBypassAntiCheat()
    if bypassAntiCheat then
        -- Hook remote events/functions
        local oldNamecall
        oldNamecall = hookmetamethod(game, "__namecall", function(self, ...)
            local args = {...}
            local method = getnamecallmethod()
            
            -- Block anti-cheat remotes
            if method == "FireServer" or method == "InvokeServer" then
                if string.find(tostring(self), "Anti") or string.find(tostring(self), "Check") or string.find(tostring(self), "Ban") then
                    return
                end
            end
            
            return oldNamecall(self, ...)
        end)
        
        table.insert(bypassConnections, {disconnect = function() end})
        
        createNotification("‚úÖ Anti-Cheat Bypass", "Bypass enabled!", Color3.fromRGB(0, 255, 0))
    else
        for _, connection in ipairs(bypassConnections) do
            if connection.disconnect then
                connection:disconnect()
            end
        end
        bypassConnections = {}
        createNotification("‚ùå Anti-Cheat Bypass", "Bypass disabled!", Color3.fromRGB(255, 0, 0))
    end
end

-- ============================================================================
-- STEP 16: MAIN GUI CREATION
-- ============================================================================

print("STEP 16: Creating Main GUI...")

local function createMainGUI()
    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "WenerHubMain"
    ScreenGui.ResetOnSpawn = false
    ScreenGui.Parent = game.CoreGui
    
    -- Main Frame
    local MainFrame = Instance.new("Frame")
    MainFrame.Name = "MainFrame"
    MainFrame.Size = UDim2.new(0, 650, 0, 450)
    MainFrame.Position = UDim2.new(0.5, -325, 0.5, -225)
    MainFrame.BackgroundColor3 = Color3.fromRGB(15, 15, 25)
    MainFrame.BorderSizePixel = 0
    MainFrame.Parent = ScreenGui
    
    local MainCorner = Instance.new("UICorner")
    MainCorner.CornerRadius = UDim.new(0, 15)
    MainCorner.Parent = MainFrame
    
    local MainStroke = Instance.new("UIStroke")
    MainStroke.Color = Color3.fromRGB(139, 0, 255)
    MainStroke.Thickness = 2
    MainStroke.Parent = MainFrame
    
    -- Title Bar
    local TitleBar = Instance.new("Frame")
    TitleBar.Name = "TitleBar"
    TitleBar.Size = UDim2.new(1, 0, 0, 50)
    TitleBar.BackgroundColor3 = Color3.fromRGB(20, 20, 30)
    TitleBar.BorderSizePixel = 0
    TitleBar.Parent = MainFrame
    
    local TitleCorner = Instance.new("UICorner")
    TitleCorner.CornerRadius = UDim.new(0, 15)
    TitleCorner.Parent = TitleBar
    
    local TitleLabel = Instance.new("TextLabel")
    TitleLabel.Size = UDim2.new(0, 200, 1, 0)
    TitleLabel.Position = UDim2.new(0, 15, 0, 0)
    TitleLabel.BackgroundTransparency = 1
    
    -- Set title based on key type
    if currentKeyData and currentKeyData.key == "Wene-Premium" then
        TitleLabel.Text = "[PREMIUM] Waner hub"
    else
        TitleLabel.Text = "Waner hub"
    end
    
    TitleLabel.TextColor3 = Color3.fromRGB(139, 0, 255)
    TitleLabel.Font = Enum.Font.GothamBold
    TitleLabel.TextSize = 20
    TitleLabel.TextXAlignment = Enum.TextXAlignment.Left
    TitleLabel.Parent = TitleBar
    
    local VersionLabel = Instance.new("TextLabel")
    VersionLabel.Size = UDim2.new(0, 150, 1, 0)
    VersionLabel.Position = UDim2.new(1, -165, 0, 0)
    VersionLabel.BackgroundTransparency = 1
    VersionLabel.Text = "v4.0 Ultimate"
    VersionLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
    VersionLabel.Font = Enum.Font.Gotham
    VersionLabel.TextSize = 14
    VersionLabel.TextXAlignment = Enum.TextXAlignment.Right
    VersionLabel.Parent = TitleBar
    
    -- Close Button
    local CloseBtn = Instance.new("TextButton")
    CloseBtn.Size = UDim2.new(0, 40, 0, 40)
    CloseBtn.Position = UDim2.new(1, -45, 0, 5)
    CloseBtn.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
    CloseBtn.Text = "‚úï"
    CloseBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
    CloseBtn.Font = Enum.Font.GothamBold
    CloseBtn.TextSize = 20
    CloseBtn.Parent = TitleBar
    
    local CloseCorner = Instance.new("UICorner")
    CloseCorner.CornerRadius = UDim.new(0, 10)
    CloseCorner.Parent = CloseBtn
    
    CloseBtn.MouseButton1Click:Connect(function()
        MainFrame.Visible = false
    end)
    
    -- Sidebar (Tabs)
    local Sidebar = Instance.new("Frame")
    Sidebar.Name = "Sidebar"
    Sidebar.Size = UDim2.new(0, 150, 1, -55)
    Sidebar.Position = UDim2.new(0, 5, 0, 55)
    Sidebar.BackgroundColor3 = Color3.fromRGB(20, 20, 30)
    Sidebar.BorderSizePixel = 0
    Sidebar.Parent = MainFrame
    
    local SidebarCorner = Instance.new("UICorner")
    SidebarCorner.CornerRadius = UDim.new(0, 10)
    SidebarCorner.Parent = Sidebar
    
    -- Content Area
    local ContentArea = Instance.new("Frame")
    ContentArea.Name = "ContentArea"
    ContentArea.Size = UDim2.new(1, -165, 1, -60)
    ContentArea.Position = UDim2.new(0, 160, 0, 55)
    ContentArea.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
    ContentArea.BorderSizePixel = 0
    ContentArea.Parent = MainFrame
    
    local ContentCorner = Instance.new("UICorner")
    ContentCorner.CornerRadius = UDim.new(0, 10)
    ContentCorner.Parent = ContentArea
    
    -- Scroll Frame for Content
    local ScrollFrame = Instance.new("ScrollingFrame")
    ScrollFrame.Size = UDim2.new(1, -10, 1, -10)
    ScrollFrame.Position = UDim2.new(0, 5, 0, 5)
    ScrollFrame.BackgroundTransparency = 1
    ScrollFrame.ScrollBarThickness = 6
    ScrollFrame.ScrollBarImageColor3 = Color3.fromRGB(139, 0, 255)
    ScrollFrame.BorderSizePixel = 0
    ScrollFrame.Parent = ContentArea
    
    -- UI List Layout for ScrollFrame
    local ContentLayout = Instance.new("UIListLayout")
    ContentLayout.Padding = UDim.new(0, 10)
    ContentLayout.Parent = ScrollFrame
    
    -- Function to create tab button
    local selectedTab = nil
    local function createTabButton(text, icon, content)
        local TabButton = Instance.new("TextButton")
        TabButton.Size = UDim2.new(1, -10, 0, 40)
        TabButton.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
        TabButton.Text = ""
        TabButton.Parent = Sidebar
        
        local TabCorner = Instance.new("UICorner")
        TabCorner.CornerRadius = UDim.new(0, 8)
        TabCorner.Parent = TabButton
        
        local Icon = Instance.new("TextLabel")
        Icon.Size = UDim2.new(0, 30, 1, 0)
        Icon.Position = UDim2.new(0, 5, 0, 0)
        Icon.BackgroundTransparency = 1
        Icon.Text = icon
        Icon.TextColor3 = Color3.fromRGB(200, 200, 200)
        Icon.Font = Enum.Font.GothamBold
        Icon.TextSize = 18
        Icon.Parent = TabButton
        
        local Label = Instance.new("TextLabel")
        Label.Size = UDim2.new(1, -40, 1, 0)
        Label.Position = UDim2.new(0, 35, 0, 0)
        Label.BackgroundTransparency = 1
        Label.Text = text
        Label.TextColor3 = Color3.fromRGB(200, 200, 200)
        Label.Font = Enum.Font.Gotham
        Label.TextSize = 14
        Label.TextXAlignment = Enum.TextXAlignment.Left
        Label.Parent = TabButton
        
        TabButton.MouseButton1Click:Connect(function()
            -- Clear previous content
            for _, child in ipairs(ScrollFrame:GetChildren()) do
                if child:IsA("Frame") or child:IsA("TextLabel") then
                    child:Destroy()
                end
            end
            
            -- Update selected tab appearance
            if selectedTab then
                selectedTab.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
                selectedTab:FindFirstChild("Label").TextColor3 = Color3.fromRGB(200, 200, 200)
                selectedTab:FindFirstChild("Icon").TextColor3 = Color3.fromRGB(200, 200, 200)
            end
            
            TabButton.BackgroundColor3 = Color3.fromRGB(139, 0, 255)
            Label.TextColor3 = Color3.fromRGB(255, 255, 255)
            Icon.TextColor3 = Color3.fromRGB(255, 255, 255)
            selectedTab = TabButton
            
            -- Load content
            content()
        end)
        
        return TabButton
    end
    
    -- Function to create toggle button
    local function createToggle(parent, text, callback, defaultState)
        local ToggleFrame = Instance.new("Frame")
        ToggleFrame.Size = UDim2.new(1, 0, 0, 45)
        ToggleFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
        ToggleFrame.BorderSizePixel = 0
        ToggleFrame.Parent = parent
        
        local ToggleCorner = Instance.new("UICorner")
        ToggleCorner.CornerRadius = UDim.new(0, 8)
        ToggleCorner.Parent = ToggleFrame
        
        local ToggleLabel = Instance.new("TextLabel")
        ToggleLabel.Size = UDim2.new(1, -70, 1, 0)
        ToggleLabel.Position = UDim2.new(0, 10, 0, 0)
        ToggleLabel.BackgroundTransparency = 1
        ToggleLabel.Text = text
        ToggleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
        ToggleLabel.Font = Enum.Font.Gotham
        ToggleLabel.TextSize = 14
        ToggleLabel.TextXAlignment = Enum.TextXAlignment.Left
        ToggleLabel.Parent = ToggleFrame
        
        local ToggleButton = Instance.new("TextButton")
        ToggleButton.Size = UDim2.new(0, 50, 0, 25)
        ToggleButton.Position = UDim2.new(1, -60, 0.5, -12.5)
        ToggleButton.BackgroundColor3 = defaultState and Color3.fromRGB(0, 255, 0) or Color3.fromRGB(255, 0, 0)
        ToggleButton.Text = defaultState and "ON" or "OFF"
        ToggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
        ToggleButton.Font = Enum.Font.GothamBold
        ToggleButton.TextSize = 12
        ToggleButton.Parent = ToggleFrame
        
        local ToggleBtnCorner = Instance.new("UICorner")
        ToggleBtnCorner.CornerRadius = UDim.new(0, 8)
        ToggleBtnCorner.Parent = ToggleButton
        
        local state = defaultState
        ToggleButton.MouseButton1Click:Connect(function()
            state = not state
            ToggleButton.Text = state and "ON" or "OFF"
            ToggleButton.BackgroundColor3 = state and Color3.fromRGB(0, 255, 0) or Color3.fromRGB(255, 0, 0)
            callback(state)
        end)
        
        return ToggleFrame
    end
    
    -- Function to create slider
    local function createSlider(parent, text, min, max, default, callback)
        local SliderFrame = Instance.new("Frame")
        SliderFrame.Size = UDim2.new(1, 0, 0, 60)
        SliderFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
        SliderFrame.BorderSizePixel = 0
        SliderFrame.Parent = parent
        
        local SliderCorner = Instance.new("UICorner")
        SliderCorner.CornerRadius = UDim.new(0, 8)
        SliderCorner.Parent = SliderFrame
        
        local SliderLabel = Instance.new("TextLabel")
        SliderLabel.Size = UDim2.new(1, -20, 0, 25)
        SliderLabel.Position = UDim2.new(0, 10, 0, 5)
        SliderLabel.BackgroundTransparency = 1
        SliderLabel.Text = text .. ": " .. default
        SliderLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
        SliderLabel.Font = Enum.Font.Gotham
        SliderLabel.TextSize = 14
        SliderLabel.TextXAlignment = Enum.TextXAlignment.Left
        SliderLabel.Parent = SliderFrame
        
        local SliderBar = Instance.new("Frame")
        SliderBar.Size = UDim2.new(1, -20, 0, 8)
        SliderBar.Position = UDim2.new(0, 10, 0, 35)
        SliderBar.BackgroundColor3 = Color3.fromRGB(50, 50, 60)
        SliderBar.BorderSizePixel = 0
        SliderBar.Parent = SliderFrame
        
        local SliderBarCorner = Instance.new("UICorner")
        SliderBarCorner.CornerRadius = UDim.new(1, 0)
        SliderBarCorner.Parent = SliderBar
        
        local SliderFill = Instance.new("Frame")
        SliderFill.Size = UDim2.new((default - min) / (max - min), 0, 1, 0)
        SliderFill.BackgroundColor3 = Color3.fromRGB(139, 0, 255)
        SliderFill.BorderSizePixel = 0
        SliderFill.Parent = SliderBar
        
        local SliderFillCorner = Instance.new("UICorner")
        SliderFillCorner.CornerRadius = UDim.new(1, 0)
        SliderFillCorner.Parent = SliderFill
        
        local SliderButton = Instance.new("TextButton")
        SliderButton.Size = UDim2.new(0, 20, 0, 20)
        SliderButton.Position = UDim2.new((default - min) / (max - min), -10, 0.5, -10)
        SliderButton.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
        SliderButton.Text = ""
        SliderButton.Parent = SliderBar
        
        local SliderBtnCorner = Instance.new("UICorner")
        SliderBtnCorner.CornerRadius = UDim.new(1, 0)
        SliderBtnCorner.Parent = SliderButton
        
        local dragging = false
        SliderButton.MouseButton1Down:Connect(function()
            dragging = true
        end)
        
        UserInputService.InputEnded:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                dragging = false
            end
        end)
        
        RunService.RenderStepped:Connect(function()
            if dragging then
                local mouse = UserInputService:GetMouseLocation()
                local relativeX = math.clamp(mouse.X - SliderBar.AbsolutePosition.X, 0, SliderBar.AbsoluteSize.X)
                local percentage = relativeX / SliderBar.AbsoluteSize.X
                local value = math.floor(min + (max - min) * percentage)
                
                SliderLabel.Text = text .. ": " .. value
                SliderFill.Size = UDim2.new(percentage, 0, 1, 0)
                SliderButton.Position = UDim2.new(percentage, -10, 0.5, -10)
                
                callback(value)
            end
        end)
        
        return SliderFrame
    end
    
    -- Function to create button
    local function createButton(parent, text, callback)
        local ButtonFrame = Instance.new("TextButton")
        ButtonFrame.Size = UDim2.new(1, 0, 0, 45)
        ButtonFrame.BackgroundColor3 = Color3.fromRGB(139, 0, 255)
        ButtonFrame.Text = text
        ButtonFrame.TextColor3 = Color3.fromRGB(255, 255, 255)
        ButtonFrame.Font = Enum.Font.GothamBold
        ButtonFrame.TextSize = 14
        ButtonFrame.Parent = parent
        
        local ButtonCorner = Instance.new("UICorner")
        ButtonCorner.CornerRadius = UDim.new(0, 8)
        ButtonCorner.Parent = ButtonFrame
        
        ButtonFrame.MouseButton1Click:Connect(callback)
        
        return ButtonFrame
    end
    
    -- TAB 1: ESP
    local espTab = createTabButton("ESP", "üëÅÔ∏è", function()
        createToggle(ScrollFrame, "Door ESP", function(state)
            doorEspEnabled = state
            updateDoorESP()
        end, false)
        
        createToggle(ScrollFrame, "Key ESP", function(state)
            keyEspEnabled = state
            updateKeyESP()
        end, false)
        
        createToggle(ScrollFrame, "Entity ESP", function(state)
            entityEspEnabled = state
            updateEntityESP()
        end, false)
        
        createToggle(ScrollFrame, "Player ESP", function(state)
            playerEspEnabled = state
            updatePlayerESP()
        end, false)
        
        createToggle(ScrollFrame, "Item ESP", function(state)
            itemEspEnabled = state
            updateItemESP()
        end, false)
        
        createToggle(ScrollFrame, "Book ESP", function(state)
            bookEspEnabled = state
            updateBookESP()
        end, false)
        
        createButton(ScrollFrame, "Clear All ESP", function()
            clearAllESP()
            createNotification("üóëÔ∏è ESP Cleared", "All ESP removed!", Color3.fromRGB(255, 255, 0))
        end)
        
        ScrollFrame.CanvasSize = UDim2.new(0, 0, 0, ContentLayout.AbsoluteContentSize.Y + 10)
    end)
    
    -- TAB 2: Auto Features
    createTabButton("Auto", "ü§ñ", function()
        createToggle(ScrollFrame, "Auto Collect Items", function(state)
            autoCollectEnabled = state
            toggleAutoCollect()
        end, false)
        
        createToggle(ScrollFrame, "Auto Unlock Doors", function(state)
            autoUnlockEnabled = state
            toggleAutoUnlock()
        end, false)
        
        createToggle(ScrollFrame, "Auto ProximityPrompt R", function(state)
            autoProximityPromptEnabled = state
            toggleAutoProximityPrompt()
        end, false)
        
        createToggle(ScrollFrame, "Infinite Vitamins", function(state)
            infVitaminsEnabled = state
            toggleInfVitamins()
        end, false)
        
        ScrollFrame.CanvasSize = UDim2.new(0, 0, 0, ContentLayout.AbsoluteContentSize.Y + 10)
    end)
    
    -- TAB 3: Movement
    createTabButton("Movement", "üèÉ", function()
        createSlider(ScrollFrame, "WalkSpeed", 16, 150, 16, function(value)
            setSpeed(value)
        end)
        
        createToggle(ScrollFrame, "Noclip", function(state)
            noclipEnabled = state
            toggleNoclip()
        end, false)
        
        createToggle(ScrollFrame, "God Mode", function(state)
            godModeEnabled = state
            toggleGodMode()
        end, false)
        
        ScrollFrame.CanvasSize = UDim2.new(0, 0, 0, ContentLayout.AbsoluteContentSize.Y + 10)
    end)
    
    -- TAB 4: Notifications
    createTabButton("Notifs", "üîî", function()
        createToggle(ScrollFrame, "Rush Notification", function(state)
            rushNotifEnabled = state
        end, false)
        
        createToggle(ScrollFrame, "All Entity Notifications", function(state)
            allEntityNotifications = state
        end, false)
        
        ScrollFrame.CanvasSize = UDim2.new(0, 0, 0, ContentLayout.AbsoluteContentSize.Y + 10)
    end)
    
    -- TAB 5: Misc
    createTabButton("Misc", "‚öôÔ∏è", function()
        createToggle(ScrollFrame, "Bypass Anti-Cheat", function(state)
            bypassAntiCheat = state
            toggleBypassAntiCheat()
        end, false)
        
        createButton(ScrollFrame, "Fullbright", function()
            Lighting.Brightness = 2
            Lighting.ClockTime = 14
            Lighting.FogEnd = 100000
            Lighting.GlobalShadows = false
            Lighting.OutdoorAmbient = Color3.fromRGB(128, 128, 128)
            createNotification("üí° Fullbright", "Fullbright enabled!", Color3.fromRGB(255, 255, 0))
        end)
        
        createButton(ScrollFrame, "Remove Fog", function()
            Lighting.FogEnd = 100000
            for _, v in pairs(Lighting:GetDescendants()) do
                if v:IsA("Atmosphere") then
                    v:Destroy()
                end
            end
            createNotification("üå´Ô∏è Fog Removed", "All fog has been removed!", Color3.fromRGB(255, 255, 0))
        end)
        
        createButton(ScrollFrame, "Rejoin Server", function()
            TeleportService:Teleport(game.PlaceId, player)
        end)
        
        createButton(ScrollFrame, "Delete Key (Reset)", function()
            if isfile("WenerHub/Key.json") then
                delfile("WenerHub/Key.json")
                createNotification("üóëÔ∏è Key Deleted", "Key has been reset. Rejoin to enter new key!", Color3.fromRGB(255, 255, 0), 7)
            else
                createNotification("‚ùå No Key", "No saved key found!", Color3.fromRGB(255, 0, 0))
            end
        end)
        
        ScrollFrame.CanvasSize = UDim2.new(0, 0, 0, ContentLayout.AbsoluteContentSize.Y + 10)
    end)
    
    -- TAB 6: Credits
    createTabButton("Credits", "‚ÑπÔ∏è", function()
        local CreditsLabel = Instance.new("TextLabel")
        CreditsLabel.Size = UDim2.new(1, 0, 0, 300)
        CreditsLabel.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
        CreditsLabel.Text = [[
üåü WENER HUB v4.0 ULTIMATE COMPLETE

üëë Developer: winnertupiq52
üîê Secret Key System
‚ö° Modern ESP & Auto Functions

‚ú® Features:
‚Ä¢ Modern ESP (Doors, Keys, Entities, Players, Items, Books)
‚Ä¢ Auto Collect Items
‚Ä¢ Auto Unlock Doors
‚Ä¢ Auto ProximityPrompt R
‚Ä¢ Speed Hack (16-150)
‚Ä¢ Noclip & God Mode
‚Ä¢ Infinite Vitamins
‚Ä¢ Entity Notifications (Rush, Ambush, Eyes, etc.)
‚Ä¢ Anti-Cheat Bypass
‚Ä¢ Fullbright & No Fog
‚Ä¢ Auto Execute & Auto Reconnect

üîë Secret Keys:
‚Ä¢ Wene-You (24h access)
‚Ä¢ Wene-Premium (Unlimited access)

üìÖ Version: v4.0 Ultimate Complete
üéØ Status: Fully Working
        ]]
        CreditsLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
        CreditsLabel.Font = Enum.Font.Gotham
        CreditsLabel.TextSize = 13
        CreditsLabel.TextWrapped = true
        CreditsLabel.TextYAlignment = Enum.TextYAlignment.Top
        CreditsLabel.Parent = ScrollFrame
        
        local CreditsCorner = Instance.new("UICorner")
        CreditsCorner.CornerRadius = UDim.new(0, 8)
        CreditsCorner.Parent = CreditsLabel
        
        local DiscordButton = Instance.new("TextButton")
        DiscordButton.Size = UDim2.new(1, 0, 0, 45)
        DiscordButton.BackgroundColor3 = Color3.fromRGB(88, 101, 242)
        DiscordButton.Text = "üí¨ Join Discord Community"
        DiscordButton.TextColor3 = Color3.fromRGB(255, 255, 255)
        DiscordButton.Font = Enum.Font.GothamBold
        DiscordButton.TextSize = 14
        DiscordButton.Parent = ScrollFrame
        
        local DiscordCorner = Instance.new("UICorner")
        DiscordCorner.CornerRadius = UDim.new(0, 8)
        DiscordCorner.Parent = DiscordButton
        
        DiscordButton.MouseButton1Click:Connect(function()
            setclipboard("https://discord.gg/wenerhub")
            createNotification("üí¨ Discord", "Discord link copied to clipboard!", Color3.fromRGB(88, 101, 242))
        end)
        
        ScrollFrame.CanvasSize = UDim2.new(0, 0, 0, ContentLayout.AbsoluteContentSize.Y + 10)
    end)
    
    -- UI List Layout for Sidebar
    local SidebarLayout = Instance.new("UIListLayout")
    SidebarLayout.Padding = UDim.new(0, 5)
    SidebarLayout.Parent = Sidebar
    
    -- Make GUI draggable
    local dragging
    local dragInput
    local dragStart
    local startPos
    
    local function update(input)
        local delta = input.Position - dragStart
        MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
    
    TitleBar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = MainFrame.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)
    
    TitleBar.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            dragInput = input
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            update(input)
        end
    end)
    
    -- Toggle GUI with Right Shift
    UserInputService.InputBegan:Connect(function(input, gameProcessed)
        if not gameProcessed and input.KeyCode == Enum.KeyCode.RightShift then
            MainFrame.Visible = not MainFrame.Visible
        end
    end)
    
    -- Load ESP tab by default
    espTab.MouseButton1Click:Fire()
    
    -- Show GUI with animation
    MainFrame.Position = UDim2.new(0.5, -325, -1, 0)
    TweenService:Create(MainFrame, TweenInfo.new(0.8, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
        Position = UDim2.new(0.5, -325, 0.5, -225)
    }):Play()
    
    print("‚úÖ Main GUI created successfully!")
    createNotification("üéâ WENER HUB LOADED", "Press RIGHT SHIFT to toggle GUI\nAll features are ready!", Color3.fromRGB(0, 255, 0), 8)
end

createMainGUI()

-- ============================================================================
-- STEP 17: CHARACTER RESPAWN HANDLING
-- ============================================================================

print("STEP 17: Setting up Character Respawn Handler...")

player.CharacterAdded:Connect(function(character)
    repeat wait() until character:FindFirstChild("Humanoid")
    repeat wait() until character:FindFirstChild("HumanoidRootPart")
    
    wait(1)
    
    -- Reapply speed
    if currentSpeed ~= 16 then
        setSpeed(currentSpeed)
    end
    
    -- Reapply god mode
    if godModeEnabled then
        toggleGodMode()
        toggleGodMode()
    end
    
    -- Reapply noclip
    if noclipEnabled then
        toggleNoclip()
        toggleNoclip()
    end
    
    createNotification("üîÑ Character Respawned", "Reapplying active features...", Color3.fromRGB(255, 255, 0))
end)

-- ============================================================================
-- STEP 18: INFINITE YIELD INTEGRATION (OPTIONAL ADMIN COMMANDS)
-- ============================================================================

print("STEP 18: Loading Admin Commands...")

local AdminCommands = {
    [".speed [number]"] = function(args)
        local speed = tonumber(args[1]) or 16
        setSpeed(speed)
        createNotification("‚ö° Speed Changed", "Speed set to: " .. speed, Color3.fromRGB(0, 255, 255))
    end,
    
    [".noclip"] = function()
        noclipEnabled = not noclipEnabled
        toggleNoclip()
    end,
    
    [".god"] = function()
        godModeEnabled = not godModeEnabled
        toggleGodMode()
    end,
    
    [".fullbright"] = function()
        Lighting.Brightness = 2
        Lighting.ClockTime = 14
        Lighting.FogEnd = 100000
        Lighting.GlobalShadows = false
        Lighting.OutdoorAmbient = Color3.fromRGB(128, 128, 128)
        createNotification("üí° Fullbright", "Enabled via command!", Color3.fromRGB(255, 255, 0))
    end,
    
    [".esp all"] = function()
        doorEspEnabled = true
        keyEspEnabled = true
        entityEspEnabled = true
        playerEspEnabled = true
        itemEspEnabled = true
        bookEspEnabled = true
        updateDoorESP()
        updateKeyESP()
        updateEntityESP()
        updatePlayerESP()
        updateItemESP()
        updateBookESP()
        createNotification("üëÅÔ∏è ESP All", "All ESP enabled!", Color3.fromRGB(0, 255, 255))
    end,
    
    [".esp off"] = function()
        clearAllESP()
        doorEspEnabled = false
        keyEspEnabled = false
        entityEspEnabled = false
        playerEspEnabled = false
        itemEspEnabled = false
        bookEspEnabled = false
        createNotification("üëÅÔ∏è ESP Off", "All ESP disabled!", Color3.fromRGB(255, 0, 0))
    end,
    
    [".autocollect"] = function()
        autoCollectEnabled = not autoCollectEnabled
        toggleAutoCollect()
    end,
    
    [".autounlock"] = function()
        autoUnlockEnabled = not autoUnlockEnabled
        toggleAutoUnlock()
    end,
    
    [".autor"] = function()
        autoProximityPromptEnabled = not autoProximityPromptEnabled
        toggleAutoProximityPrompt()
    end,
    
    [".rejoin"] = function()
        TeleportService:Teleport(game.PlaceId, player)
    end,
    
    [".cmds"] = function()
        createNotification("üìú Commands", ".speed [num] | .noclip | .god | .fullbright\n.esp all/off | .autocollect | .autounlock\n.autor | .rejoin | .cmds", Color3.fromRGB(139, 0, 255), 10)
    end
}

-- Chat command handler
player.Chatted:Connect(function(message)
    local args = message:split(" ")
    local command = args[1]:lower()
    table.remove(args, 1)
    
    for cmd, func in pairs(AdminCommands) do
        if cmd:find(command) then
            func(args)
            break
        end
    end
end)

-- ============================================================================
-- STEP 19: ANTI-AFK
-- ============================================================================

print("STEP 19: Setting up Anti-AFK...")

local VirtualUser = game:GetService("VirtualUser")
player.Idled:Connect(function()
    VirtualUser:CaptureController()
    VirtualUser:ClickButton2(Vector2.new())
    createNotification("üí§ Anti-AFK", "Prevented AFK kick!", Color3.fromRGB(255, 255, 0), 3)
end)

-- ============================================================================
-- STEP 20: PERFORMANCE MONITOR
-- ============================================================================

print("STEP 20: Setting up Performance Monitor...")

local function createPerformanceMonitor()
    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "WenerPerformance"
    ScreenGui.ResetOnSpawn = false
    ScreenGui.Parent = game.CoreGui
    
    local PerfFrame = Instance.new("Frame")
    PerfFrame.Size = UDim2.new(0, 200, 0, 100)
    PerfFrame.Position = UDim2.new(1, -210, 0, 150)
    PerfFrame.BackgroundColor3 = Color3.fromRGB(15, 15, 25)
    PerfFrame.BackgroundTransparency = 0.3
    PerfFrame.BorderSizePixel = 0
    PerfFrame.Parent = ScreenGui
    
    local PerfCorner = Instance.new("UICorner")
    PerfCorner.CornerRadius = UDim.new(0, 10)
    PerfCorner.Parent = PerfFrame
    
    local FPSLabel = Instance.new("TextLabel")
    FPSLabel.Size = UDim2.new(1, -10, 0, 25)
    FPSLabel.Position = UDim2.new(0, 5, 0, 5)
    FPSLabel.BackgroundTransparency = 1
    FPSLabel.Text = "FPS: 0"
    FPSLabel.TextColor3 = Color3.fromRGB(0, 255, 0)
    FPSLabel.Font = Enum.Font.GothamBold
    FPSLabel.TextSize = 14
    FPSLabel.TextXAlignment = Enum.TextXAlignment.Left
    FPSLabel.Parent = PerfFrame
    
    local PingLabel = Instance.new("TextLabel")
    PingLabel.Size = UDim2.new(1, -10, 0, 25)
    PingLabel.Position = UDim2.new(0, 5, 0, 30)
    PingLabel.BackgroundTransparency = 1
    PingLabel.Text = "Ping: 0ms"
    PingLabel.TextColor3 = Color3.fromRGB(0, 255, 255)
    PingLabel.Font = Enum.Font.GothamBold
    PingLabel.TextSize = 14
    PingLabel.TextXAlignment = Enum.TextXAlignment.Left
    PingLabel.Parent = PerfFrame
    
    local StatusLabel = Instance.new("TextLabel")
    StatusLabel.Size = UDim2.new(1, -10, 0, 25)
    StatusLabel.Position = UDim2.new(0, 5, 0, 55)
    StatusLabel.BackgroundTransparency = 1
    StatusLabel.Text = "Status: Active"
    StatusLabel.TextColor3 = Color3.fromRGB(255, 215, 0)
    StatusLabel.Font = Enum.Font.GothamBold
    StatusLabel.TextSize = 14
    StatusLabel.TextXAlignment = Enum.TextXAlignment.Left
    StatusLabel.Parent = PerfFrame
    
    local TimeLabel = Instance.new("TextLabel")
    TimeLabel.Size = UDim2.new(1, -10, 0, 20)
    TimeLabel.Position = UDim2.new(0, 5, 0, 75)
    TimeLabel.BackgroundTransparency = 1
    TimeLabel.Text = "Time: 00:00:00"
    TimeLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
    TimeLabel.Font = Enum.Font.Gotham
    TimeLabel.TextSize = 12
    TimeLabel.TextXAlignment = Enum.TextXAlignment.Left
    TimeLabel.Parent = PerfFrame
    
    local lastUpdate = tick()
    local frameCount = 0
    local startTime = tick()
    
    RunService.RenderStepped:Connect(function()
        frameCount = frameCount + 1
        
        if tick() - lastUpdate >= 1 then
            local fps = frameCount
            FPSLabel.Text = "FPS: " .. fps
            FPSLabel.TextColor3 = fps >= 50 and Color3.fromRGB(0, 255, 0) or fps >= 30 and Color3.fromRGB(255, 255, 0) or Color3.fromRGB(255, 0, 0)
            
            frameCount = 0
            lastUpdate = tick()
            
            local ping = game:GetService("Stats").Network.ServerStatsItem["Data Ping"]:GetValue()
            PingLabel.Text = "Ping: " .. math.floor(ping) .. "ms"
            PingLabel.TextColor3 = ping <= 100 and Color3.fromRGB(0, 255, 0) or ping <= 200 and Color3.fromRGB(255, 255, 0) or Color3.fromRGB(255, 0, 0)
            
            local elapsed = tick() - startTime
            local hours = math.floor(elapsed / 3600)
            local minutes = math.floor((elapsed % 3600) / 60)
            local seconds = math.floor(elapsed % 60)
            TimeLabel.Text = string.format("Time: %02d:%02d:%02d", hours, minutes, seconds)
            
            -- Update status
            local activeFeatures = 0
            if doorEspEnabled or keyEspEnabled or entityEspEnabled or playerEspEnabled or itemEspEnabled or bookEspEnabled then
                activeFeatures = activeFeatures + 1
            end
            if autoCollectEnabled or autoUnlockEnabled or autoProximityPromptEnabled then
                activeFeatures = activeFeatures + 1
            end
            if noclipEnabled or godModeEnabled then
                activeFeatures = activeFeatures + 1
            end
            
            StatusLabel.Text = "Features: " .. activeFeatures .. " Active"
        end
    end)
end

task.spawn(createPerformanceMonitor)

-- ============================================================================
-- STEP 21: KEY EXPIRY CHECKER
-- ============================================================================

print("STEP 21: Setting up Key Expiry Checker...")

if currentKeyData and currentKeyData.keyInfo.expire_time then
    task.spawn(function()
        while wait(60) do
            local isValid, timeLeft, hubName = checkKey()
            if not isValid then
                createNotification(
                    "‚è∞ KEY EXPIRED!",
                    "Your key has expired. Please restart the script and enter a new key!",
                    Color3.fromRGB(255, 0, 0),
                    10
                )
                wait(5)
                player:Kick("üîë Your key has expired. Please rejoin and enter a new key!")
                break
            elseif timeLeft and timeLeft <= 3600 then
                local hours = math.floor(timeLeft / 3600)
                local minutes = math.floor((timeLeft % 3600) / 60)
                createNotification(
                    "‚è∞ KEY EXPIRING SOON",
                    string.format("Your key will expire in %02d:%02d", hours, minutes),
                    Color3.fromRGB(255, 165, 0),
                    5
                )
            end
        end
    end)
end

-- ============================================================================
-- FINAL: SCRIPT COMPLETION
-- ============================================================================

print("=" :rep(70))
print("‚úÖ WENER HUB v4.0 ULTIMATE COMPLETE - FULLY LOADED!")
print("=" :rep(70))
print("üîê Key System: " .. (currentKeyData and "Active" or "Owner Access"))
if currentKeyData then
    print("üîë Current Key: " .. currentKeyData.key)
    print("üìõ Hub Name: " .. currentKeyData.keyInfo.hub_name)
    if currentKeyData.keyInfo.expire_time then
        local isValid, timeLeft = checkKey()
        if timeLeft then
            print("‚è∞ Time Remaining: " .. formatTime(timeLeft))
        end
    else
        print("üëë PREMIUM Access - No Expiry")
    end
end
print("üéÆ Game: Doors")
print("üë§ Player: " .. player.Name .. " (" .. player.DisplayName .. ")")
print("‚ö° All features loaded and ready!")
print("üéØ Press RIGHT SHIFT to toggle GUI")
print("üí¨ Type .cmds in chat for command list")
print("=" :rep(70))

-- Final notification
wait(2)
createNotification(
    "üéâ FULLY LOADED!",
    "WENER HUB v4.0 Ultimate Complete\nPress RIGHT SHIFT to open GUI\nType .cmds for commands",
    Color3.fromRGB(139, 0, 255),
    10
)

-- Success sound
local successSound = Instance.new("Sound")
successSound.SoundId = "rbxassetid://6026984224"
successSound.Volume = 0.5
successSound.Parent = game.SoundService
successSound:Play()
game:GetService("Debris"):AddItem(successSound, 3)

-- ============================================================================
-- END OF SCRIPT
-- ============================================================================
