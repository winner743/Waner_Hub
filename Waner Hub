-- Load Obsidian Library
local Obsidian = loadstring(game:HttpGet("https://raw.githubusercontent.com/deividcomsono/Obsidian/refs/heads/main/obsidian.lua"))()

-- Key System
local validKeys = {
    ["Wene-you"] = true,
    ["Wene-123"] = true,
    ["Wene-anti"] = true,
    ["Wene-police"] = true
}

local keyExpiry = "KeyExpiry_Doors"
local keyUsed = "KeyUsed_Doors"

local function checkKey()
    local savedKey = game:GetService("HttpService"):JSONDecode(readfile(keyUsed) or '""')
    local expiry = tonumber(readfile(keyExpiry) or "0")
    
    if savedKey ~= "" and validKeys[savedKey] and os.time() < expiry then
        return true
    end
    return false
end

local function saveKey(key)
    writefile(keyUsed, game:GetService("HttpService"):JSONEncode(key))
    writefile(keyExpiry, tostring(os.time() + 86400)) -- 24 jam
end

if not checkKey() then
    local keyInput = Obsidian:CreateKeySystem({
        Title = "Doors Script - Key System",
        Description = "Masukkan key untuk akses script",
        Keys = {"Wene-you", "Wene-123", "Wene-anti", "Wene-police"}
    })
    
    keyInput.OnKeyEnter = function(key)
        if validKeys[key] then
            saveKey(key)
            Obsidian:Notify("Key Valid!", "Expired dalam 24 jam", 5)
            return true
        else
            Obsidian:Notify("Key Invalid!", "Coba lagi", 3)
            return false
        end
    end
end

-- Main Window
local Window = Obsidian:CreateWindow({
    Title = "Doors Script",
    Size = UDim2.new(0, 500, 0, 400)
})

-- Variables
local player = game.Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoid = character:WaitForChild("Humanoid")

local autoProximity = false
local autoLoot = false
local godMode = false
local speedEnabled = false
local noclipEnabled = false
local espEnabled = false
local notifyEnabled = true

local speedValue = 16
local originalSpeed = humanoid.WalkSpeed

-- Info Tab
local InfoTab = Window:CreateTab("Info")

local InfoSection = InfoTab:CreateSection("Player Info")

InfoSection:CreateLabel("Avatar:")
InfoSection:CreateImage({
    Image = "https://www.roblox.com/headshot-thumbnail/image?userId="..player.UserId.."&width=150&height=150",
    Size = UDim2.new(0, 100, 0, 100)
})

InfoSection:CreateLabel("Username: "..player.Name)
InfoSection:CreateLabel("Display Name: "..player.DisplayName)

local expiryTime = tonumber(readfile(keyExpiry) or "0")
local hoursLeft = math.floor((expiryTime - os.time()) / 3600)
InfoSection:CreateLabel("Key Expired: "..hoursLeft.." jam lagi")

-- Auto Tab
local AutoTab = Window:CreateTab("Auto")

local AutoSection = AutoTab:CreateSection("Auto Features")

AutoSection:CreateToggle({
    Name = "Auto ProximityPrompt (R)",
    Default = false,
    Callback = function(value)
        autoProximity = value
    end
})

AutoSection:CreateToggle({
    Name = "Auto Ambil Barang di Laci",
    Default = false,
    Callback = function(value)
        autoLoot = value
    end
})

-- Bypass Tab
local BypassTab = Window:CreateTab("Bypass")

local BypassSection = BypassTab:CreateSection("Bypass Features (Anti-Detect)")

BypassSection:CreateToggle({
    Name = "God Mode Bypass",
    Default = false,
    Callback = function(value)
        godMode = value
        if godMode then
            humanoid.Health = humanoid.MaxHealth
            humanoid:GetPropertyChangedSignal("Health"):Connect(function()
                if godMode and humanoid.Health < humanoid.MaxHealth then
                    humanoid.Health = humanoid.MaxHealth
                end
            end)
        end
    end
})

BypassSection:CreateSlider({
    Name = "Speed Bypass",
    Min = 16,
    Max = 100,
    Default = 16,
    Callback = function(value)
        speedValue = value
        if speedEnabled then
            humanoid.WalkSpeed = speedValue
        end
    end
})

BypassSection:CreateToggle({
    Name = "Enable Speed",
    Default = false,
    Callback = function(value)
        speedEnabled = value
        if speedEnabled then
            humanoid.WalkSpeed = speedValue
        else
            humanoid.WalkSpeed = originalSpeed
        end
    end
})

BypassSection:CreateToggle({
    Name = "Noclip Bypass",
    Default = false,
    Callback = function(value)
        noclipEnabled = value
    end
})

-- Main Menu Tab
local MainTab = Window:CreateTab("Main Menu")

local MainSection = MainTab:CreateSection("Main Features")

MainSection:CreateSlider({
    Name = "Speed",
    Min = 16,
    Max = 100,
    Default = 16,
    Callback = function(value)
        humanoid.WalkSpeed = value
    end
})

MainSection:CreateToggle({
    Name = "God Mode",
    Default = false,
    Callback = function(value)
        if value then
            humanoid.Health = humanoid.MaxHealth
        end
    end
})

MainSection:CreateToggle({
    Name = "Noclip",
    Default = false,
    Callback = function(value)
        noclipEnabled = value
    end
})

-- ESP Tab
local ESPTab = Window:CreateTab("ESP")

local ESPSection = ESPTab:CreateSection("ESP Features")

ESPSection:CreateToggle({
    Name = "Enable ESP",
    Default = false,
    Callback = function(value)
        espEnabled = value
    end
})

-- Notify Tab
local NotifyTab = Window:CreateTab("Notify")

local NotifySection = NotifyTab:CreateSection("Notification Settings")

NotifySection:CreateToggle({
    Name = "Auto Notify Entity",
    Default = true,
    Callback = function(value)
        notifyEnabled = value
    end
})

-- Auto Proximity Logic
game:GetService("RunService").RenderStepped:Connect(function()
    if autoProximity then
        for _, v in pairs(workspace:GetDescendants()) do
            if v:IsA("ProximityPrompt") and v.Enabled then
                fireproximityprompt(v)
            end
        end
    end
    
    if autoLoot then
        for _, v in pairs(workspace:GetDescendants()) do
            if v.Name == "DrawerContainer" or v.Name == "Drawer" then
                local prompt = v:FindFirstChildOfClass("ProximityPrompt")
                if prompt then
                    fireproximityprompt(prompt)
                end
            end
        end
    end
    
    if noclipEnabled then
        for _, part in pairs(character:GetDescendants()) do
            if part:IsA("BasePart") then
                part.CanCollide = false
            end
        end
    end
end)

-- ESP Logic
local function createESP(obj, color)
    if not espEnabled then return end
    
    local highlight = Instance.new("Highlight")
    highlight.Parent = obj
    highlight.OutlineColor = color
    highlight.FillTransparency = 1
    highlight.OutlineTransparency = 0
    
    return highlight
end

workspace.ChildAdded:Connect(function(child)
    if espEnabled then
        if child.Name == "Key" then
            createESP(child, Color3.fromRGB(0, 0, 255)) -- Biru
        elseif child.Name:match("Door") then
            createESP(child, Color3.fromRGB(0, 255, 0)) -- Hijau
        elseif child.Name:match("Item") then
            createESP(child, Color3.fromRGB(128, 0, 128)) -- Ungu
        elseif child.Name:match("Closet") or child.Name:match("Wardrobe") then
            createESP(child, Color3.fromRGB(255, 165, 0)) -- Oren
        end
    end
end)

-- Entity Notify
workspace.ChildAdded:Connect(function(child)
    if notifyEnabled then
        local entities = {"Rush", "Ambush", "Eyes", "Screech", "Halt", "Seek", "Figure", "Jack", "Timothy"}
        for _, entity in pairs(entities) do
            if child.Name == entity then
                Obsidian:Notify("Entity Detected!", entity.." telah muncul!", 5)
            end
        end
    end
end)

Obsidian:Notify("Script Loaded!", "Doors Script berhasil dimuat", 3)
