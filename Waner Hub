-- WENER HUB v4.0 | ULTIMATE COMPLETE EDITION - HIDDEN KEY SYSTEM
print("=== WENER HUB v4.0 ULTIMATE COMPLETE - HIDDEN KEY EDITION ===")
print("üöÄ Loading complete script with all features + secret key system...")

-- ============================================================================
-- SERVICES & INITIALIZATION
-- ============================================================================

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Lighting = game:GetService("Lighting")
local UserInputService = game:GetService("UserInputService")
local TeleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")
local player = Players.LocalPlayer

-- Wait for character
repeat wait() until player.Character
repeat wait() until player.Character:FindFirstChild("HumanoidRootPart")

-- ============================================================================
-- VARIABLES UNTUK SEMUA FITUR
-- ============================================================================

local espObjects = {}
local currentSpeed = 16
local godModeEnabled = false
local noclipEnabled = false
local doorEspEnabled = false
local keyEspEnabled = false
local entityEspEnabled = false
local playerEspEnabled = false
local itemEspEnabled = false
local bookEspEnabled = false
local autoCollectEnabled = false
local autoUnlockEnabled = false
local autoProximityPromptEnabled = false
local infVitaminsEnabled = false
local rushNotifEnabled = false
local allEntityNotifications = false
local bypassAntiCheat = false

local noclipConnection
local autoCollectConnection
local autoUnlockConnection
local autoProximityPromptConnection
local infVitaminsConnection
local entityConnections = {}
local godModeConnections = {}
local bypassConnections = {}

-- ============================================================================
-- AUTO EXECUTE & AUTO RECONNECT SETUP
-- ============================================================================

local function setupAutoExecute()
    local autoExecuteCode = [[
-- WENER HUB ULTIMATE AUTO EXECUTE
print("üöÄ WENER HUB Auto Execute Triggered!")
loadstring(game:HttpGet("https://raw.githubusercontent.com/WanerScripts/WenerHub/main/doors-ultimate.lua"))()
]]
    
    if not isfolder("WenerHub") then
        makefolder("WenerHub")
    end
    
    writefile("WenerHub/AutoExecute.lua", autoExecuteCode)
    print("üöÄ Auto Execute: CONFIGURED")
end

local function setupAutoReconnect()
    local disconnectDetected = false
    
    local function createDisconnectGUI()
        local ScreenGui = Instance.new("ScreenGui")
        ScreenGui.Name = "WenerDisconnectGUI"
        ScreenGui.ResetOnSpawn = false
        ScreenGui.Parent = game.CoreGui
        
        local Blur = Instance.new("BlurEffect")
        Blur.Size = 30
        Blur.Parent = Lighting
        
        local Background = Instance.new("Frame")
        Background.Size = UDim2.new(1, 0, 1, 0)
        Background.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
        Background.BackgroundTransparency = 0.4
        Background.Parent = ScreenGui
        
        local DisconnectPanel = Instance.new("Frame")
        DisconnectPanel.Size = UDim2.new(0, 500, 0, 300)
        DisconnectPanel.Position = UDim2.new(0.5, -250, 0.5, -150)
        DisconnectPanel.BackgroundColor3 = Color3.fromRGB(15, 15, 25)
        DisconnectPanel.Parent = ScreenGui
        
        local Corner = Instance.new("UICorner")
        Corner.CornerRadius = UDim.new(0, 20)
        Corner.Parent = DisconnectPanel
        
        local Title = Instance.new("TextLabel")
        Title.Size = UDim2.new(1, 0, 0, 60)
        Title.BackgroundTransparency = 1
        Title.Text = "‚ö†Ô∏è CONNECTION LOST"
        Title.TextColor3 = Color3.fromRGB(255, 255, 255)
        Title.Font = Enum.Font.GothamBold
        Title.TextSize = 32
        Title.Parent = DisconnectPanel
        
        local Message = Instance.new("TextLabel")
        Message.Size = UDim2.new(1, -40, 0, 100)
        Message.Position = UDim2.new(0, 20, 0, 80)
        Message.BackgroundTransparency = 1
        Message.Text = "üîå Disconnected from server\nüì° Auto Reconnect in 5 seconds..."
        Message.TextColor3 = Color3.fromRGB(200, 200, 200)
        Message.Font = Enum.Font.Gotham
        Message.TextSize = 18
        Message.TextWrapped = true
        Message.Parent = DisconnectPanel
        
        local ReconnectBtn = Instance.new("TextButton")
        ReconnectBtn.Size = UDim2.new(0, 200, 0, 50)
        ReconnectBtn.Position = UDim2.new(0.5, -100, 0, 200)
        ReconnectBtn.BackgroundColor3 = Color3.fromRGB(0, 200, 0)
        ReconnectBtn.Text = "üîÑ Reconnect Now"
        ReconnectBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
        ReconnectBtn.Font = Enum.Font.GothamBold
        ReconnectBtn.TextSize = 18
        ReconnectBtn.Parent = DisconnectPanel
        
        local BtnCorner = Instance.new("UICorner")
        BtnCorner.CornerRadius = UDim.new(0, 10)
        BtnCorner.Parent = ReconnectBtn
        
        local countdown = 5
        task.spawn(function()
            while countdown > 0 do
                Message.Text = string.format("üîå Disconnected from server\nüì° Auto Reconnect in %d seconds...", countdown)
                countdown = countdown - 1
                wait(1)
            end
            TeleportService:Teleport(game.PlaceId, player)
        end)
        
        ReconnectBtn.MouseButton1Click:Connect(function()
            TeleportService:Teleport(game.PlaceId, player)
        end)
    end
    
    local lastHeartbeat = tick()
    RunService.Heartbeat:Connect(function()
        lastHeartbeat = tick()
    end)
    
    task.spawn(function()
        while true do
            wait(1)
            if tick() - lastHeartbeat > 8 and not disconnectDetected then
                disconnectDetected = true
                createDisconnectGUI()
                break
            end
        end
    end)
end

-- Enable auto bypass for ALL players
local function enableAutoBypassForAll()
    bypassAntiCheat = true
    
    -- Method 1: Hook metamethods
    local oldIndex, oldNewIndex
    pcall(function()
        oldIndex = hookmetamethod(game, "__index", function(self, key)
            if bypassAntiCheat and typeof(self) == "Instance" then
                if key == "WalkSpeed" or key == "JumpPower" or key == "Health" then
                    return oldIndex(self, key)
                end
            end
            return oldIndex(self, key)
        end)
    end)
    
    pcall(function()
        oldNewIndex = hookmetamethod(game, "__newindex", function(self, key, value)
            if bypassAntiCheat and typeof(self) == "Instance" then
                if key == "WalkSpeed" or key == "JumpPower" or key == "Health" then
                    return oldNewIndex(self, key, value)
                end
            end
            return oldNewIndex(self, key, value)
        end)
    end)
    
    -- Method 2: Disable common anticheat scripts
    task.spawn(function()
        while bypassAntiCheat do
            for _, obj in pairs(game:GetDescendants()) do
                if obj:IsA("LocalScript") then
                    local scriptNames = {"AntiCheat", "AC", "Anti", "Cheat", "Detection", "Ban"}
                    for _, name in pairs(scriptNames) do
                        if obj.Name:find(name) then
                            pcall(function()
                                obj.Enabled = false
                                obj:Destroy()
                            end)
                        end
                    end
                end
            end
            wait(2)
        end
    end)
    
    print("üõ°Ô∏è Auto Bypass: ENABLED for ALL players")
end

setupAutoExecute()
setupAutoReconnect()

-- ENABLE AUTO BYPASS FOR EVERYONE (OWNER TIDAK BYPASS)
enableAutoBypassForAll()

-- ============================================================================
-- STEP 1: LOADING SCREEN
-- ============================================================================

print("STEP 1: Creating Loading Screen...")

local function createLoadingScreen()
    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "WenerLoading"
    ScreenGui.ResetOnSpawn = false
    ScreenGui.Parent = game.CoreGui
    
    local Blur = Instance.new("BlurEffect")
    Blur.Size = 0
    Blur.Parent = Lighting
    
    local Background = Instance.new("Frame")
    Background.Size = UDim2.new(1, 0, 1, 0)
    Background.BackgroundColor3 = Color3.fromRGB(5, 5, 10)
    Background.BackgroundTransparency = 1
    Background.Parent = ScreenGui
    
    local Container = Instance.new("Frame")
    Container.Size = UDim2.new(0, 600, 0, 400)
    Container.Position = UDim2.new(0.5, -300, 0.5, -200)
    Container.BackgroundColor3 = Color3.fromRGB(15, 15, 25)
    Container.BackgroundTransparency = 1
    Container.Parent = ScreenGui
    
    local Corner = Instance.new("UICorner")
    Corner.CornerRadius = UDim.new(0, 25)
    Corner.Parent = Container
    
    local Title = Instance.new("TextLabel")
    Title.Size = UDim2.new(1, 0, 0, 80)
    Title.Position = UDim2.new(0, 0, 0, 40)
    Title.BackgroundTransparency = 1
    Title.Text = "WENER HUB v4.0"
    Title.TextColor3 = Color3.fromRGB(255, 255, 255)
    Title.Font = Enum.Font.GothamBold
    Title.TextSize = 54
    Title.TextTransparency = 1
    Title.Parent = Container
    
    local Subtitle = Instance.new("TextLabel")
    Subtitle.Size = UDim2.new(1, 0, 0, 40)
    Subtitle.Position = UDim2.new(0, 0, 0, 120)
    Subtitle.BackgroundTransparency = 1
    Subtitle.Text = "ULTIMATE COMPLETE EDITION"
    Subtitle.TextColor3 = Color3.fromRGB(200, 200, 200)
    Subtitle.Font = Enum.Font.Gotham
    Subtitle.TextSize = 24
    Subtitle.TextTransparency = 1
    Subtitle.Parent = Container
    
    local Status = Instance.new("TextLabel")
    Status.Size = UDim2.new(1, 0, 0, 40)
    Status.Position = UDim2.new(0, 0, 0, 180)
    Status.BackgroundTransparency = 1
    Status.Text = "Initializing premium systems..."
    Status.TextColor3 = Color3.fromRGB(100, 255, 100)
    Status.Font = Enum.Font.Gotham
    Status.TextSize = 18
    Status.TextTransparency = 1
    Status.Parent = Container
    
    local Progress = Instance.new("Frame")
    Progress.Size = UDim2.new(0, 0, 0, 8)
    Progress.Position = UDim2.new(0.075, 0, 0, 240)
    Progress.BackgroundColor3 = Color3.fromRGB(139, 0, 255)
    Progress.BorderSizePixel = 0
    Progress.BackgroundTransparency = 1
    Progress.Parent = Container
    
    local ProgressCorner = Instance.new("UICorner")
    ProgressCorner.CornerRadius = UDim.new(1, 0)
    ProgressCorner.Parent = Progress
    
    local SecretInfo = Instance.new("TextLabel")
    SecretInfo.Size = UDim2.new(1, -40, 0, 60)
    SecretInfo.Position = UDim2.new(0, 20, 0, 280)
    SecretInfo.BackgroundTransparency = 1
    SecretInfo.Text = "üîê Loading secret key system...\nüéØ All premium features included\n‚ö° Modern ESP & Auto Functions"
    SecretInfo.TextColor3 = Color3.fromRGB(255, 215, 0)
    SecretInfo.Font = Enum.Font.Gotham
    SecretInfo.TextSize = 14
    SecretInfo.TextWrapped = true
    SecretInfo.TextTransparency = 1
    SecretInfo.Parent = Container
    
    -- Show loading animation
    TweenService:Create(Blur, TweenInfo.new(1), {Size = 35}):Play()
    TweenService:Create(Background, TweenInfo.new(1), {BackgroundTransparency = 0.2}):Play()
    TweenService:Create(Container, TweenInfo.new(1), {BackgroundTransparency = 0.1}):Play()
    wait(1)
    
    TweenService:Create(Title, TweenInfo.new(0.8), {TextTransparency = 0}):Play()
    wait(0.4)
    TweenService:Create(Subtitle, TweenInfo.new(0.8), {TextTransparency = 0}):Play()
    wait(0.4)
    TweenService:Create(Status, TweenInfo.new(0.8), {TextTransparency = 0}):Play()
    TweenService:Create(Progress, TweenInfo.new(0.8), {BackgroundTransparency = 0}):Play()
    wait(0.4)
    TweenService:Create(SecretInfo, TweenInfo.new(0.8), {TextTransparency = 0}):Play()
    wait(0.8)
    
    local stages = {
        {text = "üöÄ Setting up Auto Execute...", progress = 0.15},
        {text = "üîÑ Configuring Auto Reconnect...", progress = 0.3},
        {text = "üõ°Ô∏è Enabling Auto Bypass for All...", progress = 0.4},
        {text = "üîë Loading Secret Key System...", progress = 0.55},
        {text = "üëÅÔ∏è Loading Modern ESP Systems...", progress = 0.7},
        {text = "ü§ñ Setting up Auto Features...", progress = 0.85},
        {text = "‚úÖ All Systems Ready!", progress = 1.0}
    }
    
    for _, stage in ipairs(stages) do
        Status.Text = stage.text
        TweenService:Create(Progress, TweenInfo.new(1), {Size = UDim2.new(0.85 * stage.progress, 0, 0, 8)}):Play()
        wait(1.2)
    end
    
    wait(1)
    
    -- Hide loading screen
    TweenService:Create(Title, TweenInfo.new(0.8), {TextTransparency = 1}):Play()
    TweenService:Create(Subtitle, TweenInfo.new(0.8), {TextTransparency = 1}):Play()
    TweenService:Create(Status, TweenInfo.new(0.8), {TextTransparency = 1}):Play()
    TweenService:Create(Progress, TweenInfo.new(0.8), {BackgroundTransparency = 1}):Play()
    TweenService:Create(SecretInfo, TweenInfo.new(0.8), {TextTransparency = 1}):Play()
    TweenService:Create(Container, TweenInfo.new(0.8), {BackgroundTransparency = 1}):Play()
    TweenService:Create(Background, TweenInfo.new(0.8), {BackgroundTransparency = 1}):Play()
    TweenService:Create(Blur, TweenInfo.new(1), {Size = 0}):Play()
    wait(1.2)
    
    Blur:Destroy()
    ScreenGui:Destroy()
    
    print("‚úÖ Loading Screen completed")
    return true
end

createLoadingScreen()

-- ============================================================================
-- STEP 2: SECRET KEY SYSTEM (NO OWNER BYPASS - EVERYONE NEEDS KEY)
-- ============================================================================

print("STEP 2: Starting Secret Key System...")

local KeySystemEnabled = true
-- üîê SECRET KEY - TIDAK DITAMPILKAN DI UI
local CorrectKey = "Wene-you"  -- KEY RAHASIA
local KeyExpireTime = 86400 -- 24 hours

local function formatTime(seconds)
    local hours = math.floor(seconds / 3600)
    local minutes = math.floor((seconds % 3600) / 60)
    local secs = seconds % 60
    return string.format("%02d:%02d:%02d", hours, minutes, secs)
end

local function generateFakeKeys()
    local fakeKeys = {
        "WenerHub2024", "UltimateKey", "PremiumAccess", "DoorsMaster",
        "SuperScript", "EliteHacker", "ProGamer", "MegaKey",
        "PowerUser", "VIPAccess", "AdminKey", "MasterCode",
        "SecretPass", "HiddenKey", "UltimatePass", "PrivateKey"
    }
    return fakeKeys
end

local function checkKey()
    if not isfolder("WenerHub") then
        makefolder("WenerHub")
        return false
    end
    
    if not isfile("WenerHub/Key.json") then
        return false
    end
    
    local success, data = pcall(function()
        return HttpService:JSONDecode(readfile("WenerHub/Key.json"))
    end)
    
    if not success or not data then return false end
    
    local currentTime = os.time()
    if data.key == CorrectKey and data.expire_time and currentTime < data.expire_time then
        return true, data.expire_time - currentTime
    end
    
    return false
end

local function saveKey()
    local currentTime = os.time()
    local expireTime = currentTime + KeyExpireTime
    
    local keyData = {
        key = CorrectKey,
        save_time = currentTime,
        expire_time = expireTime,
        user = player.Name,
        version = "v4.0_Ultimate_Complete_Hidden",
        expires_in_24_hours = true,
        secret_access = true
    }
    
    writefile("WenerHub/Key.json", HttpService:JSONEncode(keyData))
end

-- OWNER TIDAK LAGI BYPASS - SEMUA HARUS PAKAI KEY
local keySystemPassed = false

if KeySystemEnabled then
    local keyValid, timeLeft = checkKey()
    
    if not keyValid then
        print("üîë Key required for ALL users including owner...")
        
        local ScreenGui = Instance.new("ScreenGui")
        ScreenGui.Name = "WenerSecretKeySystem"
        ScreenGui.ResetOnSpawn = false
        ScreenGui.Parent = game.CoreGui
        
        local Blur = Instance.new("BlurEffect")
        Blur.Size = 0
        Blur.Parent = Lighting
        
        local Background = Instance.new("Frame")
        Background.Size = UDim2.new(1, 0, 1, 0)
        Background.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
        Background.BackgroundTransparency = 1
        Background.Parent = ScreenGui
        
        local MainFrame = Instance.new("Frame")
        MainFrame.Size = UDim2.new(0, 600, 0, 500)
        MainFrame.Position = UDim2.new(0.5, -300, 0.5, -250)
        MainFrame.BackgroundColor3 = Color3.fromRGB(15, 15, 25)
        MainFrame.BackgroundTransparency = 1
        MainFrame.Parent = ScreenGui
        
        local Corner = Instance.new("UICorner")
        Corner.CornerRadius = UDim.new(0, 25)
        Corner.Parent = MainFrame
        
        -- Show key system with animation
        TweenService:Create(Blur, TweenInfo.new(0.8), {Size = 30}):Play()
        TweenService:Create(Background, TweenInfo.new(0.8), {BackgroundTransparency = 0.3}):Play()
        TweenService:Create(MainFrame, TweenInfo.new(0.8), {BackgroundTransparency = 0.1}):Play()
        wait(0.8)
        
        local Title = Instance.new("TextLabel")
        Title.Size = UDim2.new(1, 0, 0, 80)
        Title.BackgroundTransparency = 1
        Title.Text = "üîê WENER HUB SECRET ACCESS"
        Title.TextColor3 = Color3.fromRGB(255, 255, 255)
        Title.Font = Enum.Font.GothamBold
        Title.TextSize = 28
        Title.TextTransparency = 1
        Title.Parent = MainFrame
        
        local SecretWarning = Instance.new("TextLabel")
        SecretWarning.Size = UDim2.new(1, -40, 0, 60)
        SecretWarning.Position = UDim2.new(0, 20, 0, 80)
        SecretWarning.BackgroundTransparency = 1
        SecretWarning.Text = "‚ö†Ô∏è UNIVERSAL KEY REQUIRED ‚ö†Ô∏è\nüîí Secret key required for ALL users (No bypass!)"
        SecretWarning.TextColor3 = Color3.fromRGB(255, 100, 100)
        SecretWarning.Font = Enum.Font.GothamBold
        SecretWarning.TextSize = 18
        SecretWarning.TextWrapped = true
        SecretWarning.TextTransparency = 1
        SecretWarning.Parent = MainFrame
        
        local FakeKeyDisplay = Instance.new("TextLabel")
        FakeKeyDisplay.Size = UDim2.new(1, -40, 0, 80)
        FakeKeyDisplay.Position = UDim2.new(0, 20, 0, 150)
        FakeKeyDisplay.BackgroundTransparency = 1
        FakeKeyDisplay.Text = "üéØ Try one of these keys:\nWenerHub2024 ‚Ä¢ UltimateKey ‚Ä¢ PremiumAccess\nDoorsMaster ‚Ä¢ SuperScript ‚Ä¢ EliteHacker"
        FakeKeyDisplay.TextColor3 = Color3.fromRGB(150, 150, 150)
        FakeKeyDisplay.Font = Enum.Font.Gotham
        FakeKeyDisplay.TextSize = 14
        FakeKeyDisplay.TextWrapped = true
        FakeKeyDisplay.TextTransparency = 1
        FakeKeyDisplay.Parent = MainFrame
        
        local SecretHint = Instance.new("TextLabel")
        SecretHint.Size = UDim2.new(1, -40, 0, 40)
        SecretHint.Position = UDim2.new(0, 20, 0, 240)
        SecretHint.BackgroundTransparency = 1
        SecretHint.Text = "üí° Hint: The secret key is hidden... look carefully üëÄ"
        SecretHint.TextColor3 = Color3.fromRGB(255, 215, 0)
        SecretHint.Font = Enum.Font.GothamBold
        SecretHint.TextSize = 16
        SecretHint.TextWrapped = true
        SecretHint.TextTransparency = 1
        SecretHint.Parent = MainFrame
        
        local KeyInput = Instance.new("TextBox")
        KeyInput.Size = UDim2.new(1, -40, 0, 55)
        KeyInput.Position = UDim2.new(0, 20, 0, 300)
        KeyInput.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
        KeyInput.BackgroundTransparency = 1
        KeyInput.PlaceholderText = "üîê Enter Secret Key..."
        KeyInput.PlaceholderColor3 = Color3.fromRGB(150, 150, 150)
        KeyInput.Text = ""
        KeyInput.TextColor3 = Color3.fromRGB(255, 255, 255)
        KeyInput.Font = Enum.Font.Gotham
        KeyInput.TextSize = 20
        KeyInput.Parent = MainFrame
        
        local InputCorner = Instance.new("UICorner")
        InputCorner.CornerRadius = UDim.new(0, 15)
        InputCorner.Parent = KeyInput
        
        local SubmitBtn = Instance.new("TextButton")
        SubmitBtn.Size = UDim2.new(1, -40, 0, 55)
        SubmitBtn.Position = UDim2.new(0, 20, 0, 375)
        SubmitBtn.BackgroundColor3 = Color3.fromRGB(0, 200, 0)
        SubmitBtn.BackgroundTransparency = 1
        SubmitBtn.Text = "üöÄ UNLOCK SECRET ACCESS"
        SubmitBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
        SubmitBtn.Font = Enum.Font.GothamBold
        SubmitBtn.TextSize = 20
        SubmitBtn.TextTransparency = 1
        SubmitBtn.Parent = MainFrame
        
        local BtnCorner = Instance.new("UICorner")
        BtnCorner.CornerRadius = UDim.new(0, 15)
        BtnCorner.Parent = SubmitBtn
        
        local Info = Instance.new("TextLabel")
        Info.Size = UDim2.new(1, -40, 0, 60)
        Info.Position = UDim2.new(0, 20, 0, 450)
        Info.BackgroundTransparency = 1
        Info.Text = "üåü Secret Features: Modern ESP ‚Ä¢ Auto ProximityPrompt R\nAuto Collect ‚Ä¢ 24-Hour Access ‚Ä¢ All Premium Functions\n‚ö†Ô∏è NO BYPASS - Everyone needs the key!"
        Info.TextColor3 = Color3.fromRGB(200, 200, 200)
        Info.Font = Enum.Font.Gotham
        Info.TextSize = 12
        Info.TextWrapped = true
        Info.TextTransparency = 1
        Info.Parent = MainFrame
        
        -- Animate key system elements
        TweenService:Create(Title, TweenInfo.new(0.6), {TextTransparency = 0}):Play()
        wait(0.3)
        TweenService:Create(SecretWarning, TweenInfo.new(0.6), {TextTransparency = 0}):Play()
        wait(0.3)
        TweenService:Create(FakeKeyDisplay, TweenInfo.new(0.6), {TextTransparency = 0}):Play()
        wait(0.3)
        TweenService:Create(SecretHint, TweenInfo.new(0.6), {TextTransparency = 0}):Play()
        wait(0.3)
        TweenService:Create(KeyInput, TweenInfo.new(0.6), {BackgroundTransparency = 0}):Play()
        wait(0.3)
        TweenService:Create(SubmitBtn, TweenInfo.new(0.6), {BackgroundTransparency = 0, TextTransparency = 0}):Play()
        wait(0.3)
        TweenService:Create(Info, TweenInfo.new(0.6), {TextTransparency = 0}):Play()
        
        -- Cycling fake key hints
        task.spawn(function()
            local fakeKeys = generateFakeKeys()
            while not keySystemPassed do
                wait(3)
                if FakeKeyDisplay and FakeKeyDisplay.Parent then
                    local randomKeys = {}
                    for i = 1, 6 do
                        table.insert(randomKeys, fakeKeys[math.random(1, #fakeKeys)])
                    end
                    FakeKeyDisplay.Text = "üéØ Try one of these keys:\n" .. 
                        randomKeys[1] .. " ‚Ä¢ " .. randomKeys[2] .. " ‚Ä¢ " .. randomKeys[3] .. "\n" ..
                        randomKeys[4] .. " ‚Ä¢ " .. randomKeys[5] .. " ‚Ä¢ " .. randomKeys[6]
                end
            end
        end)
        
        local submitted = false
        local attempts = 0
        SubmitBtn.MouseButton1Click:Connect(function()
            attempts = attempts + 1
            
            if KeyInput.Text == CorrectKey then
                saveKey()
                submitted = true
                keySystemPassed = true
                
                SubmitBtn.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
                SubmitBtn.Text = "‚úÖ SECRET ACCESS GRANTED!"
                SecretHint.Text = "üéâ Welcome! You found the hidden key!"
                SecretHint.TextColor3 = Color3.fromRGB(0, 255, 0)
                
                wait(2)
                
                -- Hide key system
                TweenService:Create(MainFrame, TweenInfo.new(0.8), {BackgroundTransparency = 1}):Play()
                TweenService:Create(Title, TweenInfo.new(0.8), {TextTransparency = 1}):Play()
                TweenService:Create(SecretWarning, TweenInfo.new(0.8), {TextTransparency = 1}):Play()
                TweenService:Create(FakeKeyDisplay, TweenInfo.new(0.8), {TextTransparency = 1}):Play()
                TweenService:Create(SecretHint, TweenInfo.new(0.8), {TextTransparency = 1}):Play()
                TweenService:Create(KeyInput, TweenInfo.new(0.8), {BackgroundTransparency = 1, TextTransparency = 1}):Play()
                TweenService:Create(SubmitBtn, TweenInfo.new(0.8), {BackgroundTransparency = 1, TextTransparency = 1}):Play()
                TweenService:Create(Info, TweenInfo.new(0.8), {TextTransparency = 1}):Play()
                TweenService:Create(Background, TweenInfo.new(0.8), {BackgroundTransparency = 1}):Play()
                TweenService:Create(Blur, TweenInfo.new(1), {Size = 0}):Play()
                wait(1.2)
                
                Blur:Destroy()
                ScreenGui:Destroy()
                
                print("‚úÖ Secret Key System passed with hidden key!")
            else
                SubmitBtn.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
                
                if attempts <= 3 then
                    SubmitBtn.Text = "‚ùå WRONG KEY! Try again... (" .. attempts .. "/‚àû)"
                    SecretHint.Text = "üí° Hint: The answer is closer than you think... üîç"
                elseif attempts <= 6 then
                    SubmitBtn.Text = "ü§î Still wrong! Keep trying..."
                    SecretHint.Text = "üßê Hint: It's something related to 'you'... üë§"
                elseif attempts <= 10 then
                    SubmitBtn.Text = "üòÖ Getting warmer..."
                    SecretHint.Text = "üî• Hint: Wene + you = ? (Think about it)"
                else
                    SubmitBtn.Text = "üôà The secret is in plain sight!"
                    SecretHint.Text = "üëÅÔ∏è Final Hint: Check the script comments... üìù"
                end
                
                wait(2)
                SubmitBtn.BackgroundColor3 = Color3.fromRGB(0, 200, 0)
                SubmitBtn.Text = "üöÄ UNLOCK SECRET ACCESS"
            end
        end)
        
        repeat wait(0.1) until submitted
    else
        keySystemPassed = true
        print("‚úÖ Valid secret key found - " .. formatTime(timeLeft) .. " remaining")
    end
else
    keySystemPassed = true
    print("‚úÖ Key system disabled")
end

-- ============================================================================
-- STEP 3: WELCOME SCREEN
-- ============================================================================

if keySystemPassed then
    print("STEP 3: Creating Welcome Screen...")
    
    local function createWelcomeScreen()
        local ScreenGui = Instance.new("ScreenGui")
        ScreenGui.Name = "WenerWelcome"
        ScreenGui.ResetOnSpawn = false
        ScreenGui.Parent = game.CoreGui
        
        local Blur = Instance.new("BlurEffect")
        Blur.Size = 0
        Blur.Parent = Lighting
        
        local Background = Instance.new("Frame")
        Background.Size = UDim2.new(1, 0, 1, 0)
        Background.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
        Background.BackgroundTransparency = 1
        Background.Parent = ScreenGui
        
        local WelcomeText = Instance.new("TextLabel")
        WelcomeText.Size = UDim2.new(0.8, 0, 0.2, 0)
        WelcomeText.Position = UDim2.new(0.1, 0, 0.3, 0)
        WelcomeText.BackgroundTransparency = 1
        WelcomeText.Text = "Welcome " .. player.DisplayName
        WelcomeText.TextColor3 = Color3.fromRGB(139, 0, 255)
        WelcomeText.Font = Enum.Font.GothamBold
        WelcomeText.TextSize = 48
        WelcomeText.TextStrokeTransparency = 0
        WelcomeText.TextTransparency = 1
        WelcomeText.Parent = ScreenGui
        
        local SecretText = Instance.new("TextLabel")
        SecretText.Size = UDim2.new(0.8, 0, 0.1, 0)
        SecretText.Position = UDim2.new(0.1, 0, 0.5, 0)
        SecretText.BackgroundTransparency = 1
        SecretText.Text = "üîê Secret Access Granted"
        SecretText.TextColor3 = Color3.fromRGB(255, 215, 0)
        SecretText.Font = Enum.Font.GothamBold
        SecretText.TextSize = 32
        SecretText.TextStrokeTransparency = 0
        SecretText.TextTransparency = 1
        SecretText.Parent = ScreenGui
        
        local HubText = Instance.new("TextLabel")
        HubText.Size = UDim2.new(1, 0, 0.3, 0)
        HubText.Position = UDim2.new(0, 0, 0.6, 0)
        HubText.BackgroundTransparency = 1
        HubText.Text = "Wener Hub"
        HubText.TextColor3 = Color3.fromRGB(255, 255, 255)
        HubText.Font = Enum.Font.GothamBold
        HubText.TextSize = 72
        HubText.TextStrokeTransparency = 0
        HubText.TextTransparency = 1
        HubText.Parent = ScreenGui
        
        -- Show welcome animation
        TweenService:Create(Blur, TweenInfo.new(1), {Size = 25}):Play()
        TweenService:Create(Background, TweenInfo.new(1), {BackgroundTransparency = 0.3}):Play()
        wait(1)
        
        TweenService:Create(WelcomeText, TweenInfo.new(1.5), {TextTransparency = 0}):Play()
        wait(1)
        TweenService:Create(SecretText, TweenInfo.new(1), {TextTransparency = 0}):Play()
        wait(1.5)
        
        TweenService:Create(HubText, TweenInfo.new(0.8), {TextTransparency = 0}):Play()
        wait(1)
        
        -- Glitch effect
        local glitchTexts = {
            "W3n3r HuB", "W‚Ç¨n‚Ç¨r H‚à™B", "W¬£n¬£r HŒºB", "W‚ààn‚ààr H‚à™√ü",
            "W‚àÇn‚àÇr Hub", "Wen‚Ç¨r Hub", "Wen3r Hub", "Wener Hub"
        }
        
        for i = 1, 12 do
            HubText.Text = glitchTexts[math.random(1, #glitchTexts)]
            HubText.TextColor3 = Color3.fromRGB(
                math.random(100, 255),
                math.random(100, 255), 
                math.random(100, 255)
            )
            HubText.Position = UDim2.new(
                math.random(-3, 3) / 100,
                0,
                0.6 + math.random(-1, 1) / 100,
                0
            )
            wait(0.12)
        end
        
        TweenService:Create(HubText, TweenInfo.new(1), {
            TextColor3 = Color3.fromRGB(139, 0, 255),
            Position = UDim2.new(0, 0, 0.6, 0)
        }):Play()
        HubText.Text = "Wener Hub"
        
        wait(2.5)
        
        -- Hide welcome screen
        TweenService:Create(WelcomeText, TweenInfo.new(1.5), {TextTransparency = 1}):Play()
        TweenService:Create(SecretText, TweenInfo.new(1.5), {TextTransparency = 1}):Play()
        TweenService:Create(HubText, TweenInfo.new(1.5), {TextTransparency = 1}):Play()
        TweenService:Create(Background, TweenInfo.new(1.5), {BackgroundTransparency = 1}):Play()
        TweenService:Create(Blur, TweenInfo.new(1.5), {Size = 0}):Play()
        
        wait(1.5)
        ScreenGui:Destroy()
        Blur:Destroy()
        
        print("‚úÖ Welcome Screen completed")
        return true
    end
    
    createWelcomeScreen()
end

-- ============================================================================
-- STEP 4: PERMANENT LOGO
-- ============================================================================

local function createPermanentLogo()
    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "WenerLogo"
    ScreenGui.ResetOnSpawn = false
    ScreenGui.Parent = game.CoreGui
    
    local Container = Instance.new("Frame")
    Container.Size = UDim2.new(0, 520, 0, 90)
    Container.Position = UDim2.new(0.5, -260, 0.02, 0)
    Container.BackgroundTransparency = 1
    Container.Parent = ScreenGui
    
    local WenerText = Instance.new("TextLabel")
    WenerText.Size = UDim2.new(0, 170, 1, 0)
    WenerText.Position = UDim2.new(0, 0, 0, 0)
    WenerText.BackgroundTransparency = 1
    WenerText.Text = "WENER"
    WenerText.TextColor3 = Color3.fromRGB(139, 0, 255)
    WenerText.Font = Enum.Font.GothamBold
    WenerText.TextSize = 44
    WenerText.TextStrokeTransparency = 0.3
    WenerText.TextXAlignment = Enum.TextXAlignment.Right
    WenerText.TextTransparency = 1
    WenerText.Parent = Container
    
    local HubText = Instance.new("TextLabel")
    HubText.Size = UDim2.new(0, 110, 1, 0)
    HubText.Position = UDim2.new(0, 180, 0, 0)
    HubText.BackgroundTransparency = 1
    HubText.Text = "HUB"
    HubText.TextColor3 = Color3.fromRGB(139, 0, 255)
    HubText.Font = Enum.Font.GothamBold
    HubText.TextSize = 44
    HubText.TextStrokeTransparency = 0.3
    HubText.TextXAlignment = Enum.TextXAlignment.Left
    HubText.TextTransparency = 1
    HubText.Parent = Container
    
    local VersionText = Instance.new("TextLabel")
    VersionText.Size = UDim2.new(0, 140, 0, 25)
    VersionText.Position = UDim2.new(0, 300, 1, -25)
    VersionText.BackgroundTransparency = 1
    VersionText.Text = "v4.0 Ultimate Complete Hidden"
    VersionText.TextColor3 = Color3.fromRGB(200, 200, 200)
    VersionText.Font = Enum.Font.Gotham
    VersionText.TextSize = 12
    VersionText.TextTransparency = 1
    VersionText.Parent = Container
    
    local SecretText = Instance.new("TextLabel")
    SecretText.Size = UDim2.new(0, 140, 0, 25)
    SecretText.Position = UDim2.new(0, 300, 0, 25)
    SecretText.BackgroundTransparency = 1
    SecretText.Text = "üîê Secret Access"
    SecretText.TextColor3 = Color3.fromRGB(255, 215, 0)
    SecretText.Font = Enum.Font.GothamBold
    SecretText.TextSize = 14
    SecretText.TextTransparency = 1
    SecretText.Parent = Container
    
    local UniversalText = Instance.new("TextLabel")
    UniversalText.Size = UDim2.new(0, 140, 0, 25)
    UniversalText.Position = UDim2.new(0, 300, 0, 0)
    UniversalText.BackgroundTransparency = 1
    UniversalText.Text = "üåç Universal Key"
    UniversalText.TextColor3 = Color3.fromRGB(100, 255, 255)
    UniversalText.Font = Enum.Font.GothamBold
    UniversalText.TextSize = 14
    UniversalText.TextTransparency = 1
    UniversalText.Parent = Container
    
    task.spawn(function()
        wait(2)
        TweenService:Create(WenerText, TweenInfo.new(1.5), {TextTransparency = 0}):Play()
        wait(0.3)
        TweenService:Create(HubText, TweenInfo.new(1.5), {TextTransparency = 0}):Play()
        wait(0.3)
        TweenService:Create(VersionText, TweenInfo.new(1.2), {TextTransparency = 0}):Play()
        wait(0.2)
        TweenService:Create(SecretText, TweenInfo.new(1.2), {TextTransparency = 0}):Play()
        wait(0.2)
        TweenService:Create(UniversalText, TweenInfo.new(1.2), {TextTransparency = 0}):Play()
    end)
end

task.spawn(createPermanentLogo)

-- ============================================================================
-- STEP 5: NOTIFICATION SYSTEM (FIXED & IMPROVED)
-- ============================================================================

print("STEP 5: Setting up Advanced Notification System...")

local notificationQueue = {}
local isShowingNotification = false
local currentNotifications = {}

local function createNotification(title, message, color, duration)
    table.insert(notificationQueue, {
        title = title,
        message = message,
        color = color or Color3.fromRGB(139, 0, 255),
        duration = duration or 5
    })
    
    if not isShowingNotification then
        task.spawn(function()
            while #notificationQueue > 0 do
                isShowingNotification = true
                local notif = table.remove(notificationQueue, 1)
                
                local ScreenGui = Instance.new("ScreenGui")
                ScreenGui.Name = "WenerNotification" .. tick()
                ScreenGui.ResetOnSpawn = false
                ScreenGui.Parent = game.CoreGui
                
                local yOffset = #currentNotifications * 110
                
                local NotificationFrame = Instance.new("Frame")
                NotificationFrame.Size = UDim2.new(0, 400, 0, 100)
                NotificationFrame.Position = UDim2.new(1, 20, 0, 50 + yOffset)
                NotificationFrame.BackgroundColor3 = Color3.fromRGB(15, 15, 25)
                NotificationFrame.BorderSizePixel = 0
                NotificationFrame.Parent = ScreenGui
                
                local Corner = Instance.new("UICorner")
                Corner.CornerRadius = UDim.new(0, 15)
                Corner.Parent = NotificationFrame
                
                local Stroke = Instance.new("UIStroke")
                Stroke.Color = notif.color
                Stroke.Thickness = 2
                Stroke.Parent = NotificationFrame
                
                local Gradient = Instance.new("UIGradient")
                Gradient.Color = ColorSequence.new({
                    ColorSequenceKeypoint.new(0, Color3.fromRGB(25, 25, 35)),
                    ColorSequenceKeypoint.new(1, Color3.fromRGB(15, 15, 25))
                })
                Gradient.Rotation = 45
                Gradient.Parent = NotificationFrame
                
                local TitleLabel = Instance.new("TextLabel")
                TitleLabel.Size = UDim2.new(1, -20, 0, 30)
                TitleLabel.Position = UDim2.new(0, 10, 0, 5)
                TitleLabel.BackgroundTransparency = 1
                TitleLabel.Text = notif.title
                TitleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
                TitleLabel.Font = Enum.Font.GothamBold
                TitleLabel.TextSize = 16
                TitleLabel.TextXAlignment = Enum.TextXAlignment.Left
                TitleLabel.Parent = NotificationFrame
                
                local MessageLabel = Instance.new("TextLabel")
                MessageLabel.Size = UDim2.new(1, -20, 0, 50)
                MessageLabel.Position = UDim2.new(0, 10, 0, 35)
                MessageLabel.BackgroundTransparency = 1
                MessageLabel.Text = notif.message
                MessageLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
                MessageLabel.Font = Enum.Font.Gotham
                MessageLabel.TextSize = 14
                MessageLabel.TextWrapped = true
                MessageLabel.TextXAlignment = Enum.TextXAlignment.Left
                MessageLabel.TextYAlignment = Enum.TextYAlignment.Top
                MessageLabel.Parent = NotificationFrame
                
                table.insert(currentNotifications, ScreenGui)
                
                -- Slide in animation
                TweenService:Create(NotificationFrame, TweenInfo.new(0.5, Enum.EasingStyle.Back), {
                    Position = UDim2.new(1, -420, 0, 50 + yOffset)
                }):Play()
                
                -- Glow effect animation
                task.spawn(function()
                    local startTime = tick()
                    while ScreenGui.Parent and tick() - startTime < notif.duration do
                        TweenService:Create(Stroke, TweenInfo.new(1, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut), {
                            Transparency = 0.3
                        }):Play()
                        wait(1)
                        TweenService:Create(Stroke, TweenInfo.new(1, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut), {
                            Transparency = 0
                        }):Play()
                        wait(1)
                    end
                end)
                
                -- Wait for duration
                wait(notif.duration)
                
                -- Slide out animation
                TweenService:Create(NotificationFrame, TweenInfo.new(0.5, Enum.EasingStyle.Back), {
                    Position = UDim2.new(1, 20, 0, 50 + yOffset)
                }):Play()
                wait(0.5)
                
                -- Remove from current notifications
                for i, gui in ipairs(currentNotifications) do
                    if gui == ScreenGui then
                        table.remove(currentNotifications, i)
                        break
                    end
                end
                
                ScreenGui:Destroy()
                wait(0.2)
            end
            isShowingNotification = false
        end)
    end
end

-- ============================================================================
-- STEP 6: ESP FUNCTIONS (MODERN & ADVANCED)
-- ============================================================================

print("STEP 6: Loading Advanced ESP Systems...")

local function createESP(object, text, color)
    if espObjects[object] then return end
    
    local BillboardGui = Instance.new("BillboardGui")
    BillboardGui.Name = "WenerESP"
    BillboardGui.Adornee = object
    BillboardGui.Size = UDim2.new(0, 200, 0, 50)
    BillboardGui.StudsOffset = Vector3.new(0, 2, 0)
    BillboardGui.AlwaysOnTop = true
    BillboardGui.Parent = object
    
    local Frame = Instance.new("Frame")
    Frame.Size = UDim2.new(1, 0, 1, 0)
    Frame.BackgroundTransparency = 0.3
    Frame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    Frame.BorderSizePixel = 0
    Frame.Parent = BillboardGui
    
    local Corner = Instance.new("UICorner")
    Corner.CornerRadius = UDim.new(0, 8)
    Corner.Parent = Frame
    
    local Stroke = Instance.new("UIStroke")
    Stroke.Color = color
    Stroke.Thickness = 2
    Stroke.Parent = Frame
    
    local TextLabel = Instance.new("TextLabel")
    TextLabel.Size = UDim2.new(1, 0, 1, 0)
    TextLabel.BackgroundTransparency = 1
    TextLabel.Text = text
    TextLabel.TextColor3 = color
    TextLabel.Font = Enum.Font.GothamBold
    TextLabel.TextSize = 14
    TextLabel.TextStrokeTransparency = 0.5
    TextLabel.Parent = Frame
    
    -- Glow effect
    task.spawn(function()
        while BillboardGui and BillboardGui.Parent do
            TweenService:Create(Stroke, TweenInfo.new(1, Enum.EasingStyle.Sine), {
                Transparency = 0.5
            }):Play()
            wait(1)
            TweenService:Create(Stroke, TweenInfo.new(1, Enum.EasingStyle.Sine), {
                Transparency = 0
            }):Play()
            wait(1)
        end
    end)
    
    espObjects[object] = BillboardGui
end

local function removeESP(object)
    if espObjects[object] then
        espObjects[object]:Destroy()
        espObjects[object] = nil
    end
end

local function clearAllESP()
    for object, esp in pairs(espObjects) do
        esp:Destroy()
    end
    espObjects = {}
end

-- Door ESP
local function toggleDoorESP()
    doorEspEnabled = not doorEspEnabled
    if doorEspEnabled then
        for _, obj in pairs(workspace:GetDescendants()) do
            if obj.Name == "Door" and obj:FindFirstChild("Door") then
                createESP(obj, "üö™ Door", Color3.fromRGB(255, 255, 0))
            end
        end
        createNotification("üö™ Door ESP", "Door ESP Enabled", Color3.fromRGB(255, 255, 0))
    else
        for obj, esp in pairs(espObjects) do
            if obj.Name == "Door" then
                removeESP(obj)
            end
        end
        createNotification("üö™ Door ESP", "Door ESP Disabled", Color3.fromRGB(255, 100, 100))
    end
end

-- Key ESP
local function toggleKeyESP()
    keyEspEnabled = not keyEspEnabled
    if keyEspEnabled then
        for _, obj in pairs(workspace:GetDescendants()) do
            if obj.Name == "KeyObtain" then
                createESP(obj, "üóùÔ∏è Key", Color3.fromRGB(255, 215, 0))
            end
        end
        createNotification("üóùÔ∏è Key ESP", "Key ESP Enabled", Color3.fromRGB(255, 215, 0))
    else
        for obj, esp in pairs(espObjects) do
            if obj.Name == "KeyObtain" then
                removeESP(obj)
            end
        end
        createNotification("üóùÔ∏è Key ESP", "Key ESP Disabled", Color3.fromRGB(255, 100, 100))
    end
end

-- Entity ESP
local function toggleEntityESP()
    entityEspEnabled = not entityEspEnabled
    if entityEspEnabled then
        for _, obj in pairs(workspace:GetDescendants()) do
            if obj.Name == "RushMoving" or obj.Name == "AmbushMoving" or obj.Name == "Eyes" or obj.Name == "Screech" then
                createESP(obj, "üëπ " .. obj.Name, Color3.fromRGB(255, 0, 0))
            end
        end
        createNotification("üëπ Entity ESP", "Entity ESP Enabled", Color3.fromRGB(255, 0, 0))
    else
        for obj, esp in pairs(espObjects) do
            if obj.Name == "RushMoving" or obj.Name == "AmbushMoving" or obj.Name == "Eyes" or obj.Name == "Screech" then
                removeESP(obj)
            end
        end
        createNotification("üëπ Entity ESP", "Entity ESP Disabled", Color3.fromRGB(255, 100, 100))
    end
end

-- Player ESP
local function togglePlayerESP()
    playerEspEnabled = not playerEspEnabled
    if playerEspEnabled then
        for _, player in pairs(Players:GetPlayers()) do
            if player ~= Players.LocalPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                createESP(player.Character.HumanoidRootPart, "üë§ " .. player.DisplayName, Color3.fromRGB(0, 255, 255))
            end
        end
        createNotification("üë§ Player ESP", "Player ESP Enabled", Color3.fromRGB(0, 255, 255))
    else
        for obj, esp in pairs(espObjects) do
            if obj.Parent and obj.Parent:FindFirstChild("Humanoid") then
                removeESP(obj)
            end
        end
        createNotification("üë§ Player ESP", "Player ESP Disabled", Color3.fromRGB(255, 100, 100))
    end
end

-- Item ESP
local function toggleItemESP()
    itemEspEnabled = not itemEspEnabled
    if itemEspEnabled then
        for _, obj in pairs(workspace:GetDescendants()) do
            if obj.Name == "LeverForGate" or obj.Name == "LiveHintBook" or obj.Name == "Battery" or obj.Name == "Crucifix" then
                createESP(obj, "üì¶ " .. obj.Name, Color3.fromRGB(0, 255, 0))
            end
        end
        createNotification("üì¶ Item ESP", "Item ESP Enabled", Color3.fromRGB(0, 255, 0))
    else
        for obj, esp in pairs(espObjects) do
            if obj.Name == "LeverForGate" or obj.Name == "LiveHintBook" or obj.Name == "Battery" or obj.Name == "Crucifix" then
                removeESP(obj)
            end
        end
        createNotification("üì¶ Item ESP", "Item ESP Disabled", Color3.fromRGB(255, 100, 100))
    end
end

-- Book ESP
local function toggleBookESP()
    bookEspEnabled = not bookEspEnabled
    if bookEspEnabled then
        for _, obj in pairs(workspace:GetDescendants()) do
            if obj.Name == "LiveHintBook" then
                createESP(obj, "üìö Book", Color3.fromRGB(255, 0, 255))
            end
        end
        createNotification("üìö Book ESP", "Book ESP Enabled", Color3.fromRGB(255, 0, 255))
    else
        for obj, esp in pairs(espObjects) do
            if obj.Name == "LiveHintBook" then
                removeESP(obj)
            end
        end
        createNotification("üìö Book ESP", "Book ESP Disabled", Color3.fromRGB(255, 100, 100))
    end
end

-- ============================================================================
-- STEP 7: AUTO FUNCTIONS (ADVANCED)
-- ============================================================================

print("STEP 7: Loading Advanced Auto Functions...")

-- Auto Collect
local function toggleAutoCollect()
    autoCollectEnabled = not autoCollectEnabled
    if autoCollectEnabled then
        autoCollectConnection = RunService.Heartbeat:Connect(function()
            if not player.Character or not player.Character:FindFirstChild("Humanoid") then return end
            
            for _, obj in pairs(workspace:GetDescendants()) do
                if obj:IsA("ProximityPrompt") and obj.ActionText == "Collect" then
                    local distance = (player.Character.HumanoidRootPart.Position - obj.Parent.Position).Magnitude
                    if distance <= 15 then
                        fireproximityprompt(obj)
                    end
                end
            end
        end)
        createNotification("üîÑ Auto Collect", "Auto Collect Enabled", Color3.fromRGB(0, 255, 0))
    else
        if autoCollectConnection then
            autoCollectConnection:Disconnect()
            autoCollectConnection = nil
        end
        createNotification("üîÑ Auto Collect", "Auto Collect Disabled", Color3.fromRGB(255, 100, 100))
    end
end

-- Auto Unlock
local function toggleAutoUnlock()
    autoUnlockEnabled = not autoUnlockEnabled
    if autoUnlockEnabled then
        autoUnlockConnection = RunService.Heartbeat:Connect(function()
            if not player.Character or not player.Character:FindFirstChild("Humanoid") then return end
            
            for _, obj in pairs(workspace:GetDescendants()) do
                if obj:IsA("ProximityPrompt") and (obj.ActionText == "Unlock" or obj.ActionText == "Open") then
                    local distance = (player.Character.HumanoidRootPart.Position - obj.Parent.Position).Magnitude
                    if distance <= 15 then
                        fireproximityprompt(obj)
                    end
                end
            end
        end)
        createNotification("üîì Auto Unlock", "Auto Unlock Enabled", Color3.fromRGB(255, 215, 0))
    else
        if autoUnlockConnection then
            autoUnlockConnection:Disconnect()
            autoUnlockConnection = nil
        end
        createNotification("üîì Auto Unlock", "Auto Unlock Disabled", Color3.fromRGB(255, 100, 100))
    end
end

-- Auto ProximityPrompt
local function toggleAutoProximityPrompt()
    autoProximityPromptEnabled = not autoProximityPromptEnabled
    if autoProximityPromptEnabled then
        autoProximityPromptConnection = RunService.Heartbeat:Connect(function()
            if not player.Character or not player.Character:FindFirstChild("Humanoid") then return end
            
            for _, obj in pairs(workspace:GetDescendants()) do
                if obj:IsA("ProximityPrompt") and obj.Enabled then
                    local distance = (player.Character.HumanoidRootPart.Position - obj.Parent.Position).Magnitude
                    if distance <= obj.MaxActivationDistance then
                        fireproximityprompt(obj)
                    end
                end
            end
        end)
        createNotification("ü§ñ Auto ProximityPrompt", "Auto ProximityPrompt Enabled", Color3.fromRGB(139, 0, 255))
    else
        if autoProximityPromptConnection then
            autoProximityPromptConnection:Disconnect()
            autoProximityPromptConnection = nil
        end
        createNotification("ü§ñ Auto ProximityPrompt", "Auto ProximityPrompt Disabled", Color3.fromRGB(255, 100, 100))
    end
end

-- ============================================================================
-- STEP 8: PLAYER MODIFICATIONS
-- ============================================================================

print("STEP 8: Loading Player Modifications...")

-- Speed
local function setSpeed(speed)
    currentSpeed = speed
    if player.Character and player.Character:FindFirstChild("Humanoid") then
        player.Character.Humanoid.WalkSpeed = speed
    end
    createNotification("üèÉ Speed", "Speed set to " .. speed, Color3.fromRGB(100, 255, 100))
end

-- God Mode
local function toggleGodMode()
    godModeEnabled = not godModeEnabled
    if godModeEnabled then
        godModeConnections[1] = player.Character.Humanoid.HealthChanged:Connect(function()
            player.Character.Humanoid.Health = player.Character.Humanoid.MaxHealth
        end)
        godModeConnections[2] = player.Character.Humanoid.Died:Connect(function()
            player.Character.Humanoid.Health = player.Character.Humanoid.MaxHealth
        end)
        createNotification("üõ°Ô∏è God Mode", "God Mode Enabled", Color3.fromRGB(255, 215, 0))
    else
        for _, connection in pairs(godModeConnections) do
            if connection then connection:Disconnect() end
        end
        godModeConnections = {}
        createNotification("üõ°Ô∏è God Mode", "God Mode Disabled", Color3.fromRGB(255, 100, 100))
    end
end

-- Noclip
local function toggleNoclip()
    noclipEnabled = not noclipEnabled
    if noclipEnabled then
        noclipConnection = RunService.Stepped:Connect(function()
            if player.Character then
                for _, part in pairs(player.Character:GetChildren()) do
                    if part:IsA("BasePart") then
                        part.CanCollide = false
                    end
                end
            end
        end)
        createNotification("üëª Noclip", "Noclip Enabled", Color3.fromRGB(200, 200, 255))
    else
        if noclipConnection then
            noclipConnection:Disconnect()
            noclipConnection = nil
        end
        if player.Character then
            for _, part in pairs(player.Character:GetChildren()) do
                if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
                    part.CanCollide = true
                end
            end
        end
        createNotification("üëª Noclip", "Noclip Disabled", Color3.fromRGB(255, 100, 100))
    end
end

-- Infinite Vitamins
local function toggleInfVitamins()
    infVitaminsEnabled = not infVitaminsEnabled
    if infVitaminsEnabled then
        infVitaminsConnection = RunService.Heartbeat:Connect(function()
            if player.Character and player.Character:FindFirstChild("Humanoid") then
                local vitamins = player.Backpack:FindFirstChild("Vitamins") or player.Character:FindFirstChild("Vitamins")
                if vitamins and vitamins:FindFirstChild("Values") then
                    vitamins.Values.Uses.Value = 999
                end
            end
        end)
        createNotification("üíä Inf Vitamins", "Infinite Vitamins Enabled", Color3.fromRGB(255, 100, 255))
    else
        if infVitaminsConnection then
            infVitaminsConnection:Disconnect()
            infVitaminsConnection = nil
        end
        createNotification("üíä Inf Vitamins", "Infinite Vitamins Disabled", Color3.fromRGB(255, 100, 100))
    end
end

-- ============================================================================
-- STEP 9: ENTITY NOTIFICATIONS & DETECTION
-- ============================================================================

print("STEP 9: Setting up Entity Detection System...")

local function createEntityNotification(entityName, color)
    if not allEntityNotifications and not rushNotifEnabled then return end
    
    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "WenerEntityWarning"
    ScreenGui.ResetOnSpawn = false
    ScreenGui.Parent = game.CoreGui
    
    local Warning = Instance.new("Frame")
    Warning.Size = UDim2.new(1, 0, 0.3, 0)
    Warning.Position = UDim2.new(0, 0, 0.35, 0)
    Warning.BackgroundColor3 = color
    Warning.BackgroundTransparency = 0.3
    Warning.BorderSizePixel = 0
    Warning.Parent = ScreenGui
    
    local WarningText = Instance.new("TextLabel")
    WarningText.Size = UDim2.new(1, 0, 1, 0)
    WarningText.BackgroundTransparency = 1
    WarningText.Text = "‚ö†Ô∏è " .. entityName:upper() .. " SPAWNED! ‚ö†Ô∏è"
    WarningText.TextColor3 = Color3.fromRGB(255, 255, 255)
    WarningText.Font = Enum.Font.GothamBold
    WarningText.TextSize = 48
    WarningText.TextStrokeTransparency = 0
    WarningText.Parent = Warning
    
    -- Flash effect
    task.spawn(function()
        for i = 1, 10 do
            Warning.BackgroundTransparency = 0.1
            wait(0.1)
            Warning.BackgroundTransparency = 0.7
            wait(0.1)
        end
        ScreenGui:Destroy()
    end)
    
    -- Sound warning
    task.spawn(function()
        for i = 1, 3 do
            local sound = Instance.new("Sound")
            sound.SoundId = "rbxasset://sounds/electronicpingshort.wav"
            sound.Volume = 0.5
            sound.Parent = workspace
            sound:Play()
            sound.Ended:Connect(function()
                sound:Destroy()
            end)
            wait(0.3)
        end
    end)
end

local function toggleRushNotifications()
    rushNotifEnabled = not rushNotifEnabled
    createNotification("‚ö†Ô∏è Rush Notifications", rushNotifEnabled and "Rush Notifications Enabled" or "Rush Notifications Disabled", 
        rushNotifEnabled and Color3.fromRGB(255, 0, 0) or Color3.fromRGB(255, 100, 100))
end

local function toggleAllEntityNotifications()
    allEntityNotifications = not allEntityNotifications
    createNotification("üëπ All Entity Notifications", allEntityNotifications and "All Entity Notifications Enabled" or "All Entity Notifications Disabled",
        allEntityNotifications and Color3.fromRGB(255, 0, 0) or Color3.fromRGB(255, 100, 100))
end

-- Entity detection
workspace.DescendantAdded:Connect(function(obj)
    if obj.Name == "RushMoving" and (rushNotifEnabled or allEntityNotifications) then
        createEntityNotification("RUSH", Color3.fromRGB(255, 0, 0))
        createNotification("‚ö†Ô∏è ENTITY ALERT", "üèÉ Rush has spawned! Hide immediately!", Color3.fromRGB(255, 0, 0), 7)
    elseif obj.Name == "AmbushMoving" and allEntityNotifications then
        createEntityNotification("AMBUSH", Color3.fromRGB(255, 100, 0))
        createNotification("‚ö†Ô∏è ENTITY ALERT", "üîÑ Ambush has spawned! Multiple hiding cycles!", Color3.fromRGB(255, 100, 0), 7)
    elseif obj.Name == "Eyes" and allEntityNotifications then
        createEntityNotification("EYES", Color3.fromRGB(0, 255, 255))
        createNotification("‚ö†Ô∏è ENTITY ALERT", "üëÅÔ∏è Eyes detected! Don't look at them!", Color3.fromRGB(0, 255, 255), 7)
    elseif obj.Name == "Screech" and allEntityNotifications then
        createEntityNotification("SCREECH", Color3.fromRGB(255, 255, 0))
        createNotification("‚ö†Ô∏è ENTITY ALERT", "üò± Screech is near! Listen for the psst sound!", Color3.fromRGB(255, 255, 0), 7)
    end
    
    -- Update ESP if enabled
    if entityEspEnabled and (obj.Name == "RushMoving" or obj.Name == "AmbushMoving" or obj.Name == "Eyes" or obj.Name == "Screech") then
        createESP(obj, "üëπ " .. obj.Name, Color3.fromRGB(255, 0, 0))
    end
end)

-- ============================================================================
-- STEP 10: MAIN GUI (COMPLETE)
-- ============================================================================

print("STEP 10: Creating Ultimate Complete GUI...")

local function createMainGUI()
    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "WenerHubUltimate"
    ScreenGui.ResetOnSpawn = false
    ScreenGui.Parent = game.CoreGui
    
    -- Main Frame
    local MainFrame = Instance.new("Frame")
    MainFrame.Size = UDim2.new(0, 800, 0, 600)
    MainFrame.Position = UDim2.new(0.5, -400, 0.5, -300)
    MainFrame.BackgroundColor3 = Color3.fromRGB(15, 15, 25)
    MainFrame.BorderSizePixel = 0
    MainFrame.Visible = false
    MainFrame.Parent = ScreenGui
    
    local MainCorner = Instance.new("UICorner")
    MainCorner.CornerRadius = UDim.new(0, 20)
    MainCorner.Parent = MainFrame
    
    local MainStroke = Instance.new("UIStroke")
    MainStroke.Color = Color3.fromRGB(139, 0, 255)
    MainStroke.Thickness = 3
    MainStroke.Parent = MainFrame
    
    -- Title Bar
    local TitleBar = Instance.new("Frame")
    TitleBar.Size = UDim2.new(1, 0, 0, 60)
    TitleBar.BackgroundColor3 = Color3.fromRGB(139, 0, 255)
    TitleBar.BorderSizePixel = 0
    TitleBar.Parent = MainFrame
    
    local TitleCorner = Instance.new("UICorner")
    TitleCorner.CornerRadius = UDim.new(0, 20)
    TitleCorner.Parent = TitleBar
    
    -- Fix title bar corners
    local TitleFix = Instance.new("Frame")
    TitleFix.Size = UDim2.new(1, 0, 0, 20)
    TitleFix.Position = UDim2.new(0, 0, 1, -20)
    TitleFix.BackgroundColor3 = Color3.fromRGB(139, 0, 255)
    TitleFix.BorderSizePixel = 0
    TitleFix.Parent = TitleBar
    
    local Title = Instance.new("TextLabel")
    Title.Size = UDim2.new(1, -120, 1, 0)
    Title.Position = UDim2.new(0, 20, 0, 0)
    Title.BackgroundTransparency = 1
    Title.Text = "WENER HUB v4.0 - ULTIMATE COMPLETE EDITION"
    Title.TextColor3 = Color3.fromRGB(255, 255, 255)
    Title.Font = Enum.Font.GothamBold
    Title.TextSize = 18
    Title.TextXAlignment = Enum.TextXAlignment.Left
    Title.Parent = TitleBar
    
    -- Close Button
    local CloseBtn = Instance.new("TextButton")
    CloseBtn.Size = UDim2.new(0, 40, 0, 40)
    CloseBtn.Position = UDim2.new(1, -50, 0, 10)
    CloseBtn.BackgroundColor3 = Color3.fromRGB(255, 100, 100)
    CloseBtn.Text = "‚úï"
    CloseBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
    CloseBtn.Font = Enum.Font.GothamBold
    CloseBtn.TextSize = 20
    CloseBtn.Parent = TitleBar
    
    local CloseBtnCorner = Instance.new("UICorner")
    CloseBtnCorner.CornerRadius = UDim.new(0, 10)
    CloseBtnCorner.Parent = CloseBtn
    
    -- Minimize Button
    local MinBtn = Instance.new("TextButton")
    MinBtn.Size = UDim2.new(0, 40, 0, 40)
    MinBtn.Position = UDim2.new(1, -100, 0, 10)
    MinBtn.BackgroundColor3 = Color3.fromRGB(255, 200, 0)
    MinBtn.Text = "‚àí"
    MinBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
    MinBtn.Font = Enum.Font.GothamBold
    MinBtn.TextSize = 20
    MinBtn.Parent = TitleBar
    
    local MinBtnCorner = Instance.new("UICorner")
    MinBtnCorner.CornerRadius = UDim.new(0, 10)
    MinBtnCorner.Parent = MinBtn
    
    -- Content Frame
    local ContentFrame = Instance.new("Frame")
    ContentFrame.Size = UDim2.new(1, 0, 1, -60)
    ContentFrame.Position = UDim2.new(0, 0, 0, 60)
    ContentFrame.BackgroundTransparency = 1
    ContentFrame.Parent = MainFrame
    
    -- Tab System
    local TabContainer = Instance.new("Frame")
    TabContainer.Size = UDim2.new(0, 150, 1, 0)
    TabContainer.BackgroundColor3 = Color3.fromRGB(20, 20, 30)
    TabContainer.BorderSizePixel = 0
    TabContainer.Parent = ContentFrame
    
    local ContentContainer = Instance.new("Frame")
    ContentContainer.Size = UDim2.new(1, -150, 1, 0)
    ContentContainer.Position = UDim2.new(0, 150, 0, 0)
    ContentContainer.BackgroundTransparency = 1
    ContentContainer.Parent = ContentFrame
    
    -- Tab data
    local tabs = {
        {name = "üè† Main", id = "main"},
        {name = "üëÅÔ∏è ESP", id = "esp"},
        {name = "ü§ñ Auto", id = "auto"},
        {name = "üèÉ Player", id = "player"},
        {name = "üëπ Entity", id = "entity"},
        {name = "‚öôÔ∏è Settings", id = "settings"},
        {name = "‚ÑπÔ∏è Info", id = "info"}
    }
    
    local tabButtons = {}
    local tabFrames = {}
    local currentTab = "main"
    
    -- Create tabs
    for i, tab in ipairs(tabs) do
        -- Tab button
        local TabBtn = Instance.new("TextButton")
        TabBtn.Size = UDim2.new(1, -10, 0, 50)
        TabBtn.Position = UDim2.new(0, 5, 0, (i-1) * 55 + 10)
        TabBtn.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
        TabBtn.Text = tab.name
        TabBtn.TextColor3 = Color3.fromRGB(200, 200, 200)
        TabBtn.Font = Enum.Font.Gotham
        TabBtn.TextSize = 14
        TabBtn.Parent = TabContainer
        
        local TabBtnCorner = Instance.new("UICorner")
        TabBtnCorner.CornerRadius = UDim.new(0, 10)
        TabBtnCorner.Parent = TabBtn
        
        tabButtons[tab.id] = TabBtn
        
        -- Tab frame
        local TabFrame = Instance.new("ScrollingFrame")
        TabFrame.Size = UDim2.new(1, -20, 1, -20)
        TabFrame.Position = UDim2.new(0, 10, 0, 10)
        TabFrame.BackgroundTransparency = 1
        TabFrame.ScrollBarThickness = 8
        TabFrame.ScrollBarImageColor3 = Color3.fromRGB(139, 0, 255)
        TabFrame.Visible = tab.id == "main"
        TabFrame.Parent = ContentContainer
        
        local TabLayout = Instance.new("UIListLayout")
        TabLayout.SortOrder = Enum.SortOrder.LayoutOrder
        TabLayout.Padding = UDim.new(0, 10)
        TabLayout.Parent = TabFrame
        
        tabFrames[tab.id] = TabFrame
        
        -- Tab switching
        TabBtn.MouseButton1Click:Connect(function()
            for id, btn in pairs(tabButtons) do
                if id == tab.id then
                    btn.BackgroundColor3 = Color3.fromRGB(139, 0, 255)
                    btn.TextColor3 = Color3.fromRGB(255, 255, 255)
                    tabFrames[id].Visible = true
                    currentTab = id
                else
                    btn.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
                    btn.TextColor3 = Color3.fromRGB(200, 200, 200)
                    tabFrames[id].Visible = false
                end
            end
        end)
    end
    
    -- Set initial active tab
    tabButtons["main"].BackgroundColor3 = Color3.fromRGB(139, 0, 255)
    tabButtons["main"].TextColor3 = Color3.fromRGB(255, 255, 255)
    
    -- Button creation function
    local function createButton(parent, text, color, callback)
        local Button = Instance.new("TextButton")
        Button.Size = UDim2.new(1, 0, 0, 45)
        Button.BackgroundColor3 = color
        Button.Text = text
        Button.TextColor3 = Color3.fromRGB(255, 255, 255)
        Button.Font = Enum.Font.GothamBold
        Button.TextSize = 16
        Button.Parent = parent
        
        local ButtonCorner = Instance.new("UICorner")
        ButtonCorner.CornerRadius = UDim.new(0, 10)
        ButtonCorner.Parent = Button
        
        Button.MouseButton1Click:Connect(callback)
        
        -- Hover effect
        Button.MouseEnter:Connect(function()
            TweenService:Create(Button, TweenInfo.new(0.2), {
                BackgroundColor3 = Color3.fromRGB(
                    math.min(color.R * 255 + 30, 255),
                    math.min(color.G * 255 + 30, 255),
                    math.min(color.B * 255 + 30, 255)
                )
            }):Play()
        end)
        
        Button.MouseLeave:Connect(function()
            TweenService:Create(Button, TweenInfo.new(0.2), {BackgroundColor3 = color}):Play()
        end)
        
        return Button
    end
    
    -- Slider creation function
    local function createSlider(parent, text, min, max, default, callback)
        local Container = Instance.new("Frame")
        Container.Size = UDim2.new(1, 0, 0, 70)
        Container.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
        Container.Parent = parent
        
        local ContainerCorner = Instance.new("UICorner")
        ContainerCorner.CornerRadius = UDim.new(0, 10)
        ContainerCorner.Parent = Container
        
        local Label = Instance.new("TextLabel")
        Label.Size = UDim2.new(1, -20, 0, 30)
        Label.Position = UDim2.new(0, 10, 0, 5)
        Label.BackgroundTransparency = 1
        Label.Text = text .. ": " .. default
        Label.TextColor3 = Color3.fromRGB(255, 255, 255)
        Label.Font = Enum.Font.Gotham
        Label.TextSize = 14
        Label.TextXAlignment = Enum.TextXAlignment.Left
        Label.Parent = Container
        
        local SliderFrame = Instance.new("Frame")
        SliderFrame.Size = UDim2.new(1, -20, 0, 20)
        SliderFrame.Position = UDim2.new(0, 10, 0, 40)
        SliderFrame.BackgroundColor3 = Color3.fromRGB(50, 50, 60)
        SliderFrame.Parent = Container
        
        local SliderCorner = Instance.new("UICorner")
        SliderCorner.CornerRadius = UDim.new(0, 10)
        SliderCorner.Parent = SliderFrame
        
        local SliderFill = Instance.new("Frame")
        SliderFill.Size = UDim2.new((default - min) / (max - min), 0, 1, 0)
        SliderFill.BackgroundColor3 = Color3.fromRGB(139, 0, 255)
        SliderFill.BorderSizePixel = 0
        SliderFill.Parent = SliderFrame
        
        local FillCorner = Instance.new("UICorner")
        FillCorner.CornerRadius = UDim.new(0, 10)
        FillCorner.Parent = SliderFill
        
        local SliderButton = Instance.new("TextButton")
        SliderButton.Size = UDim2.new(1, 0, 1, 0)
        SliderButton.BackgroundTransparency = 1
        SliderButton.Text = ""
        SliderButton.Parent = SliderFrame
        
        local dragging = false
        
        SliderButton.MouseButton1Down:Connect(function()
            dragging = true
        end)
        
        UserInputService.InputEnded:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                dragging = false
            end
        end)
        
        UserInputService.InputChanged:Connect(function(input)
            if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
                local mouse = Players.LocalPlayer:GetMouse()
                local relativeX = mouse.X - SliderFrame.AbsolutePosition.X
                local percentage = math.clamp(relativeX / SliderFrame.AbsoluteSize.X, 0, 1)
                local value = math.floor(min + (max - min) * percentage)
                
                SliderFill.Size = UDim2.new(percentage, 0, 1, 0)
                Label.Text = text .. ": " .. value
                callback(value)
            end
        end)
        
        return Container
    end
    
    -- Toggle creation function
    local function createToggle(parent, text, default, callback)
        local Container = Instance.new("Frame")
        Container.Size = UDim2.new(1, 0, 0, 45)
        Container.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
        Container.Parent = parent
        
        local ContainerCorner = Instance.new("UICorner")
        ContainerCorner.CornerRadius = UDim.new(0, 10)
        ContainerCorner.Parent = Container
        
        local Label = Instance.new("TextLabel")
        Label.Size = UDim2.new(1, -60, 1, 0)
        Label.Position = UDim2.new(0, 10, 0, 0)
        Label.BackgroundTransparency = 1
        Label.Text = text
        Label.TextColor3 = Color3.fromRGB(255, 255, 255)
        Label.Font = Enum.Font.Gotham
        Label.TextSize = 14
        Label.TextXAlignment = Enum.TextXAlignment.Left
        Label.Parent = Container
        
        local Toggle = Instance.new("TextButton")
        Toggle.Size = UDim2.new(0, 40, 0, 25)
        Toggle.Position = UDim2.new(1, -50, 0.5, -12.5)
        Toggle.BackgroundColor3 = default and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(200, 0, 0)
        Toggle.Text = default and "ON" or "OFF"
        Toggle.TextColor3 = Color3.fromRGB(255, 255, 255)
        Toggle.Font = Enum.Font.GothamBold
        Toggle.TextSize = 12
        Toggle.Parent = Container
        
        local ToggleCorner = Instance.new("UICorner")
        ToggleCorner.CornerRadius = UDim.new(0, 5)
        ToggleCorner.Parent = Toggle
        
        local isEnabled = default
        
        Toggle.MouseButton1Click:Connect(function()
            isEnabled = not isEnabled
            Toggle.BackgroundColor3 = isEnabled and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(200, 0, 0)
            Toggle.Text = isEnabled and "ON" or "OFF"
            callback(isEnabled)
        end)
        
        return Container
    end
    
    -- MAIN TAB
    local function setupMainTab()
        local mainFrame = tabFrames["main"]
        
        -- Secret key status
        local keyValid, timeLeft = checkKey()
        local statusText = keyValid and ("üîê Secret Access Active\n‚è∞ " .. formatTime(timeLeft) .. " remaining") or "üîê Secret Access Required"
        local statusColor = keyValid and Color3.fromRGB(0, 255, 0) or Color3.fromRGB(255, 100, 100)
        
        local StatusFrame = Instance.new("Frame")
        StatusFrame.Size = UDim2.new(1, 0, 0, 80)
        StatusFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
        StatusFrame.Parent = mainFrame
        
        local StatusCorner = Instance.new("UICorner")
        StatusCorner.CornerRadius = UDim.new(0, 10)
        StatusCorner.Parent = StatusFrame
        
        local StatusLabel = Instance.new("TextLabel")
        StatusLabel.Size = UDim2.new(1, -20, 1, 0)
        StatusLabel.Position = UDim2.new(0, 10, 0, 0)
        StatusLabel.BackgroundTransparency = 1
        StatusLabel.Text = statusText
        StatusLabel.TextColor3 = statusColor
        StatusLabel.Font = Enum.Font.GothamBold
        StatusLabel.TextSize = 16
        StatusLabel.TextWrapped = true
        StatusLabel.Parent = StatusFrame
        
        -- Quick actions
        createButton(mainFrame, "üöÄ Toggle All ESP", Color3.fromRGB(139, 0, 255), function()
            local anyEnabled = doorEspEnabled or keyEspEnabled or entityEspEnabled or playerEspEnabled or itemEspEnabled or bookEspEnabled
            
            if anyEnabled then
                -- Turn off all ESP
                if doorEspEnabled then toggleDoorESP() end
                if keyEspEnabled then toggleKeyESP() end
                if entityEspEnabled then toggleEntityESP() end
                if playerEspEnabled then togglePlayerESP() end
                if itemEspEnabled then toggleItemESP() end
                if bookEspEnabled then toggleBookESP() end
                createNotification("üëÅÔ∏è ESP Master", "All ESP Disabled", Color3.fromRGB(255, 100, 100))
            else
                -- Turn on all ESP
                if not doorEspEnabled then toggleDoorESP() end
                if not keyEspEnabled then toggleKeyESP() end
                if not entityEspEnabled then toggleEntityESP() end
                if not playerEspEnabled then togglePlayerESP() end
                if not itemEspEnabled then toggleItemESP() end
                if not bookEspEnabled then toggleBookESP() end
                createNotification("üëÅÔ∏è ESP Master", "All ESP Enabled", Color3.fromRGB(0, 255, 0))
            end
        end)
        
        createButton(mainFrame, "ü§ñ Toggle All Auto", Color3.fromRGB(0, 200, 100), function()
            local anyEnabled = autoCollectEnabled or autoUnlockEnabled or autoProximityPromptEnabled
            
            if anyEnabled then
                if autoCollectEnabled then toggleAutoCollect() end
                if autoUnlockEnabled then toggleAutoUnlock() end
                if autoProximityPromptEnabled then toggleAutoProximityPrompt() end
                createNotification("ü§ñ Auto Master", "All Auto Functions Disabled", Color3.fromRGB(255, 100, 100))
            else
                if not autoCollectEnabled then toggleAutoCollect() end
                if not autoUnlockEnabled then toggleAutoUnlock() end
                if not autoProximityPromptEnabled then toggleAutoProximityPrompt() end
                createNotification("ü§ñ Auto Master", "All Auto Functions Enabled", Color3.fromRGB(0, 255, 0))
            end
        end)
        
        createButton(mainFrame, "üõ°Ô∏è Toggle God Mode", Color3.fromRGB(255, 215, 0), function()
            toggleGodMode()
        end)
        
        createButton(mainFrame, "üëª Toggle Noclip", Color3.fromRGB(200, 200, 255), function()
            toggleNoclip()
        end)
        
        createButton(mainFrame, "‚ö†Ô∏è Toggle Rush Notifications", Color3.fromRGB(255, 0, 0), function()
            toggleRushNotifications()
        end)
        
        -- Update content size
        mainFrame.CanvasSize = UDim2.new(0, 0, 0, mainFrame.UIListLayout.AbsoluteContentSize.Y + 20)
    end
    
    -- ESP TAB
    local function setupESPTab()
        local espFrame = tabFrames["esp"]
        
        createToggle(espFrame, "üö™ Door ESP", doorEspEnabled, function() toggleDoorESP() end)
        createToggle(espFrame, "üóùÔ∏è Key ESP", keyEspEnabled, function() toggleKeyESP() end)
        createToggle(espFrame, "üëπ Entity ESP", entityEspEnabled, function() toggleEntityESP() end)
        createToggle(espFrame, "üë§ Player ESP", playerEspEnabled, function() togglePlayerESP() end)
        createToggle(espFrame, "üì¶ Item ESP", itemEspEnabled, function() toggleItemESP() end)
        createToggle(espFrame, "üìö Book ESP", bookEspEnabled, function() toggleBookESP() end)
        
        createButton(espFrame, "üóëÔ∏è Clear All ESP", Color3.fromRGB(255, 100, 100), function()
            clearAllESP()
            createNotification("üóëÔ∏è Clear ESP", "All ESP cleared", Color3.fromRGB(255, 255, 0))
        end)
        
        espFrame.CanvasSize = UDim2.new(0, 0, 0, espFrame.UIListLayout.AbsoluteContentSize.Y + 20)
    end
    
    -- AUTO TAB
    local function setupAutoTab()
        local autoFrame = tabFrames["auto"]
        
        createToggle(autoFrame, "üîÑ Auto Collect", autoCollectEnabled, function() toggleAutoCollect() end)
        createToggle(autoFrame, "üîì Auto Unlock", autoUnlockEnabled, function() toggleAutoUnlock() end)
        createToggle(autoFrame, "ü§ñ Auto ProximityPrompt", autoProximityPromptEnabled, function() toggleAutoProximityPrompt() end)
        createToggle(autoFrame, "üíä Infinite Vitamins", infVitaminsEnabled, function() toggleInfVitamins() end)
        
        autoFrame.CanvasSize = UDim2.new(0, 0, 0, autoFrame.UIListLayout.AbsoluteContentSize.Y + 20)
    end
    
    -- PLAYER TAB
    local function setupPlayerTab()
        local playerFrame = tabFrames["player"]
        
        createSlider(playerFrame, "üèÉ Walk Speed", 16, 100, currentSpeed, function(value)
            setSpeed(value)
        end)
        
        createToggle(playerFrame, "üõ°Ô∏è God Mode", godModeEnabled, function() toggleGodMode() end)
        createToggle(playerFrame, "üëª Noclip", noclipEnabled, function() toggleNoclip() end)
        createToggle(playerFrame, "üíä Infinite Vitamins", infVitaminsEnabled, function() toggleInfVitamins() end)
        
        createButton(playerFrame, "ü©π Full Heal", Color3.fromRGB(255, 100, 100), function()
            if player.Character and player.Character:FindFirstChild("Humanoid") then
                player.Character.Humanoid.Health = player.Character.Humanoid.MaxHealth
                createNotification("ü©π Heal", "Health restored to full", Color3.fromRGB(0, 255, 0))
            end
        end)
        
        playerFrame.CanvasSize = UDim2.new(0, 0, 0, playerFrame.UIListLayout.AbsoluteContentSize.Y + 20)
    end
    
    -- ENTITY TAB
    local function setupEntityTab()
        local entityFrame = tabFrames["entity"]
        
        createToggle(entityFrame, "‚ö†Ô∏è Rush Notifications", rushNotifEnabled, function() toggleRushNotifications() end)
        createToggle(entityFrame, "üëπ All Entity Notifications", allEntityNotifications, function() toggleAllEntityNotifications() end)
        
        createButton(entityFrame, "üéØ Teleport to Latest Room", Color3.fromRGB(0, 150, 255), function()
            local latestRoom = workspace.CurrentRooms:GetChildren()
            if #latestRoom > 0 then
                table.sort(latestRoom, function(a, b) return tonumber(a.Name) > tonumber(b.Name) end)
                local targetRoom = latestRoom[1]
                if targetRoom:FindFirstChild("Door") and targetRoom.Door:FindFirstChild("Door") then
                    player.Character.HumanoidRootPart.CFrame = targetRoom.Door.Door.CFrame
                    createNotification("üéØ Teleport", "Teleported to Room " .. targetRoom.Name, Color3.fromRGB(0, 255, 255))
                end
            end
        end)
        
        entityFrame.CanvasSize = UDim2.new(0, 0, 0, entityFrame.UIListLayout.AbsoluteContentSize.Y + 20)
    end
    
    -- SETTINGS TAB
    local function setupSettingsTab()
        local settingsFrame = tabFrames["settings"]
        
        createButton(settingsFrame, "üîÑ Rejoin Server", Color3.fromRGB(0, 150, 255), function()
            TeleportService:Teleport(game.PlaceId, player)
        end)
        
        createButton(settingsFrame, "üóëÔ∏è Clear All ESP", Color3.fromRGB(255, 100, 100), function()
            clearAllESP()
            createNotification("üóëÔ∏è Clear", "All ESP cleared", Color3.fromRGB(255, 255, 0))
        end)
        
        createButton(settingsFrame, "üõ°Ô∏è Enable Auto Bypass", Color3.fromRGB(255, 215, 0), function()
            if not bypassAntiCheat then
                enableAutoBypassForAll()
                createNotification("üõ°Ô∏è Bypass", "Auto Bypass enabled for all players", Color3.fromRGB(0, 255, 0))
            else
                createNotification("üõ°Ô∏è Bypass", "Auto Bypass already active", Color3.fromRGB(255, 255, 0))
            end
        end)
        
        createButton(settingsFrame, "üóùÔ∏è Refresh Key Status", Color3.fromRGB(139, 0, 255), function()
            local valid, timeLeft = checkKey()
            if valid then
                createNotification("üóùÔ∏è Key Status", "Secret key valid - " .. formatTime(timeLeft) .. " remaining
", Color3.fromRGB(0, 255, 0), 5)
            else
                createNotification("üóùÔ∏è Key Status", "Secret key expired or invalid", Color3.fromRGB(255, 100, 100), 5)
            end
        end)
        
        settingsFrame.CanvasSize = UDim2.new(0, 0, 0, settingsFrame.UIListLayout.AbsoluteContentSize.Y + 20)
    end
    
    -- INFO TAB
    local function setupInfoTab()
        local infoFrame = tabFrames["info"]
        
        local InfoContainer = Instance.new("Frame")
        InfoContainer.Size = UDim2.new(1, 0, 0, 450)
        InfoContainer.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
        InfoContainer.Parent = infoFrame
        
        local InfoCorner = Instance.new("UICorner")
        InfoCorner.CornerRadius = UDim.new(0, 10)
        InfoCorner.Parent = InfoContainer
        
        local InfoText = Instance.new("TextLabel")
        InfoText.Size = UDim2.new(1, -20, 1, -20)
        InfoText.Position = UDim2.new(0, 10, 0, 10)
        InfoText.BackgroundTransparency = 1
        InfoText.Text = [[
üîê WENER HUB v4.0 - ULTIMATE COMPLETE EDITION
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

üìå VERSION: v4.0 Ultimate Complete Hidden
üîê SECRET KEY SYSTEM: Active (Universal)
üåç AUTO BYPASS: Enabled for ALL players
üöÄ AUTO EXECUTE: Configured
üîÑ AUTO RECONNECT: Active

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

‚ú® PREMIUM FEATURES:

üëÅÔ∏è MODERN ESP SYSTEM:
  ‚Ä¢ Door ESP - Track all doors
  ‚Ä¢ Key ESP - Find keys instantly
  ‚Ä¢ Entity ESP - See all entities
  ‚Ä¢ Player ESP - Track other players
  ‚Ä¢ Item ESP - Locate important items
  ‚Ä¢ Book ESP - Find hint books

ü§ñ ADVANCED AUTO FUNCTIONS:
  ‚Ä¢ Auto Collect - Collect items automatically
  ‚Ä¢ Auto Unlock - Unlock doors automatically
  ‚Ä¢ Auto ProximityPrompt - Auto interact (Pressione R)
  ‚Ä¢ Infinite Vitamins - Never run out

üèÉ PLAYER MODIFICATIONS:
  ‚Ä¢ Custom Walk Speed (16-100)
  ‚Ä¢ God Mode - Invincibility
  ‚Ä¢ Noclip - Walk through walls
  ‚Ä¢ Full Heal - Instant health restore

üëπ ENTITY DETECTION:
  ‚Ä¢ Rush Notifications
  ‚Ä¢ Ambush Alerts
  ‚Ä¢ Eyes Warning
  ‚Ä¢ Screech Detection
  ‚Ä¢ All Entity Notifications

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

üîê SECRET KEY INFO:
The universal key is hidden in the script.
Everyone needs the key (No bypass for anyone!).
Valid for 24 hours after first use.

‚ö†Ô∏è HINT: Look for "Wene" + something üëÄ

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

üí° CONTROLS:
‚Ä¢ LEFT ALT - Toggle GUI visibility
‚Ä¢ ESC - Close GUI

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

üë§ DEVELOPER: Wener
üìÖ RELEASE: 2024
üéØ GAME: DOORS

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
]]
        InfoText.TextColor3 = Color3.fromRGB(200, 200, 200)
        InfoText.Font = Enum.Font.Code
        InfoText.TextSize = 12
        InfoText.TextWrapped = true
        InfoText.TextXAlignment = Enum.TextXAlignment.Left
        InfoText.TextYAlignment = Enum.TextYAlignment.Top
        InfoText.Parent = InfoContainer
        
        infoFrame.CanvasSize = UDim2.new(0, 0, 0, infoFrame.UIListLayout.AbsoluteContentSize.Y + 20)
    end
    
    -- Setup all tabs
    setupMainTab()
    setupESPTab()
    setupAutoTab()
    setupPlayerTab()
    setupEntityTab()
    setupSettingsTab()
    setupInfoTab()
    
    -- Open Button (Floating)
    local OpenButton = Instance.new("TextButton")
    OpenButton.Size = UDim2.new(0, 60, 0, 60)
    OpenButton.Position = UDim2.new(0, 20, 0.5, -30)
    OpenButton.BackgroundColor3 = Color3.fromRGB(139, 0, 255)
    OpenButton.Text = "W"
    OpenButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    OpenButton.Font = Enum.Font.GothamBold
    OpenButton.TextSize = 32
    OpenButton.Parent = ScreenGui
    
    local OpenCorner = Instance.new("UICorner")
    OpenCorner.CornerRadius = UDim.new(0, 30)
    OpenCorner.Parent = OpenButton
    
    local OpenStroke = Instance.new("UIStroke")
    OpenStroke.Color = Color3.fromRGB(255, 255, 255)
    OpenStroke.Thickness = 3
    OpenStroke.Parent = OpenButton
    
    -- Draggable Open Button
    local dragging = false
    local dragInput, mousePos, framePos
    
    OpenButton.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            mousePos = input.Position
            framePos = OpenButton.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)
    
    OpenButton.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            dragInput = input
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            local delta = input.Position - mousePos
            OpenButton.Position = UDim2.new(
                framePos.X.Scale,
                framePos.X.Offset + delta.X,
                framePos.Y.Scale,
                framePos.Y.Offset + delta.Y
            )
        end
    end)
    
    -- Button pulse animation
    task.spawn(function()
        while true do
            TweenService:Create(OpenButton, TweenInfo.new(1, Enum.EasingStyle.Sine), {
                Size = UDim2.new(0, 65, 0, 65)
            }):Play()
            TweenService:Create(OpenStroke, TweenInfo.new(1, Enum.EasingStyle.Sine), {
                Transparency = 0.5
            }):Play()
            wait(1)
            TweenService:Create(OpenButton, TweenInfo.new(1, Enum.EasingStyle.Sine), {
                Size = UDim2.new(0, 60, 0, 60)
            }):Play()
            TweenService:Create(OpenStroke, TweenInfo.new(1, Enum.EasingStyle.Sine), {
                Transparency = 0
            }):Play()
            wait(1)
        end
    end)
    
    -- GUI Toggle Functions
    local function showGUI()
        MainFrame.Visible = true
        TweenService:Create(MainFrame, TweenInfo.new(0.5, Enum.EasingStyle.Back), {
            Size = UDim2.new(0, 800, 0, 600)
        }):Play()
    end
    
    local function hideGUI()
        TweenService:Create(MainFrame, TweenInfo.new(0.5, Enum.EasingStyle.Back), {
            Size = UDim2.new(0, 0, 0, 0)
        }):Play()
        wait(0.5)
        MainFrame.Visible = false
    end
    
    -- Button Events
    OpenButton.MouseButton1Click:Connect(function()
        if MainFrame.Visible then
            hideGUI()
        else
            showGUI()
        end
    end)
    
    CloseBtn.MouseButton1Click:Connect(function()
        hideGUI()
    end)
    
    MinBtn.MouseButton1Click:Connect(function()
        hideGUI()
    end)
    
    -- Keyboard Toggle (LEFT ALT)
    UserInputService.InputBegan:Connect(function(input, gameProcessed)
        if not gameProcessed and input.KeyCode == Enum.KeyCode.LeftAlt then
            if MainFrame.Visible then
                hideGUI()
            else
                showGUI()
            end
        end
    end)
    
    -- Make main frame draggable
    local mainDragging = false
    local mainDragInput, mainMousePos, mainFramePos
    
    TitleBar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            mainDragging = true
            mainMousePos = input.Position
            mainFramePos = MainFrame.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    mainDragging = false
                end
            end)
        end
    end)
    
    TitleBar.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            mainDragInput = input
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if input == mainDragInput and mainDragging then
            local delta = input.Position - mainMousePos
            MainFrame.Position = UDim2.new(
                mainFramePos.X.Scale,
                mainFramePos.X.Offset + delta.X,
                mainFramePos.Y.Scale,
                mainFramePos.Y.Offset + delta.Y
            )
        end
    end)
    
    print("‚úÖ Main GUI created successfully")
    
    -- Show welcome notification
    wait(1)
    createNotification(
        "üéâ WENER HUB LOADED",
        "Press LEFT ALT or click the W button to open\nüîê Secret Access Granted!",
        Color3.fromRGB(139, 0, 255),
        8
    )
end

createMainGUI()

-- ============================================================================
-- STEP 11: CHARACTER RESPAWN HANDLING
-- ============================================================================

print("STEP 11: Setting up Character Respawn Handler...")

player.CharacterAdded:Connect(function(character)
    repeat wait() until character:FindFirstChild("HumanoidRootPart")
    repeat wait() until character:FindFirstChild("Humanoid")
    
    print("üîÑ Character respawned, reapplying settings...")
    
    -- Reapply speed
    if currentSpeed ~= 16 then
        character.Humanoid.WalkSpeed = currentSpeed
    end
    
    -- Reapply god mode
    if godModeEnabled then
        wait(0.5)
        godModeConnections[1] = character.Humanoid.HealthChanged:Connect(function()
            character.Humanoid.Health = character.Humanoid.MaxHealth
        end)
        godModeConnections[2] = character.Humanoid.Died:Connect(function()
            character.Humanoid.Health = character.Humanoid.MaxHealth
        end)
    end
    
    -- Reapply noclip
    if noclipEnabled and noclipConnection then
        noclipConnection:Disconnect()
        noclipConnection = RunService.Stepped:Connect(function()
            if character then
                for _, part in pairs(character:GetChildren()) do
                    if part:IsA("BasePart") then
                        part.CanCollide = false
                    end
                end
            end
        end)
    end
    
    createNotification("üîÑ Respawn", "Settings reapplied after respawn", Color3.fromRGB(0, 255, 255), 4)
end)

-- ============================================================================
-- STEP 12: WORKSPACE MONITORING (ESP AUTO-UPDATE)
-- ============================================================================

print("STEP 12: Setting up Workspace Monitoring...")

workspace.DescendantAdded:Connect(function(obj)
    wait(0.1) -- Small delay to ensure object is fully loaded
    
    -- Auto-add ESP if enabled
    if doorEspEnabled and obj.Name == "Door" and obj:FindFirstChild("Door") then
        createESP(obj, "üö™ Door", Color3.fromRGB(255, 255, 0))
    end
    
    if keyEspEnabled and obj.Name == "KeyObtain" then
        createESP(obj, "üóùÔ∏è Key", Color3.fromRGB(255, 215, 0))
    end
    
    if entityEspEnabled and (obj.Name == "RushMoving" or obj.Name == "AmbushMoving" or obj.Name == "Eyes" or obj.Name == "Screech") then
        createESP(obj, "üëπ " .. obj.Name, Color3.fromRGB(255, 0, 0))
    end
    
    if itemEspEnabled and (obj.Name == "LeverForGate" or obj.Name == "LiveHintBook" or obj.Name == "Battery" or obj.Name == "Crucifix") then
        createESP(obj, "üì¶ " .. obj.Name, Color3.fromRGB(0, 255, 0))
    end
    
    if bookEspEnabled and obj.Name == "LiveHintBook" then
        createESP(obj, "üìö Book", Color3.fromRGB(255, 0, 255))
    end
end)

workspace.DescendantRemoving:Connect(function(obj)
    if espObjects[obj] then
        removeESP(obj)
    end
end)

-- Player ESP monitoring
Players.PlayerAdded:Connect(function(newPlayer)
    if playerEspEnabled then
        newPlayer.CharacterAdded:Connect(function(character)
            repeat wait() until character:FindFirstChild("HumanoidRootPart")
            createESP(character.HumanoidRootPart, "üë§ " .. newPlayer.DisplayName, Color3.fromRGB(0, 255, 255))
        end)
        
        if newPlayer.Character and newPlayer.Character:FindFirstChild("HumanoidRootPart") then
            createESP(newPlayer.Character.HumanoidRootPart, "üë§ " .. newPlayer.DisplayName, Color3.fromRGB(0, 255, 255))
        end
    end
end)

Players.PlayerRemoving:Connect(function(oldPlayer)
    if oldPlayer.Character and oldPlayer.Character:FindFirstChild("HumanoidRootPart") then
        removeESP(oldPlayer.Character.HumanoidRootPart)
    end
end)

-- ============================================================================
-- STEP 13: ANTI-AFK SYSTEM
-- ============================================================================

print("STEP 13: Setting up Anti-AFK System...")

local VirtualUser = game:GetService("VirtualUser")

player.Idled:Connect(function()
    VirtualUser:CaptureController()
    VirtualUser:ClickButton2(Vector2.new())
    createNotification("‚è∞ Anti-AFK", "Anti-AFK triggered - You won't be kicked!", Color3.fromRGB(255, 215, 0), 4)
end)

-- ============================================================================
-- STEP 14: KEY EXPIRATION MONITOR
-- ============================================================================

print("STEP 14: Setting up Key Expiration Monitor...")

task.spawn(function()
    while true do
        wait(300) -- Check every 5 minutes
        
        local keyValid, timeLeft = checkKey()
        
        if keyValid then
            if timeLeft < 3600 then -- Less than 1 hour remaining
                local hours = math.floor(timeLeft / 3600)
                local minutes = math.floor((timeLeft % 3600) / 60)
                createNotification(
                    "‚ö†Ô∏è Key Expiration Warning",
                    string.format("Secret key expires in %dh %dm", hours, minutes),
                    Color3.fromRGB(255, 200, 0),
                    6
                )
            end
        else
            createNotification(
                "üîê Key Expired",
                "Your secret key has expired! Script will reload.",
                Color3.fromRGB(255, 0, 0),
                8
            )
            wait(3)
            -- Reload script
            loadstring(game:HttpGet("https://raw.githubusercontent.com/WanerScripts/WenerHub/main/doors-ultimate.lua"))()
        end
    end
end)

-- ============================================================================
-- STEP 15: PERFORMANCE MONITOR
-- ============================================================================

print("STEP 15: Setting up Performance Monitor...")

local lastFPS = 0
local fpsUpdateTime = 0

RunService.Heartbeat:Connect(function()
    local currentTime = tick()
    
    if currentTime - fpsUpdateTime >= 1 then
        local fps = math.floor(1 / RunService.Heartbeat:Wait())
        
        if fps < 30 and fps ~= lastFPS then
            createNotification(
                "‚ö†Ô∏è Performance Warning",
                "Low FPS detected (" .. fps .. " FPS). Consider disabling some ESP.",
                Color3.fromRGB(255, 200, 0),
                5
            )
        end
        
        lastFPS = fps
        fpsUpdateTime = currentTime
    end
end)

-- ============================================================================
-- STEP 16: ERROR HANDLER
-- ============================================================================

print("STEP 16: Setting up Global Error Handler...")

local function handleError(err)
    warn("WENER HUB ERROR: " .. tostring(err))
    createNotification(
        "‚ùå Error Detected",
        "An error occurred. Check console for details.",
        Color3.fromRGB(255, 0, 0),
        5
    )
end

-- Wrap critical functions in pcall
local originalToggleDoorESP = toggleDoorESP
toggleDoorESP = function()
    local success, err = pcall(originalToggleDoorESP)
    if not success then handleError(err) end
end

-- Add similar wrapping for other critical functions as needed

-- ============================================================================
-- STEP 17: CLEANUP ON LEAVE
-- ============================================================================

print("STEP 17: Setting up Cleanup Handler...")

game:GetService("CoreGui").DescendantRemoving:Connect(function(obj)
    if obj.Name == "WenerHubUltimate" or obj.Name == "WenerLogo" then
        -- Clean up all connections
        if noclipConnection then noclipConnection:Disconnect() end
        if autoCollectConnection then autoCollectConnection:Disconnect() end
        if autoUnlockConnection then autoUnlockConnection:Disconnect() end
        if autoProximityPromptConnection then autoProximityPromptConnection:Disconnect() end
        if infVitaminsConnection then infVitaminsConnection:Disconnect() end
        
        for _, connection in pairs(godModeConnections) do
            if connection then connection:Disconnect() end
        end
        
        for _, connection in pairs(entityConnections) do
            if connection then connection:Disconnect() end
        end
        
        for _, connection in pairs(bypassConnections) do
            if connection then connection:Disconnect() end
        end
        
        clearAllESP()
        
        print("‚úÖ WENER HUB cleanup completed")
    end
end)

-- ============================================================================
-- FINAL STEP: COMPLETION MESSAGE
-- ============================================================================

print("=" .. string.rep("=", 78) .. "=")
print("üéâ WENER HUB v4.0 ULTIMATE COMPLETE HIDDEN EDITION - FULLY LOADED!")
print("=" .. string.rep("=", 78) .. "=")
print("")
print("‚úÖ ALL SYSTEMS OPERATIONAL:")
print("   üöÄ Auto Execute: Active")
print("   üîÑ Auto Reconnect: Active")
print("   üõ°Ô∏è Auto Bypass: ENABLED FOR ALL PLAYERS")
print("   üîê Secret Key System: Active (Universal - No bypass)")
print("   üëÅÔ∏è Modern ESP Systems: Ready")
print("   ü§ñ Auto Functions: Ready")
print("   üèÉ Player Modifications: Ready")
print("   üëπ Entity Detection: Active")
print("   ‚öôÔ∏è Settings & Tools: Ready")
print("")
print("üéÆ CONTROLS:")
print("   ‚Ä¢ Press LEFT ALT to toggle GUI")
print("   ‚Ä¢ Click W button to open GUI")
print("   ‚Ä¢ Drag W button to move it")
print("   ‚Ä¢ Drag title bar to move GUI")
print("")
print("üîê SECRET KEY INFO:")
print("   ‚Ä¢ Universal key required for ALL users")
print("   ‚Ä¢ No bypass for anyone (Including owner)")
print("   ‚Ä¢ Key valid for 24 hours")
print("   ‚Ä¢ Hint: It's hidden in the script üëÄ")
print("")
print("üí° TIP: Check the Info tab in GUI for full feature list!")
print("")
print("=" .. string.rep("=", 78) .. "=")
print("üë§ Developed by: Wener")
print("üìÖ Version: v4.0 Ultimate Complete Hidden")
print("üéØ Game: DOORS")
print("=" .. string.rep("=", 78) .. "=")

-- Show final completion notification
wait(2)
createNotification(
    "‚úÖ WENER HUB READY",
    "All systems loaded!\nPress LEFT ALT to open GUI\nüîê Secret access confirmed!",
    Color3.fromRGB(0, 255, 0),
    10
)

-- Auto-show GUI for 3 seconds then hide
wait(2)
if game.CoreGui:FindFirstChild("WenerHubUltimate") then
    local gui = game.CoreGui.WenerHubUltimate
    local mainFrame = gui:FindFirstChild("Frame")
    if mainFrame then
        mainFrame.Visible = true
        TweenService:Create(mainFrame, TweenInfo.new(0.8, Enum.EasingStyle.Back), {
            Size = UDim2.new(0, 800, 0, 600)
        }):Play()
        
        wait(5)
        
        TweenService:Create(mainFrame, TweenInfo.new(0.8, Enum.EasingStyle.Back), {
            Size = UDim2.new(0, 0, 0, 0)
        }):Play()
        wait(0.8)
        mainFrame.Visible = false
        
        createNotification(
            "üí° Quick Tip",
            "Press LEFT ALT anytime to toggle the GUI!",
            Color3.fromRGB(255, 215, 0),
            5
        )
    end
end

print("üéä Script execution completed successfully!")
print("üîê Remember: The secret key is 'Wene-you' (shhh... it's hidden!)")
